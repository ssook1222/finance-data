# finance-data
금융데이터 경진대회 team repo
```
#install.packages("dplyr")
#library(dplyr)

#19년 1월 자료
sub1901<-read.csv("C:\\Users\\Hanbeen Cho\\Desktop\\카드이용2019\\CARD_SUBWAY_MONTH_201901 (3).csv")
sub1901


#하루 총 이용객수(총계) 변수 추가하기
sub1901<- sub1901 %>% mutate(총계=승차총승객수+하차총승객수)
head(sub1901)

#사용일자, 노선명, 등록일자 삭제
sub1901<- sub1901 %>% select(역명, 승차총승객수, 하차총승객수,총계)
head(sub1901)

#강서구
gangseo<-sub1901 %>% filter(역명 %in% c('방화', '개화산', '김포공항', '송정', '마곡', '발산', '우장산', '화곡', '까치산', '염창', '등촌', '증미', '가양', '양천향교', '마곡나루', '신방화', '공항시장', '개화'))
head(gangseo)                             
gangseo<-gangseo %>% select(총계)
gangseo
totgangseo<-sum(gangseo)
totgangseo

#양천구
yang<-sub1901 %>% filter(역명 %in% c('신목동', '목동', '오목교', '신정네거리', '양천구청', '신정(은행정)'))
head(yang)                             
yang<-yang %>% select(총계)
yang
totyang<-sum(yang)
totyang

#금천구
keum<-sub1901 %>% filter(역명 %in% c('가산디지털단지', '독산', '금천구청'))
head(keum)    
keum<-keum %>% select(총계)
keum
totkeum<-sum(keum)
totkeum

#관악구
kwan<-sub1901 %>% filter(역명 %in% c('신림', '봉천', '서울대입구', '낙성대'))
head(kwan)  
kwan<-kwan %>% select(총계)
kwan
totkwan<-sum(kwan)
totkwan


#은평구
eun<-sub1901 %>% filter(역명 %in% c('독바위', '구파발', '연신내', '불광', '녹번', '역촌', '구산', '응암', '새절(신사)','증산(명지대앞)', '수색', '디지털미디어시티'))
head(eun)
eun<-eun %>% select(총계)
eun
toteun<-sum(eun)
toteun

#구로구
guro<-sub1901 %>% filter(역명 %in% c('온수(성공회대입구)', '천왕', '오류동', '개봉', '구일', '구로', '남구로', '대림(구로구청)', '구로디지털단지','신도림', '도림천'))
head(guro)  
guro<-guro %>% select(총계)
guro
totguro<-sum(guro)
totguro

#구로구
dobong<-sub1901 %>% filter(역명 %in% c('도봉산', '도봉', '방학', '창동', '녹천', '쌍문'))
head(dobong)  
dobong<-dobong %>% select(총계)
dobong
totdobong<-sum(dobong)
totdobong

#중랑구
jlang<-sub1901 %>% filter(역명 %in% c('먹골', '중화', '상봉(시외버스터미널)', '중량', '망우', '양원', '신내', '봉화산(서울의료원)', '면목', '사가정', '용마산'))
head(jlang)  
jlang<-jlang %>% select(총계)
jlang
totjlang<-sum(jlang)
totjlang


#강동구
gangdong<-sub1901 %>% filter(역명 %in% c('강동구청', '천호(풍납토성)', '암사', '강동', '길동', '굽은다리(강동구민회관앞)', '명일', '고덕', '상일동', '강일', '둔촌동', '둔촌오류','중앙보훈병원'))
head(gangdong) 
gangdong<-gangdong %>% select(총계)
gangdong
totgangdong<-sum(gangdong)
totgangdong


#용산구
yong<-sub1901 %>% filter(역명 %in% c('서울역', '숙대입구(갈월)', '녹사평(용산구청)', '이태원', '한강진', '한남', '서빙고', '이촌(국립중앙박물관)', '용산', '남영', '효창공원앞', '삼각지','신용산'))
head(yong) 
yong<-yong %>% select(총계)
yong
totyong<-sum(yong)
totyong


#광진구
kwang<-sub1901 %>% filter(역명 %in% c('중곡', '군자(능동)', '어린이대공원', '아차산(어린이대공원후문)', '광나루(장신대)', '건대입구', '구의(광진구청)', '강변(동서울터미널)', '뚝섬유원지'))
head(kwang) 
kwang<-kwang%>% select(총계)
kwang
totkwang<-sum(kwang)
totkwang

#동대문구
moon<-sub1901 %>% filter(역명 %in% c('신설동', '용두(동대문구청)', '제기동', '청량리(서울시립대입구)', '회기', '외대앞', '신이문', '왕십리(성동구청)'))
head(moon) 
moon<-moon%>% select(총계)
moon
totmoon<-sum(moon)
totmoon

#노원구
noone<-sub1901 %>% filter(역명 %in% c('석계', '광운대', '월계', '태릉입구', '화랑대(서울여대입구)', '공릉(서울과학기술대)', '하계', '중계', '노원', '상계','당고개', '마들', '수락산'))
head(noone) 
noone<-noone%>% select(총계)
noone
totnoone<-sum(noone)
totnoone


#강북구
kbook<-sub1901 %>% filter(역명 %in% c('솔샘', '삼양사거리', '삼양', '회계', '가오리', '4.19민주묘지', '솔밭공원', '북한산우이', '수유(강북구청)', '미아','미아사거리'))
head(kbook) 
kbook<-noone%>% select(총계)
kbook
totkbook<-sum(kbook)
totkbook


#서대문구
seo<-sub1901 %>% filter(역명 %in% c('홍제', '무악재', '서대문', '충정로(경기대입구)', '신촌(경의중앙선)', '신촌', '가좌'))
head(seo)
seo<-seo%>% select(총계)
seo
totseo<-sum(seo)
totseo


#성북구
seong<-sub1901 %>% filter(역명 %in% c('북한산보국문', '정릉', '성신여대입구', '길음', '한성대입구', '보문', '안암(고대병원앞)', '고려대(종암)','월곡(동덕여대)','상월곡(한국과학기술연구원)', '돌곶이'))
head(seong)
seong<-seong%>% select(총계)
seong
totseong<-sum(seong)
totseong

#종로구
jong<-sub1901 %>% filter(역명 %in% c('독립문', '경복궁(정부서울청사)', '안국', '종로3가', '광화문', '종각', '종로5가', '동대문','동묘앞','혜화', '창신'))
head(jong)
jong<-jong%>% select(총계)
jong
totjong<-sum(jong)
totjong


#중구
jung<-sub1901 %>% filter(역명 %in% c('시청', '을지로입구', '을지로3가', '을지로4가', '동대문역사문화공원', '신당', '청구', '약수','버티고개','동대입구', '충무로', '명동', '회현(남대문시장)'))
head(jung)
jung<-jung%>% select(총계)
jung
totjung<-sum(jung)
totjung


#마포구
mapo<-sub1901 %>% filter(역명 %in% c('월드컵경기장', '마포구청', '홍대입구', '망원', '합정', '상수', '광흥창(서강)', '대흥(서강대앞)','마포','공덕', '애오개', '이대', '아현'))
head(mapo)
mapo<-mapo%>% select(총계)
mapo
totmapo<-sum(mapo)
totmapo


#영등포구
yung<-sub1901 %>% filter(역명 %in% c('국회의사당', '여의나루', '샛강', '여의도', '대방', '신길', '영등포', '신풍','영등포시장','문래', '영등포구청', '당산', '양평', '선유도'))
head(yung)
yung<-yung%>% select(총계)
yung
totyung<-sum(yung)
totyung


#송파구
song<-sub1901 %>% filter(역명 %in% c('잠실나루', '몽촌토성(평화의문)', '잠실(송파구청)', '잠실새내', '종합운동장', '삼전', '석촌고분', '석촌','송파','가락시장', '문정', '장지', '복정', '경찰병원','오금','방이','개롱','거여','마천','올림픽공원','한성백제','송파나루'))
head(song)
song<-song%>% select(총계)
song
totsong<-sum(song)
totsong


#강남구
gnam<-sub1901 %>% filter(역명 %in% c('압구정로데오', '청담', '강남구청', '학동', '논현', '압구정', '신사', '잠원','신논현','언주', '선정릉', '삼성중앙','봉은사', '삼성(무역센터)', '선릉', '역삼', '강남', '한티', '매봉', '도곡', '대치', '학여울', '대청', '일원', '수서', '대모산입구', '개포동', '구룡')) 
head(gnam)
gnam<-gnam%>% select(총계)
gnam
totgnam<-sum(gnam)
totgnam


#서초구
scho<-sub1901 %>% filter(역명 %in% c('신반포', '구반포', '반포', '고속터미널', '사평', '내방', '총신대입구','방배', '서초', '교대(법원.검찰청)', '남부터미널', '양재(서초구청)', '양재시민의숲', '청계산입구', '남태령')) 
head(scho)
scho<-scho%>% select(총계)
scho
totscho<-sum(scho)
totscho


#성동구
sdong<-sub1901 %>% filter(역명 %in% c('상왕십리', '왕십리', '마장', '신답', '용답', '뚝섬', '한양대', '상수', '서울숲', '응봉', '옥수', '행당', '신금호'))
head(sdong)
sdong<-sdong%>% select(총계)
sdong
totsdong<-sum(sdong)
totsdong


#동작구
djak<-sub1901 %>% filter(역명 %in% c('노량진', '노들', '흑석(중앙대입구)', '동작(현충원)', '보라매', '신대방삼거리', '장승배기', '상도','숭실대입구', '남성', '신대방', '사당'))
head(djak)
djak<-djak%>% select(총계)
djak
totdjak<-sum(djak)
totdjak


#데이터프레임 생성 후 막대그래프 그리기
지역구<-c("동작구","도봉구","은평구", "강동구", "강서구","강남구","구로구","중랑구","종로구","중구","강북구","금천구","관악구","광진구","마포구","동대문구","노원구","서초구","성동구","서대문구","성북구","송파구","양천구","용산구","영등포구")
합계1<-c(13457613, 5955904, 11132183, 9129035,14540699,41110705,16924004,6218901,18235985,21684979,12794274,5361126,7583622,12271017,17906486,10787314,12794274,16011421,5859144,6645157,5236739,18903534,3187871,15172966,16973012)
DF1901<-data.frame(지역구,합계1)
DF1901


#19년 2월 자료
sub1902<-read.csv("C:\\Users\\Hanbeen Cho\\Desktop\\카드이용2019\\CARD_SUBWAY_MONTH_201902 (1).csv")
sub1902


#하루 총 이용객수(총계) 변수 추가하기
sub1902<- sub1902 %>% mutate(총계=승차총승객수+하차총승객수)
head(sub1902)

#사용일자, 노선명, 등록일자 삭제
sub1902<- sub1902 %>% select(역명, 승차총승객수, 하차총승객수,총계)
head(sub1902)

#강서구
gangseo<-sub1902 %>% filter(역명 %in% c('방화', '개화산', '김포공항', '송정', '마곡', '발산', '우장산', '화곡', '까치산', '염창', '등촌', '증미', '가양', '양천향교', '마곡나루', '신방화', '공항시장', '개화'))
head(gangseo)                             
gangseo<-gangseo %>% select(총계)
gangseo
totgangseo<-sum(gangseo)
totgangseo

#양천구
yang<-sub1902 %>% filter(역명 %in% c('신목동', '목동', '오목교', '신정네거리', '양천구청', '신정(은행정)'))
head(yang)                             
yang<-yang %>% select(총계)
yang
totyang<-sum(yang)
totyang

#금천구
keum<-sub1902 %>% filter(역명 %in% c('가산디지털단지', '독산', '금천구청'))
head(keum)    
keum<-keum %>% select(총계)
keum
totkeum<-sum(keum)
totkeum

#관악구
kwan<-sub1902 %>% filter(역명 %in% c('신림', '봉천', '서울대입구', '낙성대'))
head(kwan)  
kwan<-kwan %>% select(총계)
kwan
totkwan<-sum(kwan)
totkwan


#은평구
eun<-sub1902 %>% filter(역명 %in% c('독바위', '구파발', '연신내', '불광', '녹번', '역촌', '구산', '응암', '새절(신사)','증산(명지대앞)', '수색', '디지털미디어시티'))
head(eun)
eun<-eun %>% select(총계)
eun
toteun<-sum(eun)
toteun

#구로구
guro<-sub1902 %>% filter(역명 %in% c('온수(성공회대입구)', '천왕', '오류동', '개봉', '구일', '구로', '남구로', '대림(구로구청)', '구로디지털단지','신도림', '도림천'))
head(guro)  
guro<-guro %>% select(총계)
guro
totguro<-sum(guro)
totguro

#구로구
dobong<-sub1902 %>% filter(역명 %in% c('도봉산', '도봉', '방학', '창동', '녹천', '쌍문'))
head(dobong)  
dobong<-dobong %>% select(총계)
dobong
totdobong<-sum(dobong)
totdobong

#중랑구
jlang<-sub1902 %>% filter(역명 %in% c('먹골', '중화', '상봉(시외버스터미널)', '중량', '망우', '양원', '신내', '봉화산(서울의료원)', '면목', '사가정', '용마산'))
head(jlang)  
jlang<-jlang %>% select(총계)
jlang
totjlang<-sum(jlang)
totjlang


#강동구
gangdong<-sub1902 %>% filter(역명 %in% c('강동구청', '천호(풍납토성)', '암사', '강동', '길동', '굽은다리(강동구민회관앞)', '명일', '고덕', '상일동', '강일', '둔촌동', '둔촌오류','중앙보훈병원'))
head(gangdong) 
gangdong<-gangdong %>% select(총계)
gangdong
totgangdong<-sum(gangdong)
totgangdong


#용산구
yong<-sub1902 %>% filter(역명 %in% c('서울역', '숙대입구(갈월)', '녹사평(용산구청)', '이태원', '한강진', '한남', '서빙고', '이촌(국립중앙박물관)', '용산', '남영', '효창공원앞', '삼각지','신용산'))
head(yong) 
yong<-yong %>% select(총계)
yong
totyong<-sum(yong)
totyong


#광진구
kwang<-sub1902 %>% filter(역명 %in% c('중곡', '군자(능동)', '어린이대공원', '아차산(어린이대공원후문)', '광나루(장신대)', '건대입구', '구의(광진구청)', '강변(동서울터미널)', '뚝섬유원지'))
head(kwang) 
kwang<-kwang%>% select(총계)
kwang
totkwang<-sum(kwang)
totkwang

#동대문구
moon<-sub1902 %>% filter(역명 %in% c('신설동', '용두(동대문구청)', '제기동', '청량리(서울시립대입구)', '회기', '외대앞', '신이문', '왕십리(성동구청)'))
head(moon) 
moon<-moon%>% select(총계)
moon
totmoon<-sum(moon)
totmoon

#노원구
noone<-sub1902 %>% filter(역명 %in% c('석계', '광운대', '월계', '태릉입구', '화랑대(서울여대입구)', '공릉(서울과학기술대)', '하계', '중계', '노원', '상계','당고개', '마들', '수락산'))
head(noone) 
noone<-noone%>% select(총계)
noone
totnoone<-sum(noone)
totnoone


#강북구
kbook<-sub1902 %>% filter(역명 %in% c('솔샘', '삼양사거리', '삼양', '회계', '가오리', '4.19민주묘지', '솔밭공원', '북한산우이', '수유(강북구청)', '미아','미아사거리'))
head(kbook) 
kbook<-noone%>% select(총계)
kbook
totkbook<-sum(kbook)
totkbook


#서대문구
seo<-sub1902 %>% filter(역명 %in% c('홍제', '무악재', '서대문', '충정로(경기대입구)', '신촌(경의중앙선)', '신촌', '가좌'))
head(seo)
seo<-seo%>% select(총계)
seo
totseo<-sum(seo)
totseo


#성북구
seong<-sub1902 %>% filter(역명 %in% c('북한산보국문', '정릉', '성신여대입구', '길음', '한성대입구', '보문', '안암(고대병원앞)', '고려대(종암)','월곡(동덕여대)','상월곡(한국과학기술연구원)', '돌곶이'))
head(seong)
seong<-seong%>% select(총계)
seong
totseong<-sum(seong)
totseong

#종로구
jong<-sub1902 %>% filter(역명 %in% c('독립문', '경복궁(정부서울청사)', '안국', '종로3가', '광화문', '종각', '종로5가', '동대문','동묘앞','혜화', '창신'))
head(jong)
jong<-jong%>% select(총계)
jong
totjong<-sum(jong)
totjong


#중구
jung<-sub1902 %>% filter(역명 %in% c('시청', '을지로입구', '을지로3가', '을지로4가', '동대문역사문화공원', '신당', '청구', '약수','버티고개','동대입구', '충무로', '명동', '회현(남대문시장)'))
head(jung)
jung<-jung%>% select(총계)
jung
totjung<-sum(jung)
totjung


#마포구
mapo<-sub1902 %>% filter(역명 %in% c('월드컵경기장', '마포구청', '홍대입구', '망원', '합정', '상수', '광흥창(서강)', '대흥(서강대앞)','마포','공덕', '애오개', '이대', '아현'))
head(mapo)
mapo<-mapo%>% select(총계)
mapo
totmapo<-sum(mapo)
totmapo


#영등포구
yung<-sub1902 %>% filter(역명 %in% c('국회의사당', '여의나루', '샛강', '여의도', '대방', '신길', '영등포', '신풍','영등포시장','문래', '영등포구청', '당산', '양평', '선유도'))
head(yung)
yung<-yung%>% select(총계)
yung
totyung<-sum(yung)
totyung


#송파구
song<-sub1902 %>% filter(역명 %in% c('잠실나루', '몽촌토성(평화의문)', '잠실(송파구청)', '잠실새내', '종합운동장', '삼전', '석촌고분', '석촌','송파','가락시장', '문정', '장지', '복정', '경찰병원','오금','방이','개롱','거여','마천','올림픽공원','한성백제','송파나루'))
head(song)
song<-song%>% select(총계)
song
totsong<-sum(song)
totsong


#강남구
gnam<-sub1902 %>% filter(역명 %in% c('압구정로데오', '청담', '강남구청', '학동', '논현', '압구정', '신사', '잠원','신논현','언주', '선정릉', '삼성중앙','봉은사', '삼성(무역센터)', '선릉', '역삼', '강남', '한티', '매봉', '도곡', '대치', '학여울', '대청', '일원', '수서', '대모산입구', '개포동', '구룡')) 
head(gnam)
gnam<-gnam%>% select(총계)
gnam
totgnam<-sum(gnam)
totgnam


#서초구
scho<-sub1902 %>% filter(역명 %in% c('신반포', '구반포', '반포', '고속터미널', '사평', '내방', '총신대입구','방배', '서초', '교대(법원.검찰청)', '남부터미널', '양재(서초구청)', '양재시민의숲', '청계산입구', '남태령')) 
head(scho)
scho<-scho%>% select(총계)
scho
totscho<-sum(scho)
totscho


#성동구
sdong<-sub1902 %>% filter(역명 %in% c('상왕십리', '왕십리', '마장', '신답', '용답', '뚝섬', '한양대', '상수', '서울숲', '응봉', '옥수', '행당', '신금호'))
head(sdong)
sdong<-sdong%>% select(총계)
sdong
totsdong<-sum(sdong)
totsdong


#동작구
djak<-sub1902 %>% filter(역명 %in% c('노량진', '노들', '흑석(중앙대입구)', '동작(현충원)', '보라매', '신대방삼거리', '장승배기', '상도','숭실대입구', '남성', '신대방', '사당'))
head(djak)
djak<-djak%>% select(총계)
djak
totdjak<-sum(djak)
totdjak


#데이터프레임 생성 후 막대그래프 그리기
지역구<-c("동작구","도봉구","은평구", "강동구", "강서구","강남구","구로구","중랑구","종로구","중구","강북구","금천구","관악구","광진구","마포구","동대문구","노원구","서초구","성동구","서대문구","성북구","송파구","양천구","용산구","영등포구")
합계2<-c(11439999,5149006,9559464,7749445,12530104,33785245,14306058,5382132,15658511,18348088,11088215,4436051,6433425,10765991,15559454,9227558,11088215,13521623,4946005,5657684,4483995,16278330,2709392,13542792,14345035)
DF1902<-data.frame(지역구,합계2)
DF1902


#19년 3월 자료
sub1903<-read.csv("C:\\Users\\Hanbeen Cho\\Desktop\\카드이용2019\\CARD_SUBWAY_MONTH_201903 (1).csv")
sub1903


#하루 총 이용객수(총계) 변수 추가하기
sub1903<- sub1903 %>% mutate(총계=승차총승객수+하차총승객수)
head(sub1903)

#사용일자, 노선명, 등록일자 삭제
sub1903<- sub1903 %>% select(역명, 승차총승객수, 하차총승객수,총계)
head(sub1903)

#강서구
gangseo<-sub1903 %>% filter(역명 %in% c('방화', '개화산', '김포공항', '송정', '마곡', '발산', '우장산', '화곡', '까치산', '염창', '등촌', '증미', '가양', '양천향교', '마곡나루', '신방화', '공항시장', '개화'))
head(gangseo)                             
gangseo<-gangseo %>% select(총계)
gangseo
totgangseo<-sum(gangseo)
totgangseo

#양천구
yang<-sub1903 %>% filter(역명 %in% c('신목동', '목동', '오목교', '신정네거리', '양천구청', '신정(은행정)'))
head(yang)                             
yang<-yang %>% select(총계)
yang
totyang<-sum(yang)
totyang

#금천구
keum<-sub1903 %>% filter(역명 %in% c('가산디지털단지', '독산', '금천구청'))
head(keum)    
keum<-keum %>% select(총계)
keum
totkeum<-sum(keum)
totkeum

#관악구
kwan<-sub1903 %>% filter(역명 %in% c('신림', '봉천', '서울대입구', '낙성대'))
head(kwan)  
kwan<-kwan %>% select(총계)
kwan
totkwan<-sum(kwan)
totkwan


#은평구
eun<-sub1903 %>% filter(역명 %in% c('독바위', '구파발', '연신내', '불광', '녹번', '역촌', '구산', '응암', '새절(신사)','증산(명지대앞)', '수색', '디지털미디어시티'))
head(eun)
eun<-eun %>% select(총계)
eun
toteun<-sum(eun)
toteun

#구로구
guro<-sub1903 %>% filter(역명 %in% c('온수(성공회대입구)', '천왕', '오류동', '개봉', '구일', '구로', '남구로', '대림(구로구청)', '구로디지털단지','신도림', '도림천'))
head(guro)  
guro<-guro %>% select(총계)
guro
totguro<-sum(guro)
totguro

#구로구
dobong<-sub1903 %>% filter(역명 %in% c('도봉산', '도봉', '방학', '창동', '녹천', '쌍문'))
head(dobong)  
dobong<-dobong %>% select(총계)
dobong
totdobong<-sum(dobong)
totdobong

#중랑구
jlang<-sub1903 %>% filter(역명 %in% c('먹골', '중화', '상봉(시외버스터미널)', '중량', '망우', '양원', '신내', '봉화산(서울의료원)', '면목', '사가정', '용마산'))
head(jlang)  
jlang<-jlang %>% select(총계)
jlang
totjlang<-sum(jlang)
totjlang


#강동구
gangdong<-sub1903 %>% filter(역명 %in% c('강동구청', '천호(풍납토성)', '암사', '강동', '길동', '굽은다리(강동구민회관앞)', '명일', '고덕', '상일동', '강일', '둔촌동', '둔촌오류','중앙보훈병원'))
head(gangdong) 
gangdong<-gangdong %>% select(총계)
gangdong
totgangdong<-sum(gangdong)
totgangdong


#용산구
yong<-sub1903 %>% filter(역명 %in% c('서울역', '숙대입구(갈월)', '녹사평(용산구청)', '이태원', '한강진', '한남', '서빙고', '이촌(국립중앙박물관)', '용산', '남영', '효창공원앞', '삼각지','신용산'))
head(yong) 
yong<-yong %>% select(총계)
yong
totyong<-sum(yong)
totyong


#광진구
kwang<-sub1903 %>% filter(역명 %in% c('중곡', '군자(능동)', '어린이대공원', '아차산(어린이대공원후문)', '광나루(장신대)', '건대입구', '구의(광진구청)', '강변(동서울터미널)', '뚝섬유원지'))
head(kwang) 
kwang<-kwang%>% select(총계)
kwang
totkwang<-sum(kwang)
totkwang

#동대문구
moon<-sub1903 %>% filter(역명 %in% c('신설동', '용두(동대문구청)', '제기동', '청량리(서울시립대입구)', '회기', '외대앞', '신이문', '왕십리(성동구청)'))
head(moon) 
moon<-moon%>% select(총계)
moon
totmoon<-sum(moon)
totmoon

#노원구
noone<-sub1903 %>% filter(역명 %in% c('석계', '광운대', '월계', '태릉입구', '화랑대(서울여대입구)', '공릉(서울과학기술대)', '하계', '중계', '노원', '상계','당고개', '마들', '수락산'))
head(noone) 
noone<-noone%>% select(총계)
noone
totnoone<-sum(noone)
totnoone


#강북구
kbook<-sub1903 %>% filter(역명 %in% c('솔샘', '삼양사거리', '삼양', '회계', '가오리', '4.19민주묘지', '솔밭공원', '북한산우이', '수유(강북구청)', '미아','미아사거리'))
head(kbook) 
kbook<-noone%>% select(총계)
kbook
totkbook<-sum(kbook)
totkbook


#서대문구
seo<-sub1903 %>% filter(역명 %in% c('홍제', '무악재', '서대문', '충정로(경기대입구)', '신촌(경의중앙선)', '신촌', '가좌'))
head(seo)
seo<-seo%>% select(총계)
seo
totseo<-sum(seo)
totseo


#성북구
seong<-sub1903 %>% filter(역명 %in% c('북한산보국문', '정릉', '성신여대입구', '길음', '한성대입구', '보문', '안암(고대병원앞)', '고려대(종암)','월곡(동덕여대)','상월곡(한국과학기술연구원)', '돌곶이'))
head(seong)
seong<-seong%>% select(총계)
seong
totseong<-sum(seong)
totseong

#종로구
jong<-sub1903 %>% filter(역명 %in% c('독립문', '경복궁(정부서울청사)', '안국', '종로3가', '광화문', '종각', '종로5가', '동대문','동묘앞','혜화', '창신'))
head(jong)
jong<-jong%>% select(총계)
jong
totjong<-sum(jong)
totjong


#중구
jung<-sub1903 %>% filter(역명 %in% c('시청', '을지로입구', '을지로3가', '을지로4가', '동대문역사문화공원', '신당', '청구', '약수','버티고개','동대입구', '충무로', '명동', '회현(남대문시장)'))
head(jung)
jung<-jung%>% select(총계)
jung
totjung<-sum(jung)
totjung


#마포구
mapo<-sub1903 %>% filter(역명 %in% c('월드컵경기장', '마포구청', '홍대입구', '망원', '합정', '상수', '광흥창(서강)', '대흥(서강대앞)','마포','공덕', '애오개', '이대', '아현'))
head(mapo)
mapo<-mapo%>% select(총계)
mapo
totmapo<-sum(mapo)
totmapo


#영등포구
yung<-sub1903 %>% filter(역명 %in% c('국회의사당', '여의나루', '샛강', '여의도', '대방', '신길', '영등포', '신풍','영등포시장','문래', '영등포구청', '당산', '양평', '선유도'))
head(yung)
yung<-yung%>% select(총계)
yung
totyung<-sum(yung)
totyung


#송파구
song<-sub1903 %>% filter(역명 %in% c('잠실나루', '몽촌토성(평화의문)', '잠실(송파구청)', '잠실새내', '종합운동장', '삼전', '석촌고분', '석촌','송파','가락시장', '문정', '장지', '복정', '경찰병원','오금','방이','개롱','거여','마천','올림픽공원','한성백제','송파나루'))
head(song)
song<-song%>% select(총계)
song
totsong<-sum(song)
totsong


#강남구
gnam<-sub1903 %>% filter(역명 %in% c('압구정로데오', '청담', '강남구청', '학동', '논현', '압구정', '신사', '잠원','신논현','언주', '선정릉', '삼성중앙','봉은사', '삼성(무역센터)', '선릉', '역삼', '강남', '한티', '매봉', '도곡', '대치', '학여울', '대청', '일원', '수서', '대모산입구', '개포동', '구룡')) 
head(gnam)
gnam<-gnam%>% select(총계)
gnam
totgnam<-sum(gnam)
totgnam


#서초구
scho<-sub1903 %>% filter(역명 %in% c('신반포', '구반포', '반포', '고속터미널', '사평', '내방', '총신대입구','방배', '서초', '교대(법원.검찰청)', '남부터미널', '양재(서초구청)', '양재시민의숲', '청계산입구', '남태령')) 
head(scho)
scho<-scho%>% select(총계)
scho
totscho<-sum(scho)
totscho


#성동구
sdong<-sub1903 %>% filter(역명 %in% c('상왕십리', '왕십리', '마장', '신답', '용답', '뚝섬', '한양대', '상수', '서울숲', '응봉', '옥수', '행당', '신금호'))
head(sdong)
sdong<-sdong%>% select(총계)
sdong
totsdong<-sum(sdong)
totsdong


#동작구
djak<-sub1903 %>% filter(역명 %in% c('노량진', '노들', '흑석(중앙대입구)', '동작(현충원)', '보라매', '신대방삼거리', '장승배기', '상도','숭실대입구', '남성', '신대방', '사당'))
head(djak)
djak<-djak%>% select(총계)
djak
totdjak<-sum(djak)
totdjak


#데이터프레임 생성 후 막대그래프 그리기
지역구<-c("동작구","도봉구","은평구", "강동구", "강서구","강남구","구로구","중랑구","종로구","중구","강북구","금천구","관악구","광진구","마포구","동대문구","노원구","서초구","성동구","서대문구","성북구","송파구","양천구","용산구","영등포구")
합계3<-c(14180734,6294198,11660297,9393602,15063429,40117109,17434455,6584482,18899413,23095305,13917338,5297260,7774879,12911344,18948617,11552165,13917338,16595323,6523924,7146068,6113823,19894369,3321444,15963412,17350582)
DF1903<-data.frame(지역구,합계3)
DF1903

################4월######################3

#install.packages("dplyr")
#library(dplyr)

#19년 4월 자료
sub1904<-read.csv("C:\\Users\\Hanbeen Cho\\Desktop\\카드이용2019\\CARD_SUBWAY_MONTH_201904 (1).csv")
sub1904


#하루 총 이용객수(총계) 변수 추가하기
sub1904<- sub1904 %>% mutate(총계=승차총승객수+하차총승객수)
head(sub1904)

#사용일자, 노선명, 등록일자 삭제
sub1904<- sub1904 %>% select(역명, 승차총승객수, 하차총승객수,총계)
head(sub1904)

#강서구
gangseo<-sub1904 %>% filter(역명 %in% c('방화', '개화산', '김포공항', '송정', '마곡', '발산', '우장산', '화곡', '까치산', '염창', '등촌', '증미', '가양', '양천향교', '마곡나루', '신방화', '공항시장', '개화'))
head(gangseo)                             
gangseo<-gangseo %>% select(총계)
gangseo
totgangseo<-sum(gangseo)
totgangseo

#양천구
yang<-sub1904 %>% filter(역명 %in% c('신목동', '목동', '오목교', '신정네거리', '양천구청', '신정(은행정)'))
head(yang)                             
yang<-yang %>% select(총계)
yang
totyang<-sum(yang)
totyang

#금천구
keum<-sub1904 %>% filter(역명 %in% c('가산디지털단지', '독산', '금천구청'))
head(keum)    
keum<-keum %>% select(총계)
keum
totkeum<-sum(keum)
totkeum

#관악구
kwan<-sub1904 %>% filter(역명 %in% c('신림', '봉천', '서울대입구', '낙성대'))
head(kwan)  
kwan<-kwan %>% select(총계)
kwan
totkwan<-sum(kwan)
totkwan


#은평구
eun<-sub1904 %>% filter(역명 %in% c('독바위', '구파발', '연신내', '불광', '녹번', '역촌', '구산', '응암', '새절(신사)','증산(명지대앞)', '수색', '디지털미디어시티'))
head(eun)
eun<-eun %>% select(총계)
eun
toteun<-sum(eun)
toteun

#구로구
guro<-sub1904 %>% filter(역명 %in% c('온수(성공회대입구)', '천왕', '오류동', '개봉', '구일', '구로', '남구로', '대림(구로구청)', '구로디지털단지','신도림', '도림천'))
head(guro)  
guro<-guro %>% select(총계)
guro
totguro<-sum(guro)
totguro

#구로구
dobong<-sub1904 %>% filter(역명 %in% c('도봉산', '도봉', '방학', '창동', '녹천', '쌍문'))
head(dobong)  
dobong<-dobong %>% select(총계)
dobong
totdobong<-sum(dobong)
totdobong

#중랑구
jlang<-sub1904 %>% filter(역명 %in% c('먹골', '중화', '상봉(시외버스터미널)', '중량', '망우', '양원', '신내', '봉화산(서울의료원)', '면목', '사가정', '용마산'))
head(jlang)  
jlang<-jlang %>% select(총계)
jlang
totjlang<-sum(jlang)
totjlang


#강동구
gangdong<-sub1904 %>% filter(역명 %in% c('강동구청', '천호(풍납토성)', '암사', '강동', '길동', '굽은다리(강동구민회관앞)', '명일', '고덕', '상일동', '강일', '둔촌동', '둔촌오류','중앙보훈병원'))
head(gangdong) 
gangdong<-gangdong %>% select(총계)
gangdong
totgangdong<-sum(gangdong)
totgangdong


#용산구
yong<-sub1904 %>% filter(역명 %in% c('서울역', '숙대입구(갈월)', '녹사평(용산구청)', '이태원', '한강진', '한남', '서빙고', '이촌(국립중앙박물관)', '용산', '남영', '효창공원앞', '삼각지','신용산'))
head(yong) 
yong<-yong %>% select(총계)
yong
totyong<-sum(yong)
totyong


#광진구
kwang<-sub1904 %>% filter(역명 %in% c('중곡', '군자(능동)', '어린이대공원', '아차산(어린이대공원후문)', '광나루(장신대)', '건대입구', '구의(광진구청)', '강변(동서울터미널)', '뚝섬유원지'))
head(kwang) 
kwang<-kwang%>% select(총계)
kwang
totkwang<-sum(kwang)
totkwang

#동대문구
moon<-sub1904 %>% filter(역명 %in% c('신설동', '용두(동대문구청)', '제기동', '청량리(서울시립대입구)', '회기', '외대앞', '신이문', '왕십리(성동구청)'))
head(moon) 
moon<-moon%>% select(총계)
moon
totmoon<-sum(moon)
totmoon

#노원구
noone<-sub1904 %>% filter(역명 %in% c('석계', '광운대', '월계', '태릉입구', '화랑대(서울여대입구)', '공릉(서울과학기술대)', '하계', '중계', '노원', '상계','당고개', '마들', '수락산'))
head(noone) 
noone<-noone%>% select(총계)
noone
totnoone<-sum(noone)
totnoone


#강북구
kbook<-sub1904 %>% filter(역명 %in% c('솔샘', '삼양사거리', '삼양', '회계', '가오리', '4.19민주묘지', '솔밭공원', '북한산우이', '수유(강북구청)', '미아','미아사거리'))
head(kbook) 
kbook<-noone%>% select(총계)
kbook
totkbook<-sum(kbook)
totkbook


#서대문구
seo<-sub1904 %>% filter(역명 %in% c('홍제', '무악재', '서대문', '충정로(경기대입구)', '신촌(경의중앙선)', '신촌', '가좌'))
head(seo)
seo<-seo%>% select(총계)
seo
totseo<-sum(seo)
totseo


#성북구
seong<-sub1904 %>% filter(역명 %in% c('북한산보국문', '정릉', '성신여대입구', '길음', '한성대입구', '보문', '안암(고대병원앞)', '고려대(종암)','월곡(동덕여대)','상월곡(한국과학기술연구원)', '돌곶이'))
head(seong)
seong<-seong%>% select(총계)
seong
totseong<-sum(seong)
totseong

#종로구
jong<-sub1904 %>% filter(역명 %in% c('독립문', '경복궁(정부서울청사)', '안국', '종로3가', '광화문', '종각', '종로5가', '동대문','동묘앞','혜화', '창신'))
head(jong)
jong<-jong%>% select(총계)
jong
totjong<-sum(jong)
totjong


#중구
jung<-sub1904 %>% filter(역명 %in% c('시청', '을지로입구', '을지로3가', '을지로4가', '동대문역사문화공원', '신당', '청구', '약수','버티고개','동대입구', '충무로', '명동', '회현(남대문시장)'))
head(jung)
jung<-jung%>% select(총계)
jung
totjung<-sum(jung)
totjung


#마포구
mapo<-sub1904 %>% filter(역명 %in% c('월드컵경기장', '마포구청', '홍대입구', '망원', '합정', '상수', '광흥창(서강)', '대흥(서강대앞)','마포','공덕', '애오개', '이대', '아현'))
head(mapo)
mapo<-mapo%>% select(총계)
mapo
totmapo<-sum(mapo)
totmapo


#영등포구
yung<-sub1904 %>% filter(역명 %in% c('국회의사당', '여의나루', '샛강', '여의도', '대방', '신길', '영등포', '신풍','영등포시장','문래', '영등포구청', '당산', '양평', '선유도'))
head(yung)
yung<-yung%>% select(총계)
yung
totyung<-sum(yung)
totyung


#송파구
song<-sub1904 %>% filter(역명 %in% c('잠실나루', '몽촌토성(평화의문)', '잠실(송파구청)', '잠실새내', '종합운동장', '삼전', '석촌고분', '석촌','송파','가락시장', '문정', '장지', '복정', '경찰병원','오금','방이','개롱','거여','마천','올림픽공원','한성백제','송파나루'))
head(song)
song<-song%>% select(총계)
song
totsong<-sum(song)
totsong


#강남구
gnam<-sub1904 %>% filter(역명 %in% c('압구정로데오', '청담', '강남구청', '학동', '논현', '압구정', '신사', '잠원','신논현','언주', '선정릉', '삼성중앙','봉은사', '삼성(무역센터)', '선릉', '역삼', '강남', '한티', '매봉', '도곡', '대치', '학여울', '대청', '일원', '수서', '대모산입구', '개포동', '구룡')) 
head(gnam)
gnam<-gnam%>% select(총계)
gnam
totgnam<-sum(gnam)
totgnam


#서초구
scho<-sub1904 %>% filter(역명 %in% c('신반포', '구반포', '반포', '고속터미널', '사평', '내방', '총신대입구','방배', '서초', '교대(법원.검찰청)', '남부터미널', '양재(서초구청)', '양재시민의숲', '청계산입구', '남태령')) 
head(scho)
scho<-scho%>% select(총계)
scho
totscho<-sum(scho)
totscho


#성동구
sdong<-sub1904 %>% filter(역명 %in% c('상왕십리', '왕십리', '마장', '신답', '용답', '뚝섬', '한양대', '상수', '서울숲', '응봉', '옥수', '행당', '신금호'))
head(sdong)
sdong<-sdong%>% select(총계)
sdong
totsdong<-sum(sdong)
totsdong


#동작구
djak<-sub1904 %>% filter(역명 %in% c('노량진', '노들', '흑석(중앙대입구)', '동작(현충원)', '보라매', '신대방삼거리', '장승배기', '상도','숭실대입구', '남성', '신대방', '사당'))
head(djak)
djak<-djak%>% select(총계)
djak
totdjak<-sum(djak)
totdjak


#데이터프레임 생성 후 막대그래프 그리기
지역구<-c("동작구","도봉구","은평구", "강동구", "강서구","강남구","구로구","중랑구","종로구","중구","강북구","금천구","관악구","광진구","마포구","동대문구","노원구","서초구","성동구","서대문구","성북구","송파구","양천구","용산구","영등포구")
합계4<-c(14261488,6324324,11854233,9432498,15264311,40522337,17570882,6638517,18677573,23295818,13950778,5491879,7735996,12890287,18563428,11305239,13950778,16528282,6696737,7025711,6073033,20487713,3351679,15933689,18810803)
DF1904<-data.frame(지역구,합계4)
DF1904



################5월######################3

#install.packages("dplyr")
#library(dplyr)

#19년 5월 자료
sub1905<-read.csv("C:\\Users\\Hanbeen Cho\\Desktop\\카드이용2019\\CARD_SUBWAY_MONTH_201905 (1).csv")
sub1905


#하루 총 이용객수(총계) 변수 추가하기
sub1905<- sub1905 %>% mutate(총계=승차총승객수+하차총승객수)
head(sub1905)

#사용일자, 노선명, 등록일자 삭제
sub1905<- sub1905 %>% select(역명, 승차총승객수, 하차총승객수,총계)
head(sub1905)

#강서구
gangseo<-sub1905 %>% filter(역명 %in% c('방화', '개화산', '김포공항', '송정', '마곡', '발산', '우장산', '화곡', '까치산', '염창', '등촌', '증미', '가양', '양천향교', '마곡나루', '신방화', '공항시장', '개화'))
head(gangseo)                             
gangseo<-gangseo %>% select(총계)
gangseo
totgangseo<-sum(gangseo)
totgangseo

#양천구
yang<-sub1905 %>% filter(역명 %in% c('신목동', '목동', '오목교', '신정네거리', '양천구청', '신정(은행정)'))
head(yang)                             
yang<-yang %>% select(총계)
yang
totyang<-sum(yang)
totyang

#금천구
keum<-sub1905 %>% filter(역명 %in% c('가산디지털단지', '독산', '금천구청'))
head(keum)    
keum<-keum %>% select(총계)
keum
totkeum<-sum(keum)
totkeum

#관악구
kwan<-sub1905 %>% filter(역명 %in% c('신림', '봉천', '서울대입구', '낙성대'))
head(kwan)  
kwan<-kwan %>% select(총계)
kwan
totkwan<-sum(kwan)
totkwan


#은평구
eun<-sub1905 %>% filter(역명 %in% c('독바위', '구파발', '연신내', '불광', '녹번', '역촌', '구산', '응암', '새절(신사)','증산(명지대앞)', '수색', '디지털미디어시티'))
head(eun)
eun<-eun %>% select(총계)
eun
toteun<-sum(eun)
toteun

#구로구
guro<-sub1905 %>% filter(역명 %in% c('온수(성공회대입구)', '천왕', '오류동', '개봉', '구일', '구로', '남구로', '대림(구로구청)', '구로디지털단지','신도림', '도림천'))
head(guro)  
guro<-guro %>% select(총계)
guro
totguro<-sum(guro)
totguro

#구로구
dobong<-sub1905 %>% filter(역명 %in% c('도봉산', '도봉', '방학', '창동', '녹천', '쌍문'))
head(dobong)  
dobong<-dobong %>% select(총계)
dobong
totdobong<-sum(dobong)
totdobong

#중랑구
jlang<-sub1905 %>% filter(역명 %in% c('먹골', '중화', '상봉(시외버스터미널)', '중량', '망우', '양원', '신내', '봉화산(서울의료원)', '면목', '사가정', '용마산'))
head(jlang)  
jlang<-jlang %>% select(총계)
jlang
totjlang<-sum(jlang)
totjlang


#강동구
gangdong<-sub1905 %>% filter(역명 %in% c('강동구청', '천호(풍납토성)', '암사', '강동', '길동', '굽은다리(강동구민회관앞)', '명일', '고덕', '상일동', '강일', '둔촌동', '둔촌오류','중앙보훈병원'))
head(gangdong) 
gangdong<-gangdong %>% select(총계)
gangdong
totgangdong<-sum(gangdong)
totgangdong


#용산구
yong<-sub1905 %>% filter(역명 %in% c('서울역', '숙대입구(갈월)', '녹사평(용산구청)', '이태원', '한강진', '한남', '서빙고', '이촌(국립중앙박물관)', '용산', '남영', '효창공원앞', '삼각지','신용산'))
head(yong) 
yong<-yong %>% select(총계)
yong
totyong<-sum(yong)
totyong


#광진구
kwang<-sub1905 %>% filter(역명 %in% c('중곡', '군자(능동)', '어린이대공원', '아차산(어린이대공원후문)', '광나루(장신대)', '건대입구', '구의(광진구청)', '강변(동서울터미널)', '뚝섬유원지'))
head(kwang) 
kwang<-kwang%>% select(총계)
kwang
totkwang<-sum(kwang)
totkwang

#동대문구
moon<-sub1905 %>% filter(역명 %in% c('신설동', '용두(동대문구청)', '제기동', '청량리(서울시립대입구)', '회기', '외대앞', '신이문', '왕십리(성동구청)'))
head(moon) 
moon<-moon%>% select(총계)
moon
totmoon<-sum(moon)
totmoon

#노원구
noone<-sub1905 %>% filter(역명 %in% c('석계', '광운대', '월계', '태릉입구', '화랑대(서울여대입구)', '공릉(서울과학기술대)', '하계', '중계', '노원', '상계','당고개', '마들', '수락산'))
head(noone) 
noone<-noone%>% select(총계)
noone
totnoone<-sum(noone)
totnoone


#강북구
kbook<-sub1905 %>% filter(역명 %in% c('솔샘', '삼양사거리', '삼양', '회계', '가오리', '4.19민주묘지', '솔밭공원', '북한산우이', '수유(강북구청)', '미아','미아사거리'))
head(kbook) 
kbook<-noone%>% select(총계)
kbook
totkbook<-sum(kbook)
totkbook


#서대문구
seo<-sub1905 %>% filter(역명 %in% c('홍제', '무악재', '서대문', '충정로(경기대입구)', '신촌(경의중앙선)', '신촌', '가좌'))
head(seo)
seo<-seo%>% select(총계)
seo
totseo<-sum(seo)
totseo


#성북구
seong<-sub1905 %>% filter(역명 %in% c('북한산보국문', '정릉', '성신여대입구', '길음', '한성대입구', '보문', '안암(고대병원앞)', '고려대(종암)','월곡(동덕여대)','상월곡(한국과학기술연구원)', '돌곶이'))
head(seong)
seong<-seong%>% select(총계)
seong
totseong<-sum(seong)
totseong

#종로구
jong<-sub1905 %>% filter(역명 %in% c('독립문', '경복궁(정부서울청사)', '안국', '종로3가', '광화문', '종각', '종로5가', '동대문','동묘앞','혜화', '창신'))
head(jong)
jong<-jong%>% select(총계)
jong
totjong<-sum(jong)
totjong


#중구
jung<-sub1905 %>% filter(역명 %in% c('시청', '을지로입구', '을지로3가', '을지로4가', '동대문역사문화공원', '신당', '청구', '약수','버티고개','동대입구', '충무로', '명동', '회현(남대문시장)'))
head(jung)
jung<-jung%>% select(총계)
jung
totjung<-sum(jung)
totjung


#마포구
mapo<-sub1905 %>% filter(역명 %in% c('월드컵경기장', '마포구청', '홍대입구', '망원', '합정', '상수', '광흥창(서강)', '대흥(서강대앞)','마포','공덕', '애오개', '이대', '아현'))
head(mapo)
mapo<-mapo%>% select(총계)
mapo
totmapo<-sum(mapo)
totmapo


#영등포구
yung<-sub1905 %>% filter(역명 %in% c('국회의사당', '여의나루', '샛강', '여의도', '대방', '신길', '영등포', '신풍','영등포시장','문래', '영등포구청', '당산', '양평', '선유도'))
head(yung)
yung<-yung%>% select(총계)
yung
totyung<-sum(yung)
totyung


#송파구
song<-sub1905 %>% filter(역명 %in% c('잠실나루', '몽촌토성(평화의문)', '잠실(송파구청)', '잠실새내', '종합운동장', '삼전', '석촌고분', '석촌','송파','가락시장', '문정', '장지', '복정', '경찰병원','오금','방이','개롱','거여','마천','올림픽공원','한성백제','송파나루'))
head(song)
song<-song%>% select(총계)
song
totsong<-sum(song)
totsong


#강남구
gnam<-sub1905 %>% filter(역명 %in% c('압구정로데오', '청담', '강남구청', '학동', '논현', '압구정', '신사', '잠원','신논현','언주', '선정릉', '삼성중앙','봉은사', '삼성(무역센터)', '선릉', '역삼', '강남', '한티', '매봉', '도곡', '대치', '학여울', '대청', '일원', '수서', '대모산입구', '개포동', '구룡')) 
head(gnam)
gnam<-gnam%>% select(총계)
gnam
totgnam<-sum(gnam)
totgnam


#서초구
scho<-sub1905 %>% filter(역명 %in% c('신반포', '구반포', '반포', '고속터미널', '사평', '내방', '총신대입구','방배', '서초', '교대(법원.검찰청)', '남부터미널', '양재(서초구청)', '양재시민의숲', '청계산입구', '남태령')) 
head(scho)
scho<-scho%>% select(총계)
scho
totscho<-sum(scho)
totscho


#성동구
sdong<-sub1905 %>% filter(역명 %in% c('상왕십리', '왕십리', '마장', '신답', '용답', '뚝섬', '한양대', '상수', '서울숲', '응봉', '옥수', '행당', '신금호'))
head(sdong)
sdong<-sdong%>% select(총계)
sdong
totsdong<-sum(sdong)
totsdong


#동작구
djak<-sub1905 %>% filter(역명 %in% c('노량진', '노들', '흑석(중앙대입구)', '동작(현충원)', '보라매', '신대방삼거리', '장승배기', '상도','숭실대입구', '남성', '신대방', '사당'))
head(djak)
djak<-djak%>% select(총계)
djak
totdjak<-sum(djak)
totdjak


#데이터프레임 생성 후 막대그래프 그리기
지역구<-c("동작구","도봉구","은평구", "강동구", "강서구","강남구","구로구","중랑구","종로구","중구","강북구","금천구","관악구","광진구","마포구","동대문구","노원구","서초구","성동구","서대문구","성북구","송파구","양천구","용산구","영등포구")
합계5<-c(14542823,6581733,12187955,9721600,15605086,41260806,1717111,6899038,19600854,23662420,14653878,5519569,7909858,13678387,19349666,11755308,14653878,17083960,6923668,7265788,634144,20878429,3414622,16646851,18423702)
DF1905<-data.frame(지역구,합계5)
DF1905

################6월######################3

#install.packages("dplyr")
#library(dplyr)

#19년 6월 자료
sub1906<-read.csv("C:\\Users\\Hanbeen Cho\\Desktop\\카드이용2019\\CARD_SUBWAY_MONTH_201906 (1).csv")
sub1906


#하루 총 이용객수(총계) 변수 추가하기
sub1906<- sub1906 %>% mutate(총계=승차총승객수+하차총승객수)
head(sub1906)

#사용일자, 노선명, 등록일자 삭제
sub1906<- sub1906 %>% select(역명, 승차총승객수, 하차총승객수,총계)
head(sub1906)

#강서구
gangseo<-sub1906 %>% filter(역명 %in% c('방화', '개화산', '김포공항', '송정', '마곡', '발산', '우장산', '화곡', '까치산', '염창', '등촌', '증미', '가양', '양천향교', '마곡나루', '신방화', '공항시장', '개화'))
head(gangseo)                             
gangseo<-gangseo %>% select(총계)
gangseo
totgangseo<-sum(gangseo)
totgangseo

#양천구
yang<-sub1906 %>% filter(역명 %in% c('신목동', '목동', '오목교', '신정네거리', '양천구청', '신정(은행정)'))
head(yang)                             
yang<-yang %>% select(총계)
yang
totyang<-sum(yang)
totyang

#금천구
keum<-sub1906 %>% filter(역명 %in% c('가산디지털단지', '독산', '금천구청'))
head(keum)    
keum<-keum %>% select(총계)
keum
totkeum<-sum(keum)
totkeum

#관악구
kwan<-sub1906 %>% filter(역명 %in% c('신림', '봉천', '서울대입구', '낙성대'))
head(kwan)  
kwan<-kwan %>% select(총계)
kwan
totkwan<-sum(kwan)
totkwan


#은평구
eun<-sub1906 %>% filter(역명 %in% c('독바위', '구파발', '연신내', '불광', '녹번', '역촌', '구산', '응암', '새절(신사)','증산(명지대앞)', '수색', '디지털미디어시티'))
head(eun)
eun<-eun %>% select(총계)
eun
toteun<-sum(eun)
toteun

#구로구
guro<-sub1906 %>% filter(역명 %in% c('온수(성공회대입구)', '천왕', '오류동', '개봉', '구일', '구로', '남구로', '대림(구로구청)', '구로디지털단지','신도림', '도림천'))
head(guro)  
guro<-guro %>% select(총계)
guro
totguro<-sum(guro)
totguro

#구로구
dobong<-sub1906 %>% filter(역명 %in% c('도봉산', '도봉', '방학', '창동', '녹천', '쌍문'))
head(dobong)  
dobong<-dobong %>% select(총계)
dobong
totdobong<-sum(dobong)
totdobong

#중랑구
jlang<-sub1906 %>% filter(역명 %in% c('먹골', '중화', '상봉(시외버스터미널)', '중량', '망우', '양원', '신내', '봉화산(서울의료원)', '면목', '사가정', '용마산'))
head(jlang)  
jlang<-jlang %>% select(총계)
jlang
totjlang<-sum(jlang)
totjlang


#강동구
gangdong<-sub1906 %>% filter(역명 %in% c('강동구청', '천호(풍납토성)', '암사', '강동', '길동', '굽은다리(강동구민회관앞)', '명일', '고덕', '상일동', '강일', '둔촌동', '둔촌오류','중앙보훈병원'))
head(gangdong) 
gangdong<-gangdong %>% select(총계)
gangdong
totgangdong<-sum(gangdong)
totgangdong


#용산구
yong<-sub1906 %>% filter(역명 %in% c('서울역', '숙대입구(갈월)', '녹사평(용산구청)', '이태원', '한강진', '한남', '서빙고', '이촌(국립중앙박물관)', '용산', '남영', '효창공원앞', '삼각지','신용산'))
head(yong) 
yong<-yong %>% select(총계)
yong
totyong<-sum(yong)
totyong


#광진구
kwang<-sub1906 %>% filter(역명 %in% c('중곡', '군자(능동)', '어린이대공원', '아차산(어린이대공원후문)', '광나루(장신대)', '건대입구', '구의(광진구청)', '강변(동서울터미널)', '뚝섬유원지'))
head(kwang) 
kwang<-kwang%>% select(총계)
kwang
totkwang<-sum(kwang)
totkwang

#동대문구
moon<-sub1906 %>% filter(역명 %in% c('신설동', '용두(동대문구청)', '제기동', '청량리(서울시립대입구)', '회기', '외대앞', '신이문', '왕십리(성동구청)'))
head(moon) 
moon<-moon%>% select(총계)
moon
totmoon<-sum(moon)
totmoon

#노원구
noone<-sub1906 %>% filter(역명 %in% c('석계', '광운대', '월계', '태릉입구', '화랑대(서울여대입구)', '공릉(서울과학기술대)', '하계', '중계', '노원', '상계','당고개', '마들', '수락산'))
head(noone) 
noone<-noone%>% select(총계)
noone
totnoone<-sum(noone)
totnoone


#강북구
kbook<-sub1906 %>% filter(역명 %in% c('솔샘', '삼양사거리', '삼양', '회계', '가오리', '4.19민주묘지', '솔밭공원', '북한산우이', '수유(강북구청)', '미아','미아사거리'))
head(kbook) 
kbook<-noone%>% select(총계)
kbook
totkbook<-sum(kbook)
totkbook


#서대문구
seo<-sub1906 %>% filter(역명 %in% c('홍제', '무악재', '서대문', '충정로(경기대입구)', '신촌(경의중앙선)', '신촌', '가좌'))
head(seo)
seo<-seo%>% select(총계)
seo
totseo<-sum(seo)
totseo


#성북구
seong<-sub1906 %>% filter(역명 %in% c('북한산보국문', '정릉', '성신여대입구', '길음', '한성대입구', '보문', '안암(고대병원앞)', '고려대(종암)','월곡(동덕여대)','상월곡(한국과학기술연구원)', '돌곶이'))
head(seong)
seong<-seong%>% select(총계)
seong
totseong<-sum(seong)
totseong

#종로구
jong<-sub1906 %>% filter(역명 %in% c('독립문', '경복궁(정부서울청사)', '안국', '종로3가', '광화문', '종각', '종로5가', '동대문','동묘앞','혜화', '창신'))
head(jong)
jong<-jong%>% select(총계)
jong
totjong<-sum(jong)
totjong


#중구
jung<-sub1906 %>% filter(역명 %in% c('시청', '을지로입구', '을지로3가', '을지로4가', '동대문역사문화공원', '신당', '청구', '약수','버티고개','동대입구', '충무로', '명동', '회현(남대문시장)'))
head(jung)
jung<-jung%>% select(총계)
jung
totjung<-sum(jung)
totjung


#마포구
mapo<-sub1906 %>% filter(역명 %in% c('월드컵경기장', '마포구청', '홍대입구', '망원', '합정', '상수', '광흥창(서강)', '대흥(서강대앞)','마포','공덕', '애오개', '이대', '아현'))
head(mapo)
mapo<-mapo%>% select(총계)
mapo
totmapo<-sum(mapo)
totmapo


#영등포구
yung<-sub1906 %>% filter(역명 %in% c('국회의사당', '여의나루', '샛강', '여의도', '대방', '신길', '영등포', '신풍','영등포시장','문래', '영등포구청', '당산', '양평', '선유도'))
head(yung)
yung<-yung%>% select(총계)
yung
totyung<-sum(yung)
totyung


#송파구
song<-sub1906 %>% filter(역명 %in% c('잠실나루', '몽촌토성(평화의문)', '잠실(송파구청)', '잠실새내', '종합운동장', '삼전', '석촌고분', '석촌','송파','가락시장', '문정', '장지', '복정', '경찰병원','오금','방이','개롱','거여','마천','올림픽공원','한성백제','송파나루'))
head(song)
song<-song%>% select(총계)
song
totsong<-sum(song)
totsong


#강남구
gnam<-sub1906 %>% filter(역명 %in% c('압구정로데오', '청담', '강남구청', '학동', '논현', '압구정', '신사', '잠원','신논현','언주', '선정릉', '삼성중앙','봉은사', '삼성(무역센터)', '선릉', '역삼', '강남', '한티', '매봉', '도곡', '대치', '학여울', '대청', '일원', '수서', '대모산입구', '개포동', '구룡')) 
head(gnam)
gnam<-gnam%>% select(총계)
gnam
totgnam<-sum(gnam)
totgnam


#서초구
scho<-sub1906 %>% filter(역명 %in% c('신반포', '구반포', '반포', '고속터미널', '사평', '내방', '총신대입구','방배', '서초', '교대(법원.검찰청)', '남부터미널', '양재(서초구청)', '양재시민의숲', '청계산입구', '남태령')) 
head(scho)
scho<-scho%>% select(총계)
scho
totscho<-sum(scho)
totscho


#성동구
sdong<-sub1906 %>% filter(역명 %in% c('상왕십리', '왕십리', '마장', '신답', '용답', '뚝섬', '한양대', '상수', '서울숲', '응봉', '옥수', '행당', '신금호'))
head(sdong)
sdong<-sdong%>% select(총계)
sdong
totsdong<-sum(sdong)
totsdong


#동작구
djak<-sub1906 %>% filter(역명 %in% c('노량진', '노들', '흑석(중앙대입구)', '동작(현충원)', '보라매', '신대방삼거리', '장승배기', '상도','숭실대입구', '남성', '신대방', '사당'))
head(djak)
djak<-djak%>% select(총계)
djak
totdjak<-sum(djak)
totdjak


#데이터프레임 생성 후 막대그래프 그리기
지역구<-c("동작구","도봉구","은평구", "강동구", "강서구","강남구","구로구","중랑구","종로구","중구","강북구","금천구","관악구","광진구","마포구","동대문구","노원구","서초구","성동구","서대문구","성북구","송파구","양천구","용산구","영등포구")
합계6<-c(13424647,6037825,11182456,8950474,14405721,38162814,16546102,6256042,17644614,21739642,1341445,5016906,7350378,12290943,17669462,10679648,13041445,15652415,6163059,6548088,5509250,18861756,3101205,15438742,16710480)
DF1906<-data.frame(지역구,합계6)
DF1906

################7월######################3

#install.packages("dplyr")
#library(dplyr)

#19년 7 자료
sub1907<-read.csv("C:\\Users\\Hanbeen Cho\\Desktop\\카드이용2019\\CARD_SUBWAY_MONTH_201907 (1).csv")
sub1907


#하루 총 이용객수(총계) 변수 추가하기
sub1907<- sub1907 %>% mutate(총계=승차총승객수+하차총승객수)
head(sub1907)

#사용일자, 노선명, 등록일자 삭제
sub1907<- sub1907 %>% select(역명, 승차총승객수, 하차총승객수,총계)
head(sub1907)

#강서구
gangseo<-sub1907 %>% filter(역명 %in% c('방화', '개화산', '김포공항', '송정', '마곡', '발산', '우장산', '화곡', '까치산', '염창', '등촌', '증미', '가양', '양천향교', '마곡나루', '신방화', '공항시장', '개화'))
head(gangseo)                             
gangseo<-gangseo %>% select(총계)
gangseo
totgangseo<-sum(gangseo)
totgangseo

#양천구
yang<-sub1907 %>% filter(역명 %in% c('신목동', '목동', '오목교', '신정네거리', '양천구청', '신정(은행정)'))
head(yang)                             
yang<-yang %>% select(총계)
yang
totyang<-sum(yang)
totyang

#금천구
keum<-sub1907 %>% filter(역명 %in% c('가산디지털단지', '독산', '금천구청'))
head(keum)    
keum<-keum %>% select(총계)
keum
totkeum<-sum(keum)
totkeum

#관악구
kwan<-sub1907 %>% filter(역명 %in% c('신림', '봉천', '서울대입구', '낙성대'))
head(kwan)  
kwan<-kwan %>% select(총계)
kwan
totkwan<-sum(kwan)
totkwan


#은평구
eun<-sub1907 %>% filter(역명 %in% c('독바위', '구파발', '연신내', '불광', '녹번', '역촌', '구산', '응암', '새절(신사)','증산(명지대앞)', '수색', '디지털미디어시티'))
head(eun)
eun<-eun %>% select(총계)
eun
toteun<-sum(eun)
toteun

#구로구
guro<-sub1907 %>% filter(역명 %in% c('온수(성공회대입구)', '천왕', '오류동', '개봉', '구일', '구로', '남구로', '대림(구로구청)', '구로디지털단지','신도림', '도림천'))
head(guro)  
guro<-guro %>% select(총계)
guro
totguro<-sum(guro)
totguro

#구로구
dobong<-sub1907 %>% filter(역명 %in% c('도봉산', '도봉', '방학', '창동', '녹천', '쌍문'))
head(dobong)  
dobong<-dobong %>% select(총계)
dobong
totdobong<-sum(dobong)
totdobong

#중랑구
jlang<-sub1907 %>% filter(역명 %in% c('먹골', '중화', '상봉(시외버스터미널)', '중량', '망우', '양원', '신내', '봉화산(서울의료원)', '면목', '사가정', '용마산'))
head(jlang)  
jlang<-jlang %>% select(총계)
jlang
totjlang<-sum(jlang)
totjlang


#강동구
gangdong<-sub1907 %>% filter(역명 %in% c('강동구청', '천호(풍납토성)', '암사', '강동', '길동', '굽은다리(강동구민회관앞)', '명일', '고덕', '상일동', '강일', '둔촌동', '둔촌오류','중앙보훈병원'))
head(gangdong) 
gangdong<-gangdong %>% select(총계)
gangdong
totgangdong<-sum(gangdong)
totgangdong


#용산구
yong<-sub1907 %>% filter(역명 %in% c('서울역', '숙대입구(갈월)', '녹사평(용산구청)', '이태원', '한강진', '한남', '서빙고', '이촌(국립중앙박물관)', '용산', '남영', '효창공원앞', '삼각지','신용산'))
head(yong) 
yong<-yong %>% select(총계)
yong
totyong<-sum(yong)
totyong


#광진구
kwang<-sub1907 %>% filter(역명 %in% c('중곡', '군자(능동)', '어린이대공원', '아차산(어린이대공원후문)', '광나루(장신대)', '건대입구', '구의(광진구청)', '강변(동서울터미널)', '뚝섬유원지'))
head(kwang) 
kwang<-kwang%>% select(총계)
kwang
totkwang<-sum(kwang)
totkwang

#동대문구
moon<-sub1907 %>% filter(역명 %in% c('신설동', '용두(동대문구청)', '제기동', '청량리(서울시립대입구)', '회기', '외대앞', '신이문', '왕십리(성동구청)'))
head(moon) 
moon<-moon%>% select(총계)
moon
totmoon<-sum(moon)
totmoon

#노원구
noone<-sub1907 %>% filter(역명 %in% c('석계', '광운대', '월계', '태릉입구', '화랑대(서울여대입구)', '공릉(서울과학기술대)', '하계', '중계', '노원', '상계','당고개', '마들', '수락산'))
head(noone) 
noone<-noone%>% select(총계)
noone
totnoone<-sum(noone)
totnoone


#강북구
kbook<-sub1907 %>% filter(역명 %in% c('솔샘', '삼양사거리', '삼양', '회계', '가오리', '4.19민주묘지', '솔밭공원', '북한산우이', '수유(강북구청)', '미아','미아사거리'))
head(kbook) 
kbook<-noone%>% select(총계)
kbook
totkbook<-sum(kbook)
totkbook


#서대문구
seo<-sub1907 %>% filter(역명 %in% c('홍제', '무악재', '서대문', '충정로(경기대입구)', '신촌(경의중앙선)', '신촌', '가좌'))
head(seo)
seo<-seo%>% select(총계)
seo
totseo<-sum(seo)
totseo


#성북구
seong<-sub1907 %>% filter(역명 %in% c('북한산보국문', '정릉', '성신여대입구', '길음', '한성대입구', '보문', '안암(고대병원앞)', '고려대(종암)','월곡(동덕여대)','상월곡(한국과학기술연구원)', '돌곶이'))
head(seong)
seong<-seong%>% select(총계)
seong
totseong<-sum(seong)
totseong

#종로구
jong<-sub1907 %>% filter(역명 %in% c('독립문', '경복궁(정부서울청사)', '안국', '종로3가', '광화문', '종각', '종로5가', '동대문','동묘앞','혜화', '창신'))
head(jong)
jong<-jong%>% select(총계)
jong
totjong<-sum(jong)
totjong


#중구
jung<-sub1907 %>% filter(역명 %in% c('시청', '을지로입구', '을지로3가', '을지로4가', '동대문역사문화공원', '신당', '청구', '약수','버티고개','동대입구', '충무로', '명동', '회현(남대문시장)'))
head(jung)
jung<-jung%>% select(총계)
jung
totjung<-sum(jung)
totjung


#마포구
mapo<-sub1907 %>% filter(역명 %in% c('월드컵경기장', '마포구청', '홍대입구', '망원', '합정', '상수', '광흥창(서강)', '대흥(서강대앞)','마포','공덕', '애오개', '이대', '아현'))
head(mapo)
mapo<-mapo%>% select(총계)
mapo
totmapo<-sum(mapo)
totmapo


#영등포구
yung<-sub1907 %>% filter(역명 %in% c('국회의사당', '여의나루', '샛강', '여의도', '대방', '신길', '영등포', '신풍','영등포시장','문래', '영등포구청', '당산', '양평', '선유도'))
head(yung)
yung<-yung%>% select(총계)
yung
totyung<-sum(yung)
totyung


#송파구
song<-sub1907 %>% filter(역명 %in% c('잠실나루', '몽촌토성(평화의문)', '잠실(송파구청)', '잠실새내', '종합운동장', '삼전', '석촌고분', '석촌','송파','가락시장', '문정', '장지', '복정', '경찰병원','오금','방이','개롱','거여','마천','올림픽공원','한성백제','송파나루'))
head(song)
song<-song%>% select(총계)
song
totsong<-sum(song)
totsong


#강남구
gnam<-sub1907 %>% filter(역명 %in% c('압구정로데오', '청담', '강남구청', '학동', '논현', '압구정', '신사', '잠원','신논현','언주', '선정릉', '삼성중앙','봉은사', '삼성(무역센터)', '선릉', '역삼', '강남', '한티', '매봉', '도곡', '대치', '학여울', '대청', '일원', '수서', '대모산입구', '개포동', '구룡')) 
head(gnam)
gnam<-gnam%>% select(총계)
gnam
totgnam<-sum(gnam)
totgnam


#서초구
scho<-sub1907 %>% filter(역명 %in% c('신반포', '구반포', '반포', '고속터미널', '사평', '내방', '총신대입구','방배', '서초', '교대(법원.검찰청)', '남부터미널', '양재(서초구청)', '양재시민의숲', '청계산입구', '남태령')) 
head(scho)
scho<-scho%>% select(총계)
scho
totscho<-sum(scho)
totscho


#성동구
sdong<-sub1907 %>% filter(역명 %in% c('상왕십리', '왕십리', '마장', '신답', '용답', '뚝섬', '한양대', '상수', '서울숲', '응봉', '옥수', '행당', '신금호'))
head(sdong)
sdong<-sdong%>% select(총계)
sdong
totsdong<-sum(sdong)
totsdong


#동작구
djak<-sub1907 %>% filter(역명 %in% c('노량진', '노들', '흑석(중앙대입구)', '동작(현충원)', '보라매', '신대방삼거리', '장승배기', '상도','숭실대입구', '남성', '신대방', '사당'))
head(djak)
djak<-djak%>% select(총계)
djak
totdjak<-sum(djak)
totdjak


#데이터프레임 생성 후 막대그래프 그리기
지역구<-c("동작구","도봉구","은평구", "강동구", "강서구","강남구","구로구","중랑구","종로구","중구","강북구","금천구","관악구","광진구","마포구","동대문구","노원구","서초구","성동구","서대문구","성북구","송파구","양천구","용산구","영등포구")
합계7<-c(13673915,6122727,11642963,9440497,15133207,42626804,17182001,6402015,18177233,22462651,13280951,5503485,7689452,12585945,18359530,10723149,13280951,16302643,6212217,6852655,5448982,19983503,3250985,15740705,17765954)
DF1907<-data.frame(지역구,합계7)
DF1907


################7월######################3

#install.packages("dplyr")
#library(dplyr)

#19년 8 자료
sub1908<-read.csv("C:\\Users\\Hanbeen Cho\\Desktop\\카드이용2019\\CARD_SUBWAY_MONTH_201908 (1).csv")
sub1908

#하루 총 이용객수(총계) 변수 추가하기
sub1908<- sub1908 %>% mutate(총계=승차총승객수+하차총승객수)
head(sub1908)

#사용일자, 노선명, 등록일자 삭제
sub1908<- sub1908 %>% select(역명, 승차총승객수, 하차총승객수,총계)
head(sub1908)

#강서구
gangseo<-sub1908 %>% filter(역명 %in% c('방화', '개화산', '김포공항', '송정', '마곡', '발산', '우장산', '화곡', '까치산', '염창', '등촌', '증미', '가양', '양천향교', '마곡나루', '신방화', '공항시장', '개화'))
head(gangseo)                             
gangseo<-gangseo %>% select(총계)
gangseo
totgangseo<-sum(gangseo)
totgangseo

#양천구
yang<-sub1908 %>% filter(역명 %in% c('신목동', '목동', '오목교', '신정네거리', '양천구청', '신정(은행정)'))
head(yang)                             
yang<-yang %>% select(총계)
yang
totyang<-sum(yang)
totyang

#금천구
keum<-sub1908 %>% filter(역명 %in% c('가산디지털단지', '독산', '금천구청'))
head(keum)    
keum<-keum %>% select(총계)
keum
totkeum<-sum(keum)
totkeum

#관악구
kwan<-sub1908 %>% filter(역명 %in% c('신림', '봉천', '서울대입구', '낙성대'))
head(kwan)  
kwan<-kwan %>% select(총계)
kwan
totkwan<-sum(kwan)
totkwan


#은평구
eun<-sub1908 %>% filter(역명 %in% c('독바위', '구파발', '연신내', '불광', '녹번', '역촌', '구산', '응암', '새절(신사)','증산(명지대앞)', '수색', '디지털미디어시티'))
head(eun)
eun<-eun %>% select(총계)
eun
toteun<-sum(eun)
toteun

#구로구
guro<-sub1908 %>% filter(역명 %in% c('온수(성공회대입구)', '천왕', '오류동', '개봉', '구일', '구로', '남구로', '대림(구로구청)', '구로디지털단지','신도림', '도림천'))
head(guro)  
guro<-guro %>% select(총계)
guro
totguro<-sum(guro)
totguro

#구로구
dobong<-sub1908 %>% filter(역명 %in% c('도봉산', '도봉', '방학', '창동', '녹천', '쌍문'))
head(dobong)  
dobong<-dobong %>% select(총계)
dobong
totdobong<-sum(dobong)
totdobong

#중랑구
jlang<-sub1908 %>% filter(역명 %in% c('먹골', '중화', '상봉(시외버스터미널)', '중량', '망우', '양원', '신내', '봉화산(서울의료원)', '면목', '사가정', '용마산'))
head(jlang)  
jlang<-jlang %>% select(총계)
jlang
totjlang<-sum(jlang)
totjlang


#강동구
gangdong<-sub1908 %>% filter(역명 %in% c('강동구청', '천호(풍납토성)', '암사', '강동', '길동', '굽은다리(강동구민회관앞)', '명일', '고덕', '상일동', '강일', '둔촌동', '둔촌오류','중앙보훈병원'))
head(gangdong) 
gangdong<-gangdong %>% select(총계)
gangdong
totgangdong<-sum(gangdong)
totgangdong


#용산구
yong<-sub1908 %>% filter(역명 %in% c('서울역', '숙대입구(갈월)', '녹사평(용산구청)', '이태원', '한강진', '한남', '서빙고', '이촌(국립중앙박물관)', '용산', '남영', '효창공원앞', '삼각지','신용산'))
head(yong) 
yong<-yong %>% select(총계)
yong
totyong<-sum(yong)
totyong


#광진구
kwang<-sub1908 %>% filter(역명 %in% c('중곡', '군자(능동)', '어린이대공원', '아차산(어린이대공원후문)', '광나루(장신대)', '건대입구', '구의(광진구청)', '강변(동서울터미널)', '뚝섬유원지'))
head(kwang) 
kwang<-kwang%>% select(총계)
kwang
totkwang<-sum(kwang)
totkwang

#동대문구
moon<-sub1908 %>% filter(역명 %in% c('신설동', '용두(동대문구청)', '제기동', '청량리(서울시립대입구)', '회기', '외대앞', '신이문', '왕십리(성동구청)'))
head(moon) 
moon<-moon%>% select(총계)
moon
totmoon<-sum(moon)
totmoon

#노원구
noone<-sub1908 %>% filter(역명 %in% c('석계', '광운대', '월계', '태릉입구', '화랑대(서울여대입구)', '공릉(서울과학기술대)', '하계', '중계', '노원', '상계','당고개', '마들', '수락산'))
head(noone) 
noone<-noone%>% select(총계)
noone
totnoone<-sum(noone)
totnoone


#강북구
kbook<-sub1908 %>% filter(역명 %in% c('솔샘', '삼양사거리', '삼양', '회계', '가오리', '4.19민주묘지', '솔밭공원', '북한산우이', '수유(강북구청)', '미아','미아사거리'))
head(kbook) 
kbook<-noone%>% select(총계)
kbook
totkbook<-sum(kbook)
totkbook


#서대문구
seo<-sub1908 %>% filter(역명 %in% c('홍제', '무악재', '서대문', '충정로(경기대입구)', '신촌(경의중앙선)', '신촌', '가좌'))
head(seo)
seo<-seo%>% select(총계)
seo
totseo<-sum(seo)
totseo


#성북구
seong<-sub1908 %>% filter(역명 %in% c('북한산보국문', '정릉', '성신여대입구', '길음', '한성대입구', '보문', '안암(고대병원앞)', '고려대(종암)','월곡(동덕여대)','상월곡(한국과학기술연구원)', '돌곶이'))
head(seong)
seong<-seong%>% select(총계)
seong
totseong<-sum(seong)
totseong

#종로구
jong<-sub1908 %>% filter(역명 %in% c('독립문', '경복궁(정부서울청사)', '안국', '종로3가', '광화문', '종각', '종로5가', '동대문','동묘앞','혜화', '창신'))
head(jong)
jong<-jong%>% select(총계)
jong
totjong<-sum(jong)
totjong


#중구
jung<-sub1908 %>% filter(역명 %in% c('시청', '을지로입구', '을지로3가', '을지로4가', '동대문역사문화공원', '신당', '청구', '약수','버티고개','동대입구', '충무로', '명동', '회현(남대문시장)'))
head(jung)
jung<-jung%>% select(총계)
jung
totjung<-sum(jung)
totjung


#마포구
mapo<-sub1908 %>% filter(역명 %in% c('월드컵경기장', '마포구청', '홍대입구', '망원', '합정', '상수', '광흥창(서강)', '대흥(서강대앞)','마포','공덕', '애오개', '이대', '아현'))
head(mapo)
mapo<-mapo%>% select(총계)
mapo
totmapo<-sum(mapo)
totmapo


#영등포구
yung<-sub1908 %>% filter(역명 %in% c('국회의사당', '여의나루', '샛강', '여의도', '대방', '신길', '영등포', '신풍','영등포시장','문래', '영등포구청', '당산', '양평', '선유도'))
head(yung)
yung<-yung%>% select(총계)
yung
totyung<-sum(yung)
totyung


#송파구
song<-sub1908 %>% filter(역명 %in% c('잠실나루', '몽촌토성(평화의문)', '잠실(송파구청)', '잠실새내', '종합운동장', '삼전', '석촌고분', '석촌','송파','가락시장', '문정', '장지', '복정', '경찰병원','오금','방이','개롱','거여','마천','올림픽공원','한성백제','송파나루'))
head(song)
song<-song%>% select(총계)
song
totsong<-sum(song)
totsong


#강남구
gnam<-sub1908 %>% filter(역명 %in% c('압구정로데오', '청담', '강남구청', '학동', '논현', '압구정', '신사', '잠원','신논현','언주', '선정릉', '삼성중앙','봉은사', '삼성(무역센터)', '선릉', '역삼', '강남', '한티', '매봉', '도곡', '대치', '학여울', '대청', '일원', '수서', '대모산입구', '개포동', '구룡')) 
head(gnam)
gnam<-gnam%>% select(총계)
gnam
totgnam<-sum(gnam)
totgnam


#서초구
scho<-sub1908 %>% filter(역명 %in% c('신반포', '구반포', '반포', '고속터미널', '사평', '내방', '총신대입구','방배', '서초', '교대(법원.검찰청)', '남부터미널', '양재(서초구청)', '양재시민의숲', '청계산입구', '남태령')) 
head(scho)
scho<-scho%>% select(총계)
scho
totscho<-sum(scho)
totscho


#성동구
sdong<-sub1908 %>% filter(역명 %in% c('상왕십리', '왕십리', '마장', '신답', '용답', '뚝섬', '한양대', '상수', '서울숲', '응봉', '옥수', '행당', '신금호'))
head(sdong)
sdong<-sdong%>% select(총계)
sdong
totsdong<-sum(sdong)
totsdong


#동작구
djak<-sub1908 %>% filter(역명 %in% c('노량진', '노들', '흑석(중앙대입구)', '동작(현충원)', '보라매', '신대방삼거리', '장승배기', '상도','숭실대입구', '남성', '신대방', '사당'))
head(djak)
djak<-djak%>% select(총계)
djak
totdjak<-sum(djak)
totdjak


#데이터프레임 생성 후 막대그래프 그리기
지역구<-c("동작구","도봉구","은평구", "강동구", "강서구","강남구","구로구","중랑구","종로구","중구","강북구","금천구","관악구","광진구","마포구","동대문구","노원구","서초구","성동구","서대문구","성북구","송파구","양천구","용산구","영등포구")
합계8<-c(12970896,5829261,11106214,8965350,14448266,39803054,16302476,6124948,17633709,21724614,12645709,4998417,7342843,12226430,17924091,10382999,12645709,15822539,5883967,6495182,5133290,19142879,3042560,15579029,16959258)
DF1908<-data.frame(지역구,합계8)
DF1908

################10월######################3

#install.packages("dplyr")
#library(dplyr)

#19년 10 자료
sub1910<-read.csv("C:\\Users\\Hanbeen Cho\\Desktop\\카드이용2019\\CARD_SUBWAY_MONTH_201910 (1).csv")
sub1910

#하루 총 이용객수(총계) 변수 추가하기
sub1910<- sub1910 %>% mutate(총계=승차총승객수+하차총승객수)
head(sub1910)

#사용일자, 노선명, 등록일자 삭제
sub1910<- sub1910 %>% select(역명, 승차총승객수, 하차총승객수,총계)
head(sub1910)

#강서구
gangseo<-sub1910 %>% filter(역명 %in% c('방화', '개화산', '김포공항', '송정', '마곡', '발산', '우장산', '화곡', '까치산', '염창', '등촌', '증미', '가양', '양천향교', '마곡나루', '신방화', '공항시장', '개화'))
head(gangseo)                             
gangseo<-gangseo %>% select(총계)
gangseo
totgangseo<-sum(gangseo)
totgangseo

#양천구
yang<-sub1910 %>% filter(역명 %in% c('신목동', '목동', '오목교', '신정네거리', '양천구청', '신정(은행정)'))
head(yang)                             
yang<-yang %>% select(총계)
yang
totyang<-sum(yang)
totyang

#금천구
keum<-sub1910 %>% filter(역명 %in% c('가산디지털단지', '독산', '금천구청'))
head(keum)    
keum<-keum %>% select(총계)
keum
totkeum<-sum(keum)
totkeum

#관악구
kwan<-sub1910 %>% filter(역명 %in% c('신림', '봉천', '서울대입구', '낙성대'))
head(kwan)  
kwan<-kwan %>% select(총계)
kwan
totkwan<-sum(kwan)
totkwan


#은평구
eun<-sub1910 %>% filter(역명 %in% c('독바위', '구파발', '연신내', '불광', '녹번', '역촌', '구산', '응암', '새절(신사)','증산(명지대앞)', '수색', '디지털미디어시티'))
head(eun)
eun<-eun %>% select(총계)
eun
toteun<-sum(eun)
toteun

#구로구
guro<-sub1910 %>% filter(역명 %in% c('온수(성공회대입구)', '천왕', '오류동', '개봉', '구일', '구로', '남구로', '대림(구로구청)', '구로디지털단지','신도림', '도림천'))
head(guro)  
guro<-guro %>% select(총계)
guro
totguro<-sum(guro)
totguro

#구로구
dobong<-sub1910 %>% filter(역명 %in% c('도봉산', '도봉', '방학', '창동', '녹천', '쌍문'))
head(dobong)  
dobong<-dobong %>% select(총계)
dobong
totdobong<-sum(dobong)
totdobong

#중랑구
jlang<-sub1910 %>% filter(역명 %in% c('먹골', '중화', '상봉(시외버스터미널)', '중량', '망우', '양원', '신내', '봉화산(서울의료원)', '면목', '사가정', '용마산'))
head(jlang)  
jlang<-jlang %>% select(총계)
jlang
totjlang<-sum(jlang)
totjlang


#강동구
gangdong<-sub1910 %>% filter(역명 %in% c('강동구청', '천호(풍납토성)', '암사', '강동', '길동', '굽은다리(강동구민회관앞)', '명일', '고덕', '상일동', '강일', '둔촌동', '둔촌오류','중앙보훈병원'))
head(gangdong) 
gangdong<-gangdong %>% select(총계)
gangdong
totgangdong<-sum(gangdong)
totgangdong


#용산구
yong<-sub1910 %>% filter(역명 %in% c('서울역', '숙대입구(갈월)', '녹사평(용산구청)', '이태원', '한강진', '한남', '서빙고', '이촌(국립중앙박물관)', '용산', '남영', '효창공원앞', '삼각지','신용산'))
head(yong) 
yong<-yong %>% select(총계)
yong
totyong<-sum(yong)
totyong


#광진구
kwang<-sub1910 %>% filter(역명 %in% c('중곡', '군자(능동)', '어린이대공원', '아차산(어린이대공원후문)', '광나루(장신대)', '건대입구', '구의(광진구청)', '강변(동서울터미널)', '뚝섬유원지'))
head(kwang) 
kwang<-kwang%>% select(총계)
kwang
totkwang<-sum(kwang)
totkwang

#동대문구
moon<-sub1910 %>% filter(역명 %in% c('신설동', '용두(동대문구청)', '제기동', '청량리(서울시립대입구)', '회기', '외대앞', '신이문', '왕십리(성동구청)'))
head(moon) 
moon<-moon%>% select(총계)
moon
totmoon<-sum(moon)
totmoon

#노원구
noone<-sub1910 %>% filter(역명 %in% c('석계', '광운대', '월계', '태릉입구', '화랑대(서울여대입구)', '공릉(서울과학기술대)', '하계', '중계', '노원', '상계','당고개', '마들', '수락산'))
head(noone) 
noone<-noone%>% select(총계)
noone
totnoone<-sum(noone)
totnoone


#강북구
kbook<-sub1910 %>% filter(역명 %in% c('솔샘', '삼양사거리', '삼양', '회계', '가오리', '4.19민주묘지', '솔밭공원', '북한산우이', '수유(강북구청)', '미아','미아사거리'))
head(kbook) 
kbook<-noone%>% select(총계)
kbook
totkbook<-sum(kbook)
totkbook


#서대문구
seo<-sub1910 %>% filter(역명 %in% c('홍제', '무악재', '서대문', '충정로(경기대입구)', '신촌(경의중앙선)', '신촌', '가좌'))
head(seo)
seo<-seo%>% select(총계)
seo
totseo<-sum(seo)
totseo


#성북구
seong<-sub1910 %>% filter(역명 %in% c('북한산보국문', '정릉', '성신여대입구', '길음', '한성대입구', '보문', '안암(고대병원앞)', '고려대(종암)','월곡(동덕여대)','상월곡(한국과학기술연구원)', '돌곶이'))
head(seong)
seong<-seong%>% select(총계)
seong
totseong<-sum(seong)
totseong

#종로구
jong<-sub1910 %>% filter(역명 %in% c('독립문', '경복궁(정부서울청사)', '안국', '종로3가', '광화문', '종각', '종로5가', '동대문','동묘앞','혜화', '창신'))
head(jong)
jong<-jong%>% select(총계)
jong
totjong<-sum(jong)
totjong


#중구
jung<-sub1910 %>% filter(역명 %in% c('시청', '을지로입구', '을지로3가', '을지로4가', '동대문역사문화공원', '신당', '청구', '약수','버티고개','동대입구', '충무로', '명동', '회현(남대문시장)'))
head(jung)
jung<-jung%>% select(총계)
jung
totjung<-sum(jung)
totjung


#마포구
mapo<-sub1910 %>% filter(역명 %in% c('월드컵경기장', '마포구청', '홍대입구', '망원', '합정', '상수', '광흥창(서강)', '대흥(서강대앞)','마포','공덕', '애오개', '이대', '아현'))
head(mapo)
mapo<-mapo%>% select(총계)
mapo
totmapo<-sum(mapo)
totmapo


#영등포구
yung<-sub1910 %>% filter(역명 %in% c('국회의사당', '여의나루', '샛강', '여의도', '대방', '신길', '영등포', '신풍','영등포시장','문래', '영등포구청', '당산', '양평', '선유도'))
head(yung)
yung<-yung%>% select(총계)
yung
totyung<-sum(yung)
totyung


#송파구
song<-sub1910 %>% filter(역명 %in% c('잠실나루', '몽촌토성(평화의문)', '잠실(송파구청)', '잠실새내', '종합운동장', '삼전', '석촌고분', '석촌','송파','가락시장', '문정', '장지', '복정', '경찰병원','오금','방이','개롱','거여','마천','올림픽공원','한성백제','송파나루'))
head(song)
song<-song%>% select(총계)
song
totsong<-sum(song)
totsong


#강남구
gnam<-sub1910 %>% filter(역명 %in% c('압구정로데오', '청담', '강남구청', '학동', '논현', '압구정', '신사', '잠원','신논현','언주', '선정릉', '삼성중앙','봉은사', '삼성(무역센터)', '선릉', '역삼', '강남', '한티', '매봉', '도곡', '대치', '학여울', '대청', '일원', '수서', '대모산입구', '개포동', '구룡')) 
head(gnam)
gnam<-gnam%>% select(총계)
gnam
totgnam<-sum(gnam)
totgnam


#서초구
scho<-sub1910 %>% filter(역명 %in% c('신반포', '구반포', '반포', '고속터미널', '사평', '내방', '총신대입구','방배', '서초', '교대(법원.검찰청)', '남부터미널', '양재(서초구청)', '양재시민의숲', '청계산입구', '남태령')) 
head(scho)
scho<-scho%>% select(총계)
scho
totscho<-sum(scho)
totscho


#성동구
sdong<-sub1910 %>% filter(역명 %in% c('상왕십리', '왕십리', '마장', '신답', '용답', '뚝섬', '한양대', '상수', '서울숲', '응봉', '옥수', '행당', '신금호'))
head(sdong)
sdong<-sdong%>% select(총계)
sdong
totsdong<-sum(sdong)
totsdong


#동작구
djak<-sub1910 %>% filter(역명 %in% c('노량진', '노들', '흑석(중앙대입구)', '동작(현충원)', '보라매', '신대방삼거리', '장승배기', '상도','숭실대입구', '남성', '신대방', '사당'))
head(djak)
djak<-djak%>% select(총계)
djak
totdjak<-sum(djak)
totdjak


#데이터프레임 생성 후 막대그래프 그리기
지역구<-c("동작구","도봉구","은평구", "강동구", "강서구","강남구","구로구","중랑구","종로구","중구","강북구","금천구","관악구","광진구","마포구","동대문구","노원구","서초구","성동구","서대문구","성북구","송파구","양천구","용산구","영등포구")
합계10<-c(12848510,5802747,10772485,8625864,13885756,36466737,15940748,6025392,16832727,20750167,12706352,4913412,7012679,11744101,16987441,10410302,12706352,15408463,6070864,6401520,5575912,17970971,2993573,14817371,16296986)
DF1910<-data.frame(지역구,합계10)
DF1910



################9월######################3

#install.packages("dplyr")
#library(dplyr)

#19년 9 자료
sub1909<-read.csv("C:\\Users\\Hanbeen Cho\\Desktop\\카드이용2019\\CARD_SUBWAY_MONTH_201909 (1).csv")
sub1909

#하루 총 이용객수(총계) 변수 추가하기
sub1909<- sub1909 %>% mutate(총계=승차총승객수+하차총승객수)
head(sub1909)

#사용일자, 노선명, 등록일자 삭제
sub1909<- sub1909 %>% select(역명, 승차총승객수, 하차총승객수,총계)
head(sub1909)

#강서구
gangseo<-sub1909 %>% filter(역명 %in% c('방화', '개화산', '김포공항', '송정', '마곡', '발산', '우장산', '화곡', '까치산', '염창', '등촌', '증미', '가양', '양천향교', '마곡나루', '신방화', '공항시장', '개화'))
head(gangseo)                             
gangseo<-gangseo %>% select(총계)
gangseo
totgangseo<-sum(gangseo)
totgangseo

#양천구
yang<-sub1909 %>% filter(역명 %in% c('신목동', '목동', '오목교', '신정네거리', '양천구청', '신정(은행정)'))
head(yang)                             
yang<-yang %>% select(총계)
yang
totyang<-sum(yang)
totyang

#금천구
keum<-sub1909 %>% filter(역명 %in% c('가산디지털단지', '독산', '금천구청'))
head(keum)    
keum<-keum %>% select(총계)
keum
totkeum<-sum(keum)
totkeum

#관악구
kwan<-sub1909 %>% filter(역명 %in% c('신림', '봉천', '서울대입구', '낙성대'))
head(kwan)  
kwan<-kwan %>% select(총계)
kwan
totkwan<-sum(kwan)
totkwan


#은평구
eun<-sub1909 %>% filter(역명 %in% c('독바위', '구파발', '연신내', '불광', '녹번', '역촌', '구산', '응암', '새절(신사)','증산(명지대앞)', '수색', '디지털미디어시티'))
head(eun)
eun<-eun %>% select(총계)
eun
toteun<-sum(eun)
toteun

#구로구
guro<-sub1909 %>% filter(역명 %in% c('온수(성공회대입구)', '천왕', '오류동', '개봉', '구일', '구로', '남구로', '대림(구로구청)', '구로디지털단지','신도림', '도림천'))
head(guro)  
guro<-guro %>% select(총계)
guro
totguro<-sum(guro)
totguro

#구로구
dobong<-sub1909 %>% filter(역명 %in% c('도봉산', '도봉', '방학', '창동', '녹천', '쌍문'))
head(dobong)  
dobong<-dobong %>% select(총계)
dobong
totdobong<-sum(dobong)
totdobong

#중랑구
jlang<-sub1909 %>% filter(역명 %in% c('먹골', '중화', '상봉(시외버스터미널)', '중량', '망우', '양원', '신내', '봉화산(서울의료원)', '면목', '사가정', '용마산'))
head(jlang)  
jlang<-jlang %>% select(총계)
jlang
totjlang<-sum(jlang)
totjlang


#강동구
gangdong<-sub1909 %>% filter(역명 %in% c('강동구청', '천호(풍납토성)', '암사', '강동', '길동', '굽은다리(강동구민회관앞)', '명일', '고덕', '상일동', '강일', '둔촌동', '둔촌오류','중앙보훈병원'))
head(gangdong) 
gangdong<-gangdong %>% select(총계)
gangdong
totgangdong<-sum(gangdong)
totgangdong


#용산구
yong<-sub1909 %>% filter(역명 %in% c('서울역', '숙대입구(갈월)', '녹사평(용산구청)', '이태원', '한강진', '한남', '서빙고', '이촌(국립중앙박물관)', '용산', '남영', '효창공원앞', '삼각지','신용산'))
head(yong) 
yong<-yong %>% select(총계)
yong
totyong<-sum(yong)
totyong


#광진구
kwang<-sub1909 %>% filter(역명 %in% c('중곡', '군자(능동)', '어린이대공원', '아차산(어린이대공원후문)', '광나루(장신대)', '건대입구', '구의(광진구청)', '강변(동서울터미널)', '뚝섬유원지'))
head(kwang) 
kwang<-kwang%>% select(총계)
kwang
totkwang<-sum(kwang)
totkwang

#동대문구
moon<-sub1909 %>% filter(역명 %in% c('신설동', '용두(동대문구청)', '제기동', '청량리(서울시립대입구)', '회기', '외대앞', '신이문', '왕십리(성동구청)'))
head(moon) 
moon<-moon%>% select(총계)
moon
totmoon<-sum(moon)
totmoon

#노원구
noone<-sub1909 %>% filter(역명 %in% c('석계', '광운대', '월계', '태릉입구', '화랑대(서울여대입구)', '공릉(서울과학기술대)', '하계', '중계', '노원', '상계','당고개', '마들', '수락산'))
head(noone) 
noone<-noone%>% select(총계)
noone
totnoone<-sum(noone)
totnoone


#강북구
kbook<-sub1909 %>% filter(역명 %in% c('솔샘', '삼양사거리', '삼양', '회계', '가오리', '4.19민주묘지', '솔밭공원', '북한산우이', '수유(강북구청)', '미아','미아사거리'))
head(kbook) 
kbook<-noone%>% select(총계)
kbook
totkbook<-sum(kbook)
totkbook


#서대문구
seo<-sub1909 %>% filter(역명 %in% c('홍제', '무악재', '서대문', '충정로(경기대입구)', '신촌(경의중앙선)', '신촌', '가좌'))
head(seo)
seo<-seo%>% select(총계)
seo
totseo<-sum(seo)
totseo


#성북구
seong<-sub1909 %>% filter(역명 %in% c('북한산보국문', '정릉', '성신여대입구', '길음', '한성대입구', '보문', '안암(고대병원앞)', '고려대(종암)','월곡(동덕여대)','상월곡(한국과학기술연구원)', '돌곶이'))
head(seong)
seong<-seong%>% select(총계)
seong
totseong<-sum(seong)
totseong

#종로구
jong<-sub1909 %>% filter(역명 %in% c('독립문', '경복궁(정부서울청사)', '안국', '종로3가', '광화문', '종각', '종로5가', '동대문','동묘앞','혜화', '창신'))
head(jong)
jong<-jong%>% select(총계)
jong
totjong<-sum(jong)
totjong


#중구
jung<-sub1909 %>% filter(역명 %in% c('시청', '을지로입구', '을지로3가', '을지로4가', '동대문역사문화공원', '신당', '청구', '약수','버티고개','동대입구', '충무로', '명동', '회현(남대문시장)'))
head(jung)
jung<-jung%>% select(총계)
jung
totjung<-sum(jung)
totjung


#마포구
mapo<-sub1909 %>% filter(역명 %in% c('월드컵경기장', '마포구청', '홍대입구', '망원', '합정', '상수', '광흥창(서강)', '대흥(서강대앞)','마포','공덕', '애오개', '이대', '아현'))
head(mapo)
mapo<-mapo%>% select(총계)
mapo
totmapo<-sum(mapo)
totmapo


#영등포구
yung<-sub1909 %>% filter(역명 %in% c('국회의사당', '여의나루', '샛강', '여의도', '대방', '신길', '영등포', '신풍','영등포시장','문래', '영등포구청', '당산', '양평', '선유도'))
head(yung)
yung<-yung%>% select(총계)
yung
totyung<-sum(yung)
totyung


#송파구
song<-sub1909 %>% filter(역명 %in% c('잠실나루', '몽촌토성(평화의문)', '잠실(송파구청)', '잠실새내', '종합운동장', '삼전', '석촌고분', '석촌','송파','가락시장', '문정', '장지', '복정', '경찰병원','오금','방이','개롱','거여','마천','올림픽공원','한성백제','송파나루'))
head(song)
song<-song%>% select(총계)
song
totsong<-sum(song)
totsong


#강남구
gnam<-sub1909 %>% filter(역명 %in% c('압구정로데오', '청담', '강남구청', '학동', '논현', '압구정', '신사', '잠원','신논현','언주', '선정릉', '삼성중앙','봉은사', '삼성(무역센터)', '선릉', '역삼', '강남', '한티', '매봉', '도곡', '대치', '학여울', '대청', '일원', '수서', '대모산입구', '개포동', '구룡')) 
head(gnam)
gnam<-gnam%>% select(총계)
gnam
totgnam<-sum(gnam)
totgnam


#서초구
scho<-sub1909 %>% filter(역명 %in% c('신반포', '구반포', '반포', '고속터미널', '사평', '내방', '총신대입구','방배', '서초', '교대(법원.검찰청)', '남부터미널', '양재(서초구청)', '양재시민의숲', '청계산입구', '남태령')) 
head(scho)
scho<-scho%>% select(총계)
scho
totscho<-sum(scho)
totscho


#성동구
sdong<-sub1909 %>% filter(역명 %in% c('상왕십리', '왕십리', '마장', '신답', '용답', '뚝섬', '한양대', '상수', '서울숲', '응봉', '옥수', '행당', '신금호'))
head(sdong)
sdong<-sdong%>% select(총계)
sdong
totsdong<-sum(sdong)
totsdong


#동작구
djak<-sub1909 %>% filter(역명 %in% c('노량진', '노들', '흑석(중앙대입구)', '동작(현충원)', '보라매', '신대방삼거리', '장승배기', '상도','숭실대입구', '남성', '신대방', '사당'))
head(djak)
djak<-djak%>% select(총계)
djak
totdjak<-sum(djak)
totdjak


#데이터프레임 생성 후 막대그래프 그리기
지역구<-c("동작구","도봉구","은평구", "강동구", "강서구","강남구","구로구","중랑구","종로구","중구","강북구","금천구","관악구","광진구","마포구","동대문구","노원구","서초구","성동구","서대문구","성북구","송파구","양천구","용산구","영등포구")
합계9<-c(14372306,6412666,12098723,9740735,15328813,41075487,17605359,6683663,19800362,24074392,13989347,5459412,7744161,12990622,19250882,11368184,13989347,17304064,6811139,7123852,6084913,20672566,3357308,16857347,18438646)
DF1909<-data.frame(지역구,합계9)
DF1909


################12월######################3

#install.packages("dplyr")
#library(dplyr)

#19년 12 자료
sub1912<-read.csv("C:\\Users\\Hanbeen Cho\\Desktop\\카드이용2019\\CARD_SUBWAY_MONTH_201912 (1).csv")
sub1912

#하루 총 이용객수(총계) 변수 추가하기
sub1912<- sub1912 %>% mutate(총계=승차총승객수+하차총승객수)
head(sub1912)

#사용일자, 노선명, 등록일자 삭제
sub1912<- sub1912 %>% select(역명, 승차총승객수, 하차총승객수,총계)
head(sub1912)

#강서구
gangseo<-sub1912 %>% filter(역명 %in% c('방화', '개화산', '김포공항', '송정', '마곡', '발산', '우장산', '화곡', '까치산', '염창', '등촌', '증미', '가양', '양천향교', '마곡나루', '신방화', '공항시장', '개화'))
head(gangseo)                             
gangseo<-gangseo %>% select(총계)
gangseo
totgangseo<-sum(gangseo)
totgangseo

#양천구
yang<-sub1912 %>% filter(역명 %in% c('신목동', '목동', '오목교', '신정네거리', '양천구청', '신정(은행정)'))
head(yang)                             
yang<-yang %>% select(총계)
yang
totyang<-sum(yang)
totyang

#금천구
keum<-sub1912 %>% filter(역명 %in% c('가산디지털단지', '독산', '금천구청'))
head(keum)    
keum<-keum %>% select(총계)
keum
totkeum<-sum(keum)
totkeum

#관악구
kwan<-sub1912 %>% filter(역명 %in% c('신림', '봉천', '서울대입구', '낙성대'))
head(kwan)  
kwan<-kwan %>% select(총계)
kwan
totkwan<-sum(kwan)
totkwan


#은평구
eun<-sub1912 %>% filter(역명 %in% c('독바위', '구파발', '연신내', '불광', '녹번', '역촌', '구산', '응암', '새절(신사)','증산(명지대앞)', '수색', '디지털미디어시티'))
head(eun)
eun<-eun %>% select(총계)
eun
toteun<-sum(eun)
toteun

#구로구
guro<-sub1912 %>% filter(역명 %in% c('온수(성공회대입구)', '천왕', '오류동', '개봉', '구일', '구로', '남구로', '대림(구로구청)', '구로디지털단지','신도림', '도림천'))
head(guro)  
guro<-guro %>% select(총계)
guro
totguro<-sum(guro)
totguro

#도봉구
dobong<-sub1912 %>% filter(역명 %in% c('도봉산', '도봉', '방학', '창동', '녹천', '쌍문'))
head(dobong)  
dobong<-dobong %>% select(총계)
dobong
totdobong<-sum(dobong)
totdobong

#중랑구
jlang<-sub1912 %>% filter(역명 %in% c('먹골', '중화', '상봉(시외버스터미널)', '중량', '망우', '양원', '신내', '봉화산(서울의료원)', '면목', '사가정', '용마산'))
head(jlang)  
jlang<-jlang %>% select(총계)
jlang
totjlang<-sum(jlang)
totjlang


#강동구
gangdong<-sub1912 %>% filter(역명 %in% c('강동구청', '천호(풍납토성)', '암사', '강동', '길동', '굽은다리(강동구민회관앞)', '명일', '고덕', '상일동', '강일', '둔촌동', '둔촌오류','중앙보훈병원'))
head(gangdong) 
gangdong<-gangdong %>% select(총계)
gangdong
totgangdong<-sum(gangdong)
totgangdong


#용산구
yong<-sub1912 %>% filter(역명 %in% c('서울역', '숙대입구(갈월)', '녹사평(용산구청)', '이태원', '한강진', '한남', '서빙고', '이촌(국립중앙박물관)', '용산', '남영', '효창공원앞', '삼각지','신용산'))
head(yong) 
yong<-yong %>% select(총계)
yong
totyong<-sum(yong)
totyong


#광진구
kwang<-sub1912 %>% filter(역명 %in% c('중곡', '군자(능동)', '어린이대공원', '아차산(어린이대공원후문)', '광나루(장신대)', '건대입구', '구의(광진구청)', '강변(동서울터미널)', '뚝섬유원지'))
head(kwang) 
kwang<-kwang%>% select(총계)
kwang
totkwang<-sum(kwang)
totkwang

#동대문구
moon<-sub1912 %>% filter(역명 %in% c('신설동', '용두(동대문구청)', '제기동', '청량리(서울시립대입구)', '회기', '외대앞', '신이문', '왕십리(성동구청)'))
head(moon) 
moon<-moon%>% select(총계)
moon
totmoon<-sum(moon)
totmoon

#노원구
noone<-sub1912 %>% filter(역명 %in% c('석계', '광운대', '월계', '태릉입구', '화랑대(서울여대입구)', '공릉(서울과학기술대)', '하계', '중계', '노원', '상계','당고개', '마들', '수락산'))
head(noone) 
noone<-noone%>% select(총계)
noone
totnoone<-sum(noone)
totnoone


#강북구
kbook<-sub1912 %>% filter(역명 %in% c('솔샘', '삼양사거리', '삼양', '회계', '가오리', '4.19민주묘지', '솔밭공원', '북한산우이', '수유(강북구청)', '미아','미아사거리'))
head(kbook) 
kbook<-noone%>% select(총계)
kbook
totkbook<-sum(kbook)
totkbook


#서대문구
seo<-sub1912 %>% filter(역명 %in% c('홍제', '무악재', '서대문', '충정로(경기대입구)', '신촌(경의중앙선)', '신촌', '가좌'))
head(seo)
seo<-seo%>% select(총계)
seo
totseo<-sum(seo)
totseo


#성북구
seong<-sub1912 %>% filter(역명 %in% c('북한산보국문', '정릉', '성신여대입구', '길음', '한성대입구', '보문', '안암(고대병원앞)', '고려대(종암)','월곡(동덕여대)','상월곡(한국과학기술연구원)', '돌곶이'))
head(seong)
seong<-seong%>% select(총계)
seong
totseong<-sum(seong)
totseong

#종로구
jong<-sub1912 %>% filter(역명 %in% c('독립문', '경복궁(정부서울청사)', '안국', '종로3가', '광화문', '종각', '종로5가', '동대문','동묘앞','혜화', '창신'))
head(jong)
jong<-jong%>% select(총계)
jong
totjong<-sum(jong)
totjong


#중구
jung<-sub1912 %>% filter(역명 %in% c('시청', '을지로입구', '을지로3가', '을지로4가', '동대문역사문화공원', '신당', '청구', '약수','버티고개','동대입구', '충무로', '명동', '회현(남대문시장)'))
head(jung)
jung<-jung%>% select(총계)
jung
totjung<-sum(jung)
totjung


#마포구
mapo<-sub1912 %>% filter(역명 %in% c('월드컵경기장', '마포구청', '홍대입구', '망원', '합정', '상수', '광흥창(서강)', '대흥(서강대앞)','마포','공덕', '애오개', '이대', '아현'))
head(mapo)
mapo<-mapo%>% select(총계)
mapo
totmapo<-sum(mapo)
totmapo


#영등포구
yung<-sub1912 %>% filter(역명 %in% c('국회의사당', '여의나루', '샛강', '여의도', '대방', '신길', '영등포', '신풍','영등포시장','문래', '영등포구청', '당산', '양평', '선유도'))
head(yung)
yung<-yung%>% select(총계)
yung
totyung<-sum(yung)
totyung


#송파구
song<-sub1912 %>% filter(역명 %in% c('잠실나루', '몽촌토성(평화의문)', '잠실(송파구청)', '잠실새내', '종합운동장', '삼전', '석촌고분', '석촌','송파','가락시장', '문정', '장지', '복정', '경찰병원','오금','방이','개롱','거여','마천','올림픽공원','한성백제','송파나루'))
head(song)
song<-song%>% select(총계)
song
totsong<-sum(song)
totsong


#강남구
gnam<-sub1912 %>% filter(역명 %in% c('압구정로데오', '청담', '강남구청', '학동', '논현', '압구정', '신사', '잠원','신논현','언주', '선정릉', '삼성중앙','봉은사', '삼성(무역센터)', '선릉', '역삼', '강남', '한티', '매봉', '도곡', '대치', '학여울', '대청', '일원', '수서', '대모산입구', '개포동', '구룡')) 
head(gnam)
gnam<-gnam%>% select(총계)
gnam
totgnam<-sum(gnam)
totgnam


#서초구
scho<-sub1912 %>% filter(역명 %in% c('신반포', '구반포', '반포', '고속터미널', '사평', '내방', '총신대입구','방배', '서초', '교대(법원.검찰청)', '남부터미널', '양재(서초구청)', '양재시민의숲', '청계산입구', '남태령')) 
head(scho)
scho<-scho%>% select(총계)
scho
totscho<-sum(scho)
totscho


#성동구
sdong<-sub1912 %>% filter(역명 %in% c('상왕십리', '왕십리', '마장', '신답', '용답', '뚝섬', '한양대', '상수', '서울숲', '응봉', '옥수', '행당', '신금호'))
head(sdong)
sdong<-sdong%>% select(총계)
sdong
totsdong<-sum(sdong)
totsdong


#동작구
djak<-sub1912 %>% filter(역명 %in% c('노량진', '노들', '흑석(중앙대입구)', '동작(현충원)', '보라매', '신대방삼거리', '장승배기', '상도','숭실대입구', '남성', '신대방', '사당'))
head(djak)
djak<-djak%>% select(총계)
djak
totdjak<-sum(djak)
totdjak


#데이터프레임 생성 후 막대그래프 그리기
지역구<-c("동작구","도봉구","은평구", "강동구", "강서구","강남구","구로구","중랑구","종로구","중구","강북구","금천구","관악구","광진구","마포구","동대문구","노원구","서초구","성동구","서대문구","성북구","송파구","양천구","용산구","영등포구")
합계12<-c(14200035,6170964,11741747,9830257,15161393,42492184,17288767,6516921,19269855,23629176,13606860,5315982,7707125,12769838,19167992,11056214,13606860,16867047,6465813,7014334,5838785,20455172,3295602,16550594,17839222)
DF1912<-data.frame(지역구,합계12)
DF1912




################11월######################3

#install.packages("dplyr")
#library(dplyr)

#19년 11 자료
sub1911<-read.csv("C:\\Users\\Hanbeen Cho\\Desktop\\카드이용2019\\CARD_SUBWAY_MONTH_201911 (1).csv")
sub1911

#하루 총 이용객수(총계) 변수 추가하기
sub1911<- sub1911 %>% mutate(총계=승차총승객수+하차총승객수)
head(sub1911)

#사용일자, 노선명, 등록일자 삭제
sub1911<- sub1911 %>% select(역명, 승차총승객수, 하차총승객수,총계)
head(sub1911)

#강서구
gangseo<-sub1911 %>% filter(역명 %in% c('방화', '개화산', '김포공항', '송정', '마곡', '발산', '우장산', '화곡', '까치산', '염창', '등촌', '증미', '가양', '양천향교', '마곡나루', '신방화', '공항시장', '개화'))
head(gangseo)                             
gangseo<-gangseo %>% select(총계)
gangseo
totgangseo<-sum(gangseo)
totgangseo

#양천구
yang<-sub1911 %>% filter(역명 %in% c('신목동', '목동', '오목교', '신정네거리', '양천구청', '신정(은행정)'))
head(yang)                             
yang<-yang %>% select(총계)
yang
totyang<-sum(yang)
totyang

#금천구
keum<-sub1911 %>% filter(역명 %in% c('가산디지털단지', '독산', '금천구청'))
head(keum)    
keum<-keum %>% select(총계)
keum
totkeum<-sum(keum)
totkeum

#관악구
kwan<-sub1911 %>% filter(역명 %in% c('신림', '봉천', '서울대입구', '낙성대'))
head(kwan)  
kwan<-kwan %>% select(총계)
kwan
totkwan<-sum(kwan)
totkwan


#은평구
eun<-sub1911 %>% filter(역명 %in% c('독바위', '구파발', '연신내', '불광', '녹번', '역촌', '구산', '응암', '새절(신사)','증산(명지대앞)', '수색', '디지털미디어시티'))
head(eun)
eun<-eun %>% select(총계)
eun
toteun<-sum(eun)
toteun

#구로구
guro<-sub1911 %>% filter(역명 %in% c('온수(성공회대입구)', '천왕', '오류동', '개봉', '구일', '구로', '남구로', '대림(구로구청)', '구로디지털단지','신도림', '도림천'))
head(guro)  
guro<-guro %>% select(총계)
guro
totguro<-sum(guro)
totguro

#도봉구
dobong<-sub1911 %>% filter(역명 %in% c('도봉산', '도봉', '방학', '창동', '녹천', '쌍문'))
head(dobong)  
dobong<-dobong %>% select(총계)
dobong
totdobong<-sum(dobong)
totdobong

#중랑구
jlang<-sub1911 %>% filter(역명 %in% c('먹골', '중화', '상봉(시외버스터미널)', '중량', '망우', '양원', '신내', '봉화산(서울의료원)', '면목', '사가정', '용마산'))
head(jlang)  
jlang<-jlang %>% select(총계)
jlang
totjlang<-sum(jlang)
totjlang


#강동구
gangdong<-sub1911 %>% filter(역명 %in% c('강동구청', '천호(풍납토성)', '암사', '강동', '길동', '굽은다리(강동구민회관앞)', '명일', '고덕', '상일동', '강일', '둔촌동', '둔촌오류','중앙보훈병원'))
head(gangdong) 
gangdong<-gangdong %>% select(총계)
gangdong
totgangdong<-sum(gangdong)
totgangdong


#용산구
yong<-sub1911 %>% filter(역명 %in% c('서울역', '숙대입구(갈월)', '녹사평(용산구청)', '이태원', '한강진', '한남', '서빙고', '이촌(국립중앙박물관)', '용산', '남영', '효창공원앞', '삼각지','신용산'))
head(yong) 
yong<-yong %>% select(총계)
yong
totyong<-sum(yong)
totyong


#광진구
kwang<-sub1911 %>% filter(역명 %in% c('중곡', '군자(능동)', '어린이대공원', '아차산(어린이대공원후문)', '광나루(장신대)', '건대입구', '구의(광진구청)', '강변(동서울터미널)', '뚝섬유원지'))
head(kwang) 
kwang<-kwang%>% select(총계)
kwang
totkwang<-sum(kwang)
totkwang

#동대문구
moon<-sub1911 %>% filter(역명 %in% c('신설동', '용두(동대문구청)', '제기동', '청량리(서울시립대입구)', '회기', '외대앞', '신이문', '왕십리(성동구청)'))
head(moon) 
moon<-moon%>% select(총계)
moon
totmoon<-sum(moon)
totmoon

#노원구
noone<-sub1911 %>% filter(역명 %in% c('석계', '광운대', '월계', '태릉입구', '화랑대(서울여대입구)', '공릉(서울과학기술대)', '하계', '중계', '노원', '상계','당고개', '마들', '수락산'))
head(noone) 
noone<-noone%>% select(총계)
noone
totnoone<-sum(noone)
totnoone


#강북구
kbook<-sub1911 %>% filter(역명 %in% c('솔샘', '삼양사거리', '삼양', '회계', '가오리', '4.19민주묘지', '솔밭공원', '북한산우이', '수유(강북구청)', '미아','미아사거리'))
head(kbook) 
kbook<-noone%>% select(총계)
kbook
totkbook<-sum(kbook)
totkbook


#서대문구
seo<-sub1911 %>% filter(역명 %in% c('홍제', '무악재', '서대문', '충정로(경기대입구)', '신촌(경의중앙선)', '신촌', '가좌'))
head(seo)
seo<-seo%>% select(총계)
seo
totseo<-sum(seo)
totseo


#성북구
seong<-sub1911 %>% filter(역명 %in% c('북한산보국문', '정릉', '성신여대입구', '길음', '한성대입구', '보문', '안암(고대병원앞)', '고려대(종암)','월곡(동덕여대)','상월곡(한국과학기술연구원)', '돌곶이'))
head(seong)
seong<-seong%>% select(총계)
seong
totseong<-sum(seong)
totseong

#종로구
jong<-sub1911 %>% filter(역명 %in% c('독립문', '경복궁(정부서울청사)', '안국', '종로3가', '광화문', '종각', '종로5가', '동대문','동묘앞','혜화', '창신'))
head(jong)
jong<-jong%>% select(총계)
jong
totjong<-sum(jong)
totjong


#중구
jung<-sub1911 %>% filter(역명 %in% c('시청', '을지로입구', '을지로3가', '을지로4가', '동대문역사문화공원', '신당', '청구', '약수','버티고개','동대입구', '충무로', '명동', '회현(남대문시장)'))
head(jung)
jung<-jung%>% select(총계)
jung
totjung<-sum(jung)
totjung


#마포구
mapo<-sub1911 %>% filter(역명 %in% c('월드컵경기장', '마포구청', '홍대입구', '망원', '합정', '상수', '광흥창(서강)', '대흥(서강대앞)','마포','공덕', '애오개', '이대', '아현'))
head(mapo)
mapo<-mapo%>% select(총계)
mapo
totmapo<-sum(mapo)
totmapo


#영등포구
yung<-sub1911 %>% filter(역명 %in% c('국회의사당', '여의나루', '샛강', '여의도', '대방', '신길', '영등포', '신풍','영등포시장','문래', '영등포구청', '당산', '양평', '선유도'))
head(yung)
yung<-yung%>% select(총계)
yung
totyung<-sum(yung)
totyung


#송파구
song<-sub1911 %>% filter(역명 %in% c('잠실나루', '몽촌토성(평화의문)', '잠실(송파구청)', '잠실새내', '종합운동장', '삼전', '석촌고분', '석촌','송파','가락시장', '문정', '장지', '복정', '경찰병원','오금','방이','개롱','거여','마천','올림픽공원','한성백제','송파나루'))
head(song)
song<-song%>% select(총계)
song
totsong<-sum(song)
totsong


#강남구
gnam<-sub1911 %>% filter(역명 %in% c('압구정로데오', '청담', '강남구청', '학동', '논현', '압구정', '신사', '잠원','신논현','언주', '선정릉', '삼성중앙','봉은사', '삼성(무역센터)', '선릉', '역삼', '강남', '한티', '매봉', '도곡', '대치', '학여울', '대청', '일원', '수서', '대모산입구', '개포동', '구룡')) 
head(gnam)
gnam<-gnam%>% select(총계)
gnam
totgnam<-sum(gnam)
totgnam


#서초구
scho<-sub1911 %>% filter(역명 %in% c('신반포', '구반포', '반포', '고속터미널', '사평', '내방', '총신대입구','방배', '서초', '교대(법원.검찰청)', '남부터미널', '양재(서초구청)', '양재시민의숲', '청계산입구', '남태령')) 
head(scho)
scho<-scho%>% select(총계)
scho
totscho<-sum(scho)
totscho


#성동구
sdong<-sub1911 %>% filter(역명 %in% c('상왕십리', '왕십리', '마장', '신답', '용답', '뚝섬', '한양대', '상수', '서울숲', '응봉', '옥수', '행당', '신금호'))
head(sdong)
sdong<-sdong%>% select(총계)
sdong
totsdong<-sum(sdong)
totsdong


#동작구
djak<-sub1911 %>% filter(역명 %in% c('노량진', '노들', '흑석(중앙대입구)', '동작(현충원)', '보라매', '신대방삼거리', '장승배기', '상도','숭실대입구', '남성', '신대방', '사당'))
head(djak)
djak<-djak%>% select(총계)
djak
totdjak<-sum(djak)
totdjak


#데이터프레임 생성 후 막대그래프 그리기
지역구<-c("동작구","도봉구","은평구", "강동구", "강서구","강남구","구로구","중랑구","종로구","중구","강북구","금천구","관악구","광진구","마포구","동대문구","노원구","서초구","성동구","서대문구","성북구","송파구","양천구","용산구","영등포구")
합계11<-c(14030039,6182675,11717362,9598488,14973517,41172163,17115574,6485088,18708955,23126377,13700749,5370379,7563873,12596851,18588265,11119819,13700749,16663270,6678933,6996781,5996314,19704234,3287873,16108647,17583640)
DF1911<-data.frame(지역구,합계11)
DF1911


####################

DF2<-merge(DF1901,DF1902,by=c("지역구"))
DF2

DF4<-merge(DF1903,DF1904,by=c("지역구"))
DF4

DF6<-merge(DF1905,DF1906,by=c("지역구"))
DF6

DF8<-merge(DF1907,DF1908,by=c("지역구"))
DF8

DF10<-merge(DF1909,DF1910,by=c("지역구"))
DF10

DF12<-merge(DF1911,DF1912,by=c("지역구"))
DF12


DF24<-merge(DF2,DF4,by=c("지역구"))
DF24

DF68<-merge(DF6,DF8,by=c("지역구"))
DF68

DF1012<-merge(DF10,DF12,by=c("지역구"))
DF1012


DF2468<-merge(DF24,DF68,by=c("지역구"))
DF2468

DF24681012<-merge(DF2468,DF1012,by=c("지역구"))
DF24681012

#2019 구별 총합 구하기
DF24681012<- DF24681012 %>% mutate(총합=합계1+합계2+합계3+합계4+합계5+합계6+합계7+합계8+합계9+합계10+합계11+합계12)
DF24681012



#20년 1월 자료
sub2001<-read.csv("C:\\Users\\Hanbeen Cho\\Desktop\\카드이용 2020\\CARD_SUBWAY_MONTH_202001.csv")
sub2001


#하루 총 이용객수(총계) 변수 추가하기
sub2001<- sub2001 %>% mutate(총계=승차총승객수+하차총승객수)
head(sub2001)

#사용일자, 노선명, 등록일자 삭제
sub2001<- sub2001 %>% select(역명, 승차총승객수, 하차총승객수,총계)
head(sub2001)

#강서구
gangseo<-sub2001 %>% filter(역명 %in% c('방화', '개화산', '김포공항', '송정', '마곡', '발산', '우장산', '화곡', '까치산', '염창', '등촌', '증미', '가양', '양천향교', '마곡나루', '신방화', '공항시장', '개화'))
head(gangseo)                             
gangseo<-gangseo %>% select(총계)
gangseo
totgangseo<-sum(gangseo)
totgangseo

#양천구
yang<-sub2001 %>% filter(역명 %in% c('신목동', '목동', '오목교', '신정네거리', '양천구청', '신정(은행정)'))
head(yang)                             
yang<-yang %>% select(총계)
yang
totyang<-sum(yang)
totyang

#금천구
keum<-sub2001 %>% filter(역명 %in% c('가산디지털단지', '독산', '금천구청'))
head(keum)    
keum<-keum %>% select(총계)
keum
totkeum<-sum(keum)
totkeum

#관악구
kwan<-sub2001 %>% filter(역명 %in% c('신림', '봉천', '서울대입구', '낙성대'))
head(kwan)  
kwan<-kwan %>% select(총계)
kwan
totkwan<-sum(kwan)
totkwan


#은평구
eun<-sub2001 %>% filter(역명 %in% c('독바위', '구파발', '연신내', '불광', '녹번', '역촌', '구산', '응암', '새절(신사)','증산(명지대앞)', '수색', '디지털미디어시티'))
head(eun)
eun<-eun %>% select(총계)
eun
toteun<-sum(eun)
toteun

#구로구
guro<-sub2001 %>% filter(역명 %in% c('온수(성공회대입구)', '천왕', '오류동', '개봉', '구일', '구로', '남구로', '대림(구로구청)', '구로디지털단지','신도림', '도림천'))
head(guro)  
guro<-guro %>% select(총계)
guro
totguro<-sum(guro)
totguro

#구로구
dobong<-sub2001 %>% filter(역명 %in% c('도봉산', '도봉', '방학', '창동', '녹천', '쌍문'))
head(dobong)  
dobong<-dobong %>% select(총계)
dobong
totdobong<-sum(dobong)
totdobong

#중랑구
jlang<-sub2001 %>% filter(역명 %in% c('먹골', '중화', '상봉(시외버스터미널)', '중량', '망우', '양원', '신내', '봉화산(서울의료원)', '면목', '사가정', '용마산'))
head(jlang)  
jlang<-jlang %>% select(총계)
jlang
totjlang<-sum(jlang)
totjlang


#강동구
gangdong<-sub2001 %>% filter(역명 %in% c('강동구청', '천호(풍납토성)', '암사', '강동', '길동', '굽은다리(강동구민회관앞)', '명일', '고덕', '상일동', '강일', '둔촌동', '둔촌오류','중앙보훈병원'))
head(gangdong) 
gangdong<-gangdong %>% select(총계)
gangdong
totgangdong<-sum(gangdong)
totgangdong


#용산구
yong<-sub2001 %>% filter(역명 %in% c('서울역', '숙대입구(갈월)', '녹사평(용산구청)', '이태원', '한강진', '한남', '서빙고', '이촌(국립중앙박물관)', '용산', '남영', '효창공원앞', '삼각지','신용산'))
head(yong) 
yong<-yong %>% select(총계)
yong
totyong<-sum(yong)
totyong


#광진구
kwang<-sub2001 %>% filter(역명 %in% c('중곡', '군자(능동)', '어린이대공원', '아차산(어린이대공원후문)', '광나루(장신대)', '건대입구', '구의(광진구청)', '강변(동서울터미널)', '뚝섬유원지'))
head(kwang) 
kwang<-kwang%>% select(총계)
kwang
totkwang<-sum(kwang)
totkwang

#동대문구
moon<-sub2001 %>% filter(역명 %in% c('신설동', '용두(동대문구청)', '제기동', '청량리(서울시립대입구)', '회기', '외대앞', '신이문', '왕십리(성동구청)'))
head(moon) 
moon<-moon%>% select(총계)
moon
totmoon<-sum(moon)
totmoon

#노원구
noone<-sub2001 %>% filter(역명 %in% c('석계', '광운대', '월계', '태릉입구', '화랑대(서울여대입구)', '공릉(서울과학기술대)', '하계', '중계', '노원', '상계','당고개', '마들', '수락산'))
head(noone) 
noone<-noone%>% select(총계)
noone
totnoone<-sum(noone)
totnoone


#강북구
kbook<-sub2001 %>% filter(역명 %in% c('솔샘', '삼양사거리', '삼양', '회계', '가오리', '4.19민주묘지', '솔밭공원', '북한산우이', '수유(강북구청)', '미아','미아사거리'))
head(kbook) 
kbook<-noone%>% select(총계)
kbook
totkbook<-sum(kbook)
totkbook


#서대문구
seo<-sub2001 %>% filter(역명 %in% c('홍제', '무악재', '서대문', '충정로(경기대입구)', '신촌(경의중앙선)', '신촌', '가좌'))
head(seo)
seo<-seo%>% select(총계)
seo
totseo<-sum(seo)
totseo


#성북구
seong<-sub2001 %>% filter(역명 %in% c('북한산보국문', '정릉', '성신여대입구', '길음', '한성대입구', '보문', '안암(고대병원앞)', '고려대(종암)','월곡(동덕여대)','상월곡(한국과학기술연구원)', '돌곶이'))
head(seong)
seong<-seong%>% select(총계)
seong
totseong<-sum(seong)
totseong

#종로구
jong<-sub2001 %>% filter(역명 %in% c('독립문', '경복궁(정부서울청사)', '안국', '종로3가', '광화문', '종각', '종로5가', '동대문','동묘앞','혜화', '창신'))
head(jong)
jong<-jong%>% select(총계)
jong
totjong<-sum(jong)
totjong


#중구
jung<-sub2001 %>% filter(역명 %in% c('시청', '을지로입구', '을지로3가', '을지로4가', '동대문역사문화공원', '신당', '청구', '약수','버티고개','동대입구', '충무로', '명동', '회현(남대문시장)'))
head(jung)
jung<-jung%>% select(총계)
jung
totjung<-sum(jung)
totjung


#마포구
mapo<-sub2001 %>% filter(역명 %in% c('월드컵경기장', '마포구청', '홍대입구', '망원', '합정', '상수', '광흥창(서강)', '대흥(서강대앞)','마포','공덕', '애오개', '이대', '아현'))
head(mapo)
mapo<-mapo%>% select(총계)
mapo
totmapo<-sum(mapo)
totmapo


#영등포구
yung<-sub2001 %>% filter(역명 %in% c('국회의사당', '여의나루', '샛강', '여의도', '대방', '신길', '영등포', '신풍','영등포시장','문래', '영등포구청', '당산', '양평', '선유도'))
head(yung)
yung<-yung%>% select(총계)
yung
totyung<-sum(yung)
totyung


#송파구
song<-sub2001 %>% filter(역명 %in% c('잠실나루', '몽촌토성(평화의문)', '잠실(송파구청)', '잠실새내', '종합운동장', '삼전', '석촌고분', '석촌','송파','가락시장', '문정', '장지', '복정', '경찰병원','오금','방이','개롱','거여','마천','올림픽공원','한성백제','송파나루'))
head(song)
song<-song%>% select(총계)
song
totsong<-sum(song)
totsong


#강남구
gnam<-sub2001 %>% filter(역명 %in% c('압구정로데오', '청담', '강남구청', '학동', '논현', '압구정', '신사', '잠원','신논현','언주', '선정릉', '삼성중앙','봉은사', '삼성(무역센터)', '선릉', '역삼', '강남', '한티', '매봉', '도곡', '대치', '학여울', '대청', '일원', '수서', '대모산입구', '개포동', '구룡')) 
head(gnam)
gnam<-gnam%>% select(총계)
gnam
totgnam<-sum(gnam)
totgnam


#서초구
scho<-sub2001 %>% filter(역명 %in% c('신반포', '구반포', '반포', '고속터미널', '사평', '내방', '총신대입구','방배', '서초', '교대(법원.검찰청)', '남부터미널', '양재(서초구청)', '양재시민의숲', '청계산입구', '남태령')) 
head(scho)
scho<-scho%>% select(총계)
scho
totscho<-sum(scho)
totscho


#성동구
sdong<-sub2001 %>% filter(역명 %in% c('상왕십리', '왕십리', '마장', '신답', '용답', '뚝섬', '한양대', '상수', '서울숲', '응봉', '옥수', '행당', '신금호'))
head(sdong)
sdong<-sdong%>% select(총계)
sdong
totsdong<-sum(sdong)
totsdong


#동작구
djak<-sub2001 %>% filter(역명 %in% c('노량진', '노들', '흑석(중앙대입구)', '동작(현충원)', '보라매', '신대방삼거리', '장승배기', '상도','숭실대입구', '남성', '신대방', '사당'))
head(djak)
djak<-djak%>% select(총계)
djak
totdjak<-sum(djak)
totdjak


#데이터프레임 생성 후 막대그래프 그리기
지역구<-c("동작구","도봉구","은평구", "강동구", "강서구","강남구","구로구","중랑구","종로구","중구","강북구","금천구","관악구","광진구","마포구","동대문구","노원구","서초구","성동구","서대문구","성북구","송파구","양천구","용산구","영등포구")
합계201<-c(12482482,5565541,10599808,8906885,13809355,38129377,15527784,5895993,16515372,20138448,12086969,4962006,6976999,11345900,16757099,9777320,12086969,14819740,5586363,6103909,4938216,18101169,2983588,14496081,15889571)
DF2001<-data.frame(지역구,합계201)
DF2001


#20년 2월 자료
sub2002<-read.csv("C:\\Users\\Hanbeen Cho\\Desktop\\카드이용 2020\\CARD_SUBWAY_MONTH_202002.csv")
sub2002


#하루 총 이용객수(총계) 변수 추가하기
sub2002<- sub2002 %>% mutate(총계=승차총승객수+하차총승객수)
head(sub2002)

#사용일자, 노선명, 등록일자 삭제
sub2002<- sub2002 %>% select(역명, 승차총승객수, 하차총승객수,총계)
head(sub2002)

#강서구
gangseo<-sub2002 %>% filter(역명 %in% c('방화', '개화산', '김포공항', '송정', '마곡', '발산', '우장산', '화곡', '까치산', '염창', '등촌', '증미', '가양', '양천향교', '마곡나루', '신방화', '공항시장', '개화'))
head(gangseo)                             
gangseo<-gangseo %>% select(총계)
gangseo
totgangseo<-sum(gangseo)
totgangseo

#양천구
yang<-sub2002 %>% filter(역명 %in% c('신목동', '목동', '오목교', '신정네거리', '양천구청', '신정(은행정)'))
head(yang)                             
yang<-yang %>% select(총계)
yang
totyang<-sum(yang)
totyang

#금천구
keum<-sub2002 %>% filter(역명 %in% c('가산디지털단지', '독산', '금천구청'))
head(keum)    
keum<-keum %>% select(총계)
keum
totkeum<-sum(keum)
totkeum

#관악구
kwan<-sub2002 %>% filter(역명 %in% c('신림', '봉천', '서울대입구', '낙성대'))
head(kwan)  
kwan<-kwan %>% select(총계)
kwan
totkwan<-sum(kwan)
totkwan


#은평구
eun<-sub2002 %>% filter(역명 %in% c('독바위', '구파발', '연신내', '불광', '녹번', '역촌', '구산', '응암', '새절(신사)','증산(명지대앞)', '수색', '디지털미디어시티'))
head(eun)
eun<-eun %>% select(총계)
eun
toteun<-sum(eun)
toteun

#구로구
guro<-sub2002 %>% filter(역명 %in% c('온수(성공회대입구)', '천왕', '오류동', '개봉', '구일', '구로', '남구로', '대림(구로구청)', '구로디지털단지','신도림', '도림천'))
head(guro)  
guro<-guro %>% select(총계)
guro
totguro<-sum(guro)
totguro

#구로구
dobong<-sub2002 %>% filter(역명 %in% c('도봉산', '도봉', '방학', '창동', '녹천', '쌍문'))
head(dobong)  
dobong<-dobong %>% select(총계)
dobong
totdobong<-sum(dobong)
totdobong

#중랑구
jlang<-sub2002 %>% filter(역명 %in% c('먹골', '중화', '상봉(시외버스터미널)', '중량', '망우', '양원', '신내', '봉화산(서울의료원)', '면목', '사가정', '용마산'))
head(jlang)  
jlang<-jlang %>% select(총계)
jlang
totjlang<-sum(jlang)
totjlang


#강동구
gangdong<-sub2002 %>% filter(역명 %in% c('강동구청', '천호(풍납토성)', '암사', '강동', '길동', '굽은다리(강동구민회관앞)', '명일', '고덕', '상일동', '강일', '둔촌동', '둔촌오류','중앙보훈병원'))
head(gangdong) 
gangdong<-gangdong %>% select(총계)
gangdong
totgangdong<-sum(gangdong)
totgangdong


#용산구
yong<-sub2002 %>% filter(역명 %in% c('서울역', '숙대입구(갈월)', '녹사평(용산구청)', '이태원', '한강진', '한남', '서빙고', '이촌(국립중앙박물관)', '용산', '남영', '효창공원앞', '삼각지','신용산'))
head(yong) 
yong<-yong %>% select(총계)
yong
totyong<-sum(yong)
totyong


#광진구
kwang<-sub2002 %>% filter(역명 %in% c('중곡', '군자(능동)', '어린이대공원', '아차산(어린이대공원후문)', '광나루(장신대)', '건대입구', '구의(광진구청)', '강변(동서울터미널)', '뚝섬유원지'))
head(kwang) 
kwang<-kwang%>% select(총계)
kwang
totkwang<-sum(kwang)
totkwang

#동대문구
moon<-sub2002 %>% filter(역명 %in% c('신설동', '용두(동대문구청)', '제기동', '청량리(서울시립대입구)', '회기', '외대앞', '신이문', '왕십리(성동구청)'))
head(moon) 
moon<-moon%>% select(총계)
moon
totmoon<-sum(moon)
totmoon

#노원구
noone<-sub2002 %>% filter(역명 %in% c('석계', '광운대', '월계', '태릉입구', '화랑대(서울여대입구)', '공릉(서울과학기술대)', '하계', '중계', '노원', '상계','당고개', '마들', '수락산'))
head(noone) 
noone<-noone%>% select(총계)
noone
totnoone<-sum(noone)
totnoone


#강북구
kbook<-sub2002 %>% filter(역명 %in% c('솔샘', '삼양사거리', '삼양', '회계', '가오리', '4.19민주묘지', '솔밭공원', '북한산우이', '수유(강북구청)', '미아','미아사거리'))
head(kbook) 
kbook<-noone%>% select(총계)
kbook
totkbook<-sum(kbook)
totkbook


#서대문구
seo<-sub2002 %>% filter(역명 %in% c('홍제', '무악재', '서대문', '충정로(경기대입구)', '신촌(경의중앙선)', '신촌', '가좌'))
head(seo)
seo<-seo%>% select(총계)
seo
totseo<-sum(seo)
totseo


#성북구
seong<-sub2002 %>% filter(역명 %in% c('북한산보국문', '정릉', '성신여대입구', '길음', '한성대입구', '보문', '안암(고대병원앞)', '고려대(종암)','월곡(동덕여대)','상월곡(한국과학기술연구원)', '돌곶이'))
head(seong)
seong<-seong%>% select(총계)
seong
totseong<-sum(seong)
totseong

#종로구
jong<-sub2002 %>% filter(역명 %in% c('독립문', '경복궁(정부서울청사)', '안국', '종로3가', '광화문', '종각', '종로5가', '동대문','동묘앞','혜화', '창신'))
head(jong)
jong<-jong%>% select(총계)
jong
totjong<-sum(jong)
totjong


#중구
jung<-sub2002 %>% filter(역명 %in% c('시청', '을지로입구', '을지로3가', '을지로4가', '동대문역사문화공원', '신당', '청구', '약수','버티고개','동대입구', '충무로', '명동', '회현(남대문시장)'))
head(jung)
jung<-jung%>% select(총계)
jung
totjung<-sum(jung)
totjung


#마포구
mapo<-sub2002 %>% filter(역명 %in% c('월드컵경기장', '마포구청', '홍대입구', '망원', '합정', '상수', '광흥창(서강)', '대흥(서강대앞)','마포','공덕', '애오개', '이대', '아현'))
head(mapo)
mapo<-mapo%>% select(총계)
mapo
totmapo<-sum(mapo)
totmapo


#영등포구
yung<-sub2002 %>% filter(역명 %in% c('국회의사당', '여의나루', '샛강', '여의도', '대방', '신길', '영등포', '신풍','영등포시장','문래', '영등포구청', '당산', '양평', '선유도'))
head(yung)
yung<-yung%>% select(총계)
yung
totyung<-sum(yung)
totyung


#송파구
song<-sub2002 %>% filter(역명 %in% c('잠실나루', '몽촌토성(평화의문)', '잠실(송파구청)', '잠실새내', '종합운동장', '삼전', '석촌고분', '석촌','송파','가락시장', '문정', '장지', '복정', '경찰병원','오금','방이','개롱','거여','마천','올림픽공원','한성백제','송파나루'))
head(song)
song<-song%>% select(총계)
song
totsong<-sum(song)
totsong


#강남구
gnam<-sub2002 %>% filter(역명 %in% c('압구정로데오', '청담', '강남구청', '학동', '논현', '압구정', '신사', '잠원','신논현','언주', '선정릉', '삼성중앙','봉은사', '삼성(무역센터)', '선릉', '역삼', '강남', '한티', '매봉', '도곡', '대치', '학여울', '대청', '일원', '수서', '대모산입구', '개포동', '구룡')) 
head(gnam)
gnam<-gnam%>% select(총계)
gnam
totgnam<-sum(gnam)
totgnam


#서초구
scho<-sub2002 %>% filter(역명 %in% c('신반포', '구반포', '반포', '고속터미널', '사평', '내방', '총신대입구','방배', '서초', '교대(법원.검찰청)', '남부터미널', '양재(서초구청)', '양재시민의숲', '청계산입구', '남태령')) 
head(scho)
scho<-scho%>% select(총계)
scho
totscho<-sum(scho)
totscho


#성동구
sdong<-sub2002 %>% filter(역명 %in% c('상왕십리', '왕십리', '마장', '신답', '용답', '뚝섬', '한양대', '상수', '서울숲', '응봉', '옥수', '행당', '신금호'))
head(sdong)
sdong<-sdong%>% select(총계)
sdong
totsdong<-sum(sdong)
totsdong


#동작구
djak<-sub2002 %>% filter(역명 %in% c('노량진', '노들', '흑석(중앙대입구)', '동작(현충원)', '보라매', '신대방삼거리', '장승배기', '상도','숭실대입구', '남성', '신대방', '사당'))
head(djak)
djak<-djak%>% select(총계)
djak
totdjak<-sum(djak)
totdjak


#데이터프레임 생성 후 막대그래프 그리기
지역구<-c("동작구","도봉구","은평구", "강동구", "강서구","강남구","구로구","중랑구","종로구","중구","강북구","금천구","관악구","광진구","마포구","동대문구","노원구","서초구","성동구","서대문구","성북구","송파구","양천구","용산구","영등포구")
합계202<-c(10279866,4703682,8982501,7507414,11610922,32359590,12721192,5074736,12513207,15908659,10146417,4374566,6059024,9179725,13694366,7680824,10146417,11573608,4738443,5049061,4100640,14524342,2536767,10972311,13407708)
DF2002<-data.frame(지역구,합계202)
DF2002


#19년 3월 자료
sub2003<-read.csv("C:\\Users\\Hanbeen Cho\\Desktop\\카드이용 2020\\CARD_SUBWAY_MONTH_202003.csv")
sub2003


#하루 총 이용객수(총계) 변수 추가하기
sub2003<- sub2003 %>% mutate(총계=승차총승객수+하차총승객수)
head(sub2003)

#사용일자, 노선명, 등록일자 삭제
sub2003<- sub2003 %>% select(역명, 승차총승객수, 하차총승객수,총계)
head(sub2003)

#강서구
gangseo<-sub2003 %>% filter(역명 %in% c('방화', '개화산', '김포공항', '송정', '마곡', '발산', '우장산', '화곡', '까치산', '염창', '등촌', '증미', '가양', '양천향교', '마곡나루', '신방화', '공항시장', '개화'))
head(gangseo)                             
gangseo<-gangseo %>% select(총계)
gangseo
totgangseo<-sum(gangseo)
totgangseo

#양천구
yang<-sub2003 %>% filter(역명 %in% c('신목동', '목동', '오목교', '신정네거리', '양천구청', '신정(은행정)'))
head(yang)                             
yang<-yang %>% select(총계)
yang
totyang<-sum(yang)
totyang

#금천구
keum<-sub2003 %>% filter(역명 %in% c('가산디지털단지', '독산', '금천구청'))
head(keum)    
keum<-keum %>% select(총계)
keum
totkeum<-sum(keum)
totkeum

#관악구
kwan<-sub2003 %>% filter(역명 %in% c('신림', '봉천', '서울대입구', '낙성대'))
head(kwan)  
kwan<-kwan %>% select(총계)
kwan
totkwan<-sum(kwan)
totkwan


#은평구
eun<-sub2003 %>% filter(역명 %in% c('독바위', '구파발', '연신내', '불광', '녹번', '역촌', '구산', '응암', '새절(신사)','증산(명지대앞)', '수색', '디지털미디어시티'))
head(eun)
eun<-eun %>% select(총계)
eun
toteun<-sum(eun)
toteun

#구로구
guro<-sub2003 %>% filter(역명 %in% c('온수(성공회대입구)', '천왕', '오류동', '개봉', '구일', '구로', '남구로', '대림(구로구청)', '구로디지털단지','신도림', '도림천'))
head(guro)  
guro<-guro %>% select(총계)
guro
totguro<-sum(guro)
totguro

#구로구
dobong<-sub2003 %>% filter(역명 %in% c('도봉산', '도봉', '방학', '창동', '녹천', '쌍문'))
head(dobong)  
dobong<-dobong %>% select(총계)
dobong
totdobong<-sum(dobong)
totdobong

#중랑구
jlang<-sub2003 %>% filter(역명 %in% c('먹골', '중화', '상봉(시외버스터미널)', '중량', '망우', '양원', '신내', '봉화산(서울의료원)', '면목', '사가정', '용마산'))
head(jlang)  
jlang<-jlang %>% select(총계)
jlang
totjlang<-sum(jlang)
totjlang


#강동구
gangdong<-sub2003 %>% filter(역명 %in% c('강동구청', '천호(풍납토성)', '암사', '강동', '길동', '굽은다리(강동구민회관앞)', '명일', '고덕', '상일동', '강일', '둔촌동', '둔촌오류','중앙보훈병원'))
head(gangdong) 
gangdong<-gangdong %>% select(총계)
gangdong
totgangdong<-sum(gangdong)
totgangdong


#용산구
yong<-sub2003 %>% filter(역명 %in% c('서울역', '숙대입구(갈월)', '녹사평(용산구청)', '이태원', '한강진', '한남', '서빙고', '이촌(국립중앙박물관)', '용산', '남영', '효창공원앞', '삼각지','신용산'))
head(yong) 
yong<-yong %>% select(총계)
yong
totyong<-sum(yong)
totyong


#광진구
kwang<-sub2003 %>% filter(역명 %in% c('중곡', '군자(능동)', '어린이대공원', '아차산(어린이대공원후문)', '광나루(장신대)', '건대입구', '구의(광진구청)', '강변(동서울터미널)', '뚝섬유원지'))
head(kwang) 
kwang<-kwang%>% select(총계)
kwang
totkwang<-sum(kwang)
totkwang

#동대문구
moon<-sub2003 %>% filter(역명 %in% c('신설동', '용두(동대문구청)', '제기동', '청량리(서울시립대입구)', '회기', '외대앞', '신이문', '왕십리(성동구청)'))
head(moon) 
moon<-moon%>% select(총계)
moon
totmoon<-sum(moon)
totmoon

#노원구
noone<-sub2003 %>% filter(역명 %in% c('석계', '광운대', '월계', '태릉입구', '화랑대(서울여대입구)', '공릉(서울과학기술대)', '하계', '중계', '노원', '상계','당고개', '마들', '수락산'))
head(noone) 
noone<-noone%>% select(총계)
noone
totnoone<-sum(noone)
totnoone


#강북구
kbook<-sub2003 %>% filter(역명 %in% c('솔샘', '삼양사거리', '삼양', '회계', '가오리', '4.19민주묘지', '솔밭공원', '북한산우이', '수유(강북구청)', '미아','미아사거리'))
head(kbook) 
kbook<-noone%>% select(총계)
kbook
totkbook<-sum(kbook)
totkbook


#서대문구
seo<-sub2003 %>% filter(역명 %in% c('홍제', '무악재', '서대문', '충정로(경기대입구)', '신촌(경의중앙선)', '신촌', '가좌'))
head(seo)
seo<-seo%>% select(총계)
seo
totseo<-sum(seo)
totseo


#성북구
seong<-sub2003 %>% filter(역명 %in% c('북한산보국문', '정릉', '성신여대입구', '길음', '한성대입구', '보문', '안암(고대병원앞)', '고려대(종암)','월곡(동덕여대)','상월곡(한국과학기술연구원)', '돌곶이'))
head(seong)
seong<-seong%>% select(총계)
seong
totseong<-sum(seong)
totseong

#종로구
jong<-sub2003 %>% filter(역명 %in% c('독립문', '경복궁(정부서울청사)', '안국', '종로3가', '광화문', '종각', '종로5가', '동대문','동묘앞','혜화', '창신'))
head(jong)
jong<-jong%>% select(총계)
jong
totjong<-sum(jong)
totjong


#중구
jung<-sub2003 %>% filter(역명 %in% c('시청', '을지로입구', '을지로3가', '을지로4가', '동대문역사문화공원', '신당', '청구', '약수','버티고개','동대입구', '충무로', '명동', '회현(남대문시장)'))
head(jung)
jung<-jung%>% select(총계)
jung
totjung<-sum(jung)
totjung


#마포구
mapo<-sub2003 %>% filter(역명 %in% c('월드컵경기장', '마포구청', '홍대입구', '망원', '합정', '상수', '광흥창(서강)', '대흥(서강대앞)','마포','공덕', '애오개', '이대', '아현'))
head(mapo)
mapo<-mapo%>% select(총계)
mapo
totmapo<-sum(mapo)
totmapo


#영등포구
yung<-sub2003 %>% filter(역명 %in% c('국회의사당', '여의나루', '샛강', '여의도', '대방', '신길', '영등포', '신풍','영등포시장','문래', '영등포구청', '당산', '양평', '선유도'))
head(yung)
yung<-yung%>% select(총계)
yung
totyung<-sum(yung)
totyung


#송파구
song<-sub2003 %>% filter(역명 %in% c('잠실나루', '몽촌토성(평화의문)', '잠실(송파구청)', '잠실새내', '종합운동장', '삼전', '석촌고분', '석촌','송파','가락시장', '문정', '장지', '복정', '경찰병원','오금','방이','개롱','거여','마천','올림픽공원','한성백제','송파나루'))
head(song)
song<-song%>% select(총계)
song
totsong<-sum(song)
totsong


#강남구
gnam<-sub2003 %>% filter(역명 %in% c('압구정로데오', '청담', '강남구청', '학동', '논현', '압구정', '신사', '잠원','신논현','언주', '선정릉', '삼성중앙','봉은사', '삼성(무역센터)', '선릉', '역삼', '강남', '한티', '매봉', '도곡', '대치', '학여울', '대청', '일원', '수서', '대모산입구', '개포동', '구룡')) 
head(gnam)
gnam<-gnam%>% select(총계)
gnam
totgnam<-sum(gnam)
totgnam


#서초구
scho<-sub2003 %>% filter(역명 %in% c('신반포', '구반포', '반포', '고속터미널', '사평', '내방', '총신대입구','방배', '서초', '교대(법원.검찰청)', '남부터미널', '양재(서초구청)', '양재시민의숲', '청계산입구', '남태령')) 
head(scho)
scho<-scho%>% select(총계)
scho
totscho<-sum(scho)
totscho


#성동구
sdong<-sub2003 %>% filter(역명 %in% c('상왕십리', '왕십리', '마장', '신답', '용답', '뚝섬', '한양대', '상수', '서울숲', '응봉', '옥수', '행당', '신금호'))
head(sdong)
sdong<-sdong%>% select(총계)
sdong
totsdong<-sum(sdong)
totsdong


#동작구
djak<-sub2003 %>% filter(역명 %in% c('노량진', '노들', '흑석(중앙대입구)', '동작(현충원)', '보라매', '신대방삼거리', '장승배기', '상도','숭실대입구', '남성', '신대방', '사당'))
head(djak)
djak<-djak%>% select(총계)
djak
totdjak<-sum(djak)
totdjak


#데이터프레임 생성 후 막대그래프 그리기
지역구<-c("동작구","도봉구","은평구", "강동구", "강서구","강남구","구로구","중랑구","종로구","중구","강북구","금천구","관악구","광진구","마포구","동대문구","노원구","서초구","성동구","서대문구","성북구","송파구","양천구","용산구","영등포구")
합계203<-c(8546835,4179174,7660960,6383511,9309032,26020059,10548908,4297989,9794503,11430217,8656082,3864747,4359939,7849090,10608085,6336207,8656082,9039393,4087230,4039569,3529957,12060817,2132697,8243268,11402470)
DF2003<-data.frame(지역구,합계203)
DF2003

################4월######################3


#19년 4월 자료
sub2004<-read.csv("C:\\Users\\Hanbeen Cho\\Desktop\\카드이용 2020\\CARD_SUBWAY_MONTH_202004.csv")
sub2004


#하루 총 이용객수(총계) 변수 추가하기
sub2004<- sub2004 %>% mutate(총계=승차총승객수+하차총승객수)
head(sub2004)

#사용일자, 노선명, 등록일자 삭제
sub2004<- sub2004 %>% select(역명, 승차총승객수, 하차총승객수,총계)
head(sub2004)

#강서구
gangseo<-sub2004 %>% filter(역명 %in% c('방화', '개화산', '김포공항', '송정', '마곡', '발산', '우장산', '화곡', '까치산', '염창', '등촌', '증미', '가양', '양천향교', '마곡나루', '신방화', '공항시장', '개화'))
head(gangseo)                             
gangseo<-gangseo %>% select(총계)
gangseo
totgangseo<-sum(gangseo)
totgangseo

#양천구
yang<-sub2004 %>% filter(역명 %in% c('신목동', '목동', '오목교', '신정네거리', '양천구청', '신정(은행정)'))
head(yang)                             
yang<-yang %>% select(총계)
yang
totyang<-sum(yang)
totyang

#금천구
keum<-sub2004 %>% filter(역명 %in% c('가산디지털단지', '독산', '금천구청'))
head(keum)    
keum<-keum %>% select(총계)
keum
totkeum<-sum(keum)
totkeum

#관악구
kwan<-sub2004 %>% filter(역명 %in% c('신림', '봉천', '서울대입구', '낙성대'))
head(kwan)  
kwan<-kwan %>% select(총계)
kwan
totkwan<-sum(kwan)
totkwan


#은평구
eun<-sub2004 %>% filter(역명 %in% c('독바위', '구파발', '연신내', '불광', '녹번', '역촌', '구산', '응암', '새절(신사)','증산(명지대앞)', '수색', '디지털미디어시티'))
head(eun)
eun<-eun %>% select(총계)
eun
toteun<-sum(eun)
toteun

#구로구
guro<-sub2004 %>% filter(역명 %in% c('온수(성공회대입구)', '천왕', '오류동', '개봉', '구일', '구로', '남구로', '대림(구로구청)', '구로디지털단지','신도림', '도림천'))
head(guro)  
guro<-guro %>% select(총계)
guro
totguro<-sum(guro)
totguro

#구로구
dobong<-sub2004 %>% filter(역명 %in% c('도봉산', '도봉', '방학', '창동', '녹천', '쌍문'))
head(dobong)  
dobong<-dobong %>% select(총계)
dobong
totdobong<-sum(dobong)
totdobong

#중랑구
jlang<-sub2004 %>% filter(역명 %in% c('먹골', '중화', '상봉(시외버스터미널)', '중량', '망우', '양원', '신내', '봉화산(서울의료원)', '면목', '사가정', '용마산'))
head(jlang)  
jlang<-jlang %>% select(총계)
jlang
totjlang<-sum(jlang)
totjlang


#강동구
gangdong<-sub2004 %>% filter(역명 %in% c('강동구청', '천호(풍납토성)', '암사', '강동', '길동', '굽은다리(강동구민회관앞)', '명일', '고덕', '상일동', '강일', '둔촌동', '둔촌오류','중앙보훈병원'))
head(gangdong) 
gangdong<-gangdong %>% select(총계)
gangdong
totgangdong<-sum(gangdong)
totgangdong


#용산구
yong<-sub2004 %>% filter(역명 %in% c('서울역', '숙대입구(갈월)', '녹사평(용산구청)', '이태원', '한강진', '한남', '서빙고', '이촌(국립중앙박물관)', '용산', '남영', '효창공원앞', '삼각지','신용산'))
head(yong) 
yong<-yong %>% select(총계)
yong
totyong<-sum(yong)
totyong


#광진구
kwang<-sub2004 %>% filter(역명 %in% c('중곡', '군자(능동)', '어린이대공원', '아차산(어린이대공원후문)', '광나루(장신대)', '건대입구', '구의(광진구청)', '강변(동서울터미널)', '뚝섬유원지'))
head(kwang) 
kwang<-kwang%>% select(총계)
kwang
totkwang<-sum(kwang)
totkwang

#동대문구
moon<-sub2004 %>% filter(역명 %in% c('신설동', '용두(동대문구청)', '제기동', '청량리(서울시립대입구)', '회기', '외대앞', '신이문', '왕십리(성동구청)'))
head(moon) 
moon<-moon%>% select(총계)
moon
totmoon<-sum(moon)
totmoon

#노원구
noone<-sub2004 %>% filter(역명 %in% c('석계', '광운대', '월계', '태릉입구', '화랑대(서울여대입구)', '공릉(서울과학기술대)', '하계', '중계', '노원', '상계','당고개', '마들', '수락산'))
head(noone) 
noone<-noone%>% select(총계)
noone
totnoone<-sum(noone)
totnoone


#강북구
kbook<-sub2004 %>% filter(역명 %in% c('솔샘', '삼양사거리', '삼양', '회계', '가오리', '4.19민주묘지', '솔밭공원', '북한산우이', '수유(강북구청)', '미아','미아사거리'))
head(kbook) 
kbook<-noone%>% select(총계)
kbook
totkbook<-sum(kbook)
totkbook


#서대문구
seo<-sub2004 %>% filter(역명 %in% c('홍제', '무악재', '서대문', '충정로(경기대입구)', '신촌(경의중앙선)', '신촌', '가좌'))
head(seo)
seo<-seo%>% select(총계)
seo
totseo<-sum(seo)
totseo


#성북구
seong<-sub2004 %>% filter(역명 %in% c('북한산보국문', '정릉', '성신여대입구', '길음', '한성대입구', '보문', '안암(고대병원앞)', '고려대(종암)','월곡(동덕여대)','상월곡(한국과학기술연구원)', '돌곶이'))
head(seong)
seong<-seong%>% select(총계)
seong
totseong<-sum(seong)
totseong

#종로구
jong<-sub2004 %>% filter(역명 %in% c('독립문', '경복궁(정부서울청사)', '안국', '종로3가', '광화문', '종각', '종로5가', '동대문','동묘앞','혜화', '창신'))
head(jong)
jong<-jong%>% select(총계)
jong
totjong<-sum(jong)
totjong


#중구
jung<-sub2004 %>% filter(역명 %in% c('시청', '을지로입구', '을지로3가', '을지로4가', '동대문역사문화공원', '신당', '청구', '약수','버티고개','동대입구', '충무로', '명동', '회현(남대문시장)'))
head(jung)
jung<-jung%>% select(총계)
jung
totjung<-sum(jung)
totjung


#마포구
mapo<-sub2004 %>% filter(역명 %in% c('월드컵경기장', '마포구청', '홍대입구', '망원', '합정', '상수', '광흥창(서강)', '대흥(서강대앞)','마포','공덕', '애오개', '이대', '아현'))
head(mapo)
mapo<-mapo%>% select(총계)
mapo
totmapo<-sum(mapo)
totmapo


#영등포구
yung<-sub2004 %>% filter(역명 %in% c('국회의사당', '여의나루', '샛강', '여의도', '대방', '신길', '영등포', '신풍','영등포시장','문래', '영등포구청', '당산', '양평', '선유도'))
head(yung)
yung<-yung%>% select(총계)
yung
totyung<-sum(yung)
totyung


#송파구
song<-sub2004 %>% filter(역명 %in% c('잠실나루', '몽촌토성(평화의문)', '잠실(송파구청)', '잠실새내', '종합운동장', '삼전', '석촌고분', '석촌','송파','가락시장', '문정', '장지', '복정', '경찰병원','오금','방이','개롱','거여','마천','올림픽공원','한성백제','송파나루'))
head(song)
song<-song%>% select(총계)
song
totsong<-sum(song)
totsong


#강남구
gnam<-sub2004 %>% filter(역명 %in% c('압구정로데오', '청담', '강남구청', '학동', '논현', '압구정', '신사', '잠원','신논현','언주', '선정릉', '삼성중앙','봉은사', '삼성(무역센터)', '선릉', '역삼', '강남', '한티', '매봉', '도곡', '대치', '학여울', '대청', '일원', '수서', '대모산입구', '개포동', '구룡')) 
head(gnam)
gnam<-gnam%>% select(총계)
gnam
totgnam<-sum(gnam)
totgnam


#서초구
scho<-sub2004 %>% filter(역명 %in% c('신반포', '구반포', '반포', '고속터미널', '사평', '내방', '총신대입구','방배', '서초', '교대(법원.검찰청)', '남부터미널', '양재(서초구청)', '양재시민의숲', '청계산입구', '남태령')) 
head(scho)
scho<-scho%>% select(총계)
scho
totscho<-sum(scho)
totscho


#성동구
sdong<-sub2004 %>% filter(역명 %in% c('상왕십리', '왕십리', '마장', '신답', '용답', '뚝섬', '한양대', '상수', '서울숲', '응봉', '옥수', '행당', '신금호'))
head(sdong)
sdong<-sdong%>% select(총계)
sdong
totsdong<-sum(sdong)
totsdong


#동작구
djak<-sub2004 %>% filter(역명 %in% c('노량진', '노들', '흑석(중앙대입구)', '동작(현충원)', '보라매', '신대방삼거리', '장승배기', '상도','숭실대입구', '남성', '신대방', '사당'))
head(djak)
djak<-djak%>% select(총계)
djak
totdjak<-sum(djak)
totdjak


#데이터프레임 생성 후 막대그래프 그리기
지역구<-c("동작구","도봉구","은평구", "강동구", "강서구","강남구","구로구","중랑구","종로구","중구","강북구","금천구","관악구","광진구","마포구","동대문구","노원구","서초구","성동구","서대문구","성북구","송파구","양천구","용산구","영등포구")
합계204<-c(9154590,4401815,813558,6840022,9582780,27435398,11338879,4418658,10753690,11370289,9156202,4054241,4163030,8333314,11297583,6945594,9156202,9840723,4352900,4265532,3686057,12710445,2262587,8857414,12060911)
DF2004<-data.frame(지역구,합계204)
DF2004



################5월######################3

#install.packages("dplyr")
#library(dplyr)

#19년 5월 자료
sub2005<-read.csv("C:\\Users\\Hanbeen Cho\\Desktop\\카드이용 2020\\CARD_SUBWAY_MONTH_202005.csv")
sub2005


#하루 총 이용객수(총계) 변수 추가하기
sub2005<- sub2005 %>% mutate(총계=승차총승객수+하차총승객수)
head(sub2005)

#사용일자, 노선명, 등록일자 삭제
sub2005<- sub2005 %>% select(역명, 승차총승객수, 하차총승객수,총계)
head(sub2005)

#강서구
gangseo<-sub2005 %>% filter(역명 %in% c('방화', '개화산', '김포공항', '송정', '마곡', '발산', '우장산', '화곡', '까치산', '염창', '등촌', '증미', '가양', '양천향교', '마곡나루', '신방화', '공항시장', '개화'))
head(gangseo)                             
gangseo<-gangseo %>% select(총계)
gangseo
totgangseo<-sum(gangseo)
totgangseo

#양천구
yang<-sub2005 %>% filter(역명 %in% c('신목동', '목동', '오목교', '신정네거리', '양천구청', '신정(은행정)'))
head(yang)                             
yang<-yang %>% select(총계)
yang
totyang<-sum(yang)
totyang

#금천구
keum<-sub2005 %>% filter(역명 %in% c('가산디지털단지', '독산', '금천구청'))
head(keum)    
keum<-keum %>% select(총계)
keum
totkeum<-sum(keum)
totkeum

#관악구
kwan<-sub2005 %>% filter(역명 %in% c('신림', '봉천', '서울대입구', '낙성대'))
head(kwan)  
kwan<-kwan %>% select(총계)
kwan
totkwan<-sum(kwan)
totkwan


#은평구
eun<-sub2005 %>% filter(역명 %in% c('독바위', '구파발', '연신내', '불광', '녹번', '역촌', '구산', '응암', '새절(신사)','증산(명지대앞)', '수색', '디지털미디어시티'))
head(eun)
eun<-eun %>% select(총계)
eun
toteun<-sum(eun)
toteun

#구로구
guro<-sub2005 %>% filter(역명 %in% c('온수(성공회대입구)', '천왕', '오류동', '개봉', '구일', '구로', '남구로', '대림(구로구청)', '구로디지털단지','신도림', '도림천'))
head(guro)  
guro<-guro %>% select(총계)
guro
totguro<-sum(guro)
totguro

#구로구
dobong<-sub2005 %>% filter(역명 %in% c('도봉산', '도봉', '방학', '창동', '녹천', '쌍문'))
head(dobong)  
dobong<-dobong %>% select(총계)
dobong
totdobong<-sum(dobong)
totdobong

#중랑구
jlang<-sub2005 %>% filter(역명 %in% c('먹골', '중화', '상봉(시외버스터미널)', '중량', '망우', '양원', '신내', '봉화산(서울의료원)', '면목', '사가정', '용마산'))
head(jlang)  
jlang<-jlang %>% select(총계)
jlang
totjlang<-sum(jlang)
totjlang


#강동구
gangdong<-sub2005 %>% filter(역명 %in% c('강동구청', '천호(풍납토성)', '암사', '강동', '길동', '굽은다리(강동구민회관앞)', '명일', '고덕', '상일동', '강일', '둔촌동', '둔촌오류','중앙보훈병원'))
head(gangdong) 
gangdong<-gangdong %>% select(총계)
gangdong
totgangdong<-sum(gangdong)
totgangdong


#용산구
yong<-sub2005 %>% filter(역명 %in% c('서울역', '숙대입구(갈월)', '녹사평(용산구청)', '이태원', '한강진', '한남', '서빙고', '이촌(국립중앙박물관)', '용산', '남영', '효창공원앞', '삼각지','신용산'))
head(yong) 
yong<-yong %>% select(총계)
yong
totyong<-sum(yong)
totyong


#광진구
kwang<-sub2005 %>% filter(역명 %in% c('중곡', '군자(능동)', '어린이대공원', '아차산(어린이대공원후문)', '광나루(장신대)', '건대입구', '구의(광진구청)', '강변(동서울터미널)', '뚝섬유원지'))
head(kwang) 
kwang<-kwang%>% select(총계)
kwang
totkwang<-sum(kwang)
totkwang

#동대문구
moon<-sub2005 %>% filter(역명 %in% c('신설동', '용두(동대문구청)', '제기동', '청량리(서울시립대입구)', '회기', '외대앞', '신이문', '왕십리(성동구청)'))
head(moon) 
moon<-moon%>% select(총계)
moon
totmoon<-sum(moon)
totmoon

#노원구
noone<-sub2005 %>% filter(역명 %in% c('석계', '광운대', '월계', '태릉입구', '화랑대(서울여대입구)', '공릉(서울과학기술대)', '하계', '중계', '노원', '상계','당고개', '마들', '수락산'))
head(noone) 
noone<-noone%>% select(총계)
noone
totnoone<-sum(noone)
totnoone


#강북구
kbook<-sub2005 %>% filter(역명 %in% c('솔샘', '삼양사거리', '삼양', '회계', '가오리', '4.19민주묘지', '솔밭공원', '북한산우이', '수유(강북구청)', '미아','미아사거리'))
head(kbook) 
kbook<-noone%>% select(총계)
kbook
totkbook<-sum(kbook)
totkbook


#서대문구
seo<-sub2005 %>% filter(역명 %in% c('홍제', '무악재', '서대문', '충정로(경기대입구)', '신촌(경의중앙선)', '신촌', '가좌'))
head(seo)
seo<-seo%>% select(총계)
seo
totseo<-sum(seo)
totseo


#성북구
seong<-sub2005 %>% filter(역명 %in% c('북한산보국문', '정릉', '성신여대입구', '길음', '한성대입구', '보문', '안암(고대병원앞)', '고려대(종암)','월곡(동덕여대)','상월곡(한국과학기술연구원)', '돌곶이'))
head(seong)
seong<-seong%>% select(총계)
seong
totseong<-sum(seong)
totseong

#종로구
jong<-sub2005 %>% filter(역명 %in% c('독립문', '경복궁(정부서울청사)', '안국', '종로3가', '광화문', '종각', '종로5가', '동대문','동묘앞','혜화', '창신'))
head(jong)
jong<-jong%>% select(총계)
jong
totjong<-sum(jong)
totjong


#중구
jung<-sub2005 %>% filter(역명 %in% c('시청', '을지로입구', '을지로3가', '을지로4가', '동대문역사문화공원', '신당', '청구', '약수','버티고개','동대입구', '충무로', '명동', '회현(남대문시장)'))
head(jung)
jung<-jung%>% select(총계)
jung
totjung<-sum(jung)
totjung


#마포구
mapo<-sub2005 %>% filter(역명 %in% c('월드컵경기장', '마포구청', '홍대입구', '망원', '합정', '상수', '광흥창(서강)', '대흥(서강대앞)','마포','공덕', '애오개', '이대', '아현'))
head(mapo)
mapo<-mapo%>% select(총계)
mapo
totmapo<-sum(mapo)
totmapo


#영등포구
yung<-sub2005 %>% filter(역명 %in% c('국회의사당', '여의나루', '샛강', '여의도', '대방', '신길', '영등포', '신풍','영등포시장','문래', '영등포구청', '당산', '양평', '선유도'))
head(yung)
yung<-yung%>% select(총계)
yung
totyung<-sum(yung)
totyung


#송파구
song<-sub2005 %>% filter(역명 %in% c('잠실나루', '몽촌토성(평화의문)', '잠실(송파구청)', '잠실새내', '종합운동장', '삼전', '석촌고분', '석촌','송파','가락시장', '문정', '장지', '복정', '경찰병원','오금','방이','개롱','거여','마천','올림픽공원','한성백제','송파나루'))
head(song)
song<-song%>% select(총계)
song
totsong<-sum(song)
totsong


#강남구
gnam<-sub2005 %>% filter(역명 %in% c('압구정로데오', '청담', '강남구청', '학동', '논현', '압구정', '신사', '잠원','신논현','언주', '선정릉', '삼성중앙','봉은사', '삼성(무역센터)', '선릉', '역삼', '강남', '한티', '매봉', '도곡', '대치', '학여울', '대청', '일원', '수서', '대모산입구', '개포동', '구룡')) 
head(gnam)
gnam<-gnam%>% select(총계)
gnam
totgnam<-sum(gnam)
totgnam


#서초구
scho<-sub2005 %>% filter(역명 %in% c('신반포', '구반포', '반포', '고속터미널', '사평', '내방', '총신대입구','방배', '서초', '교대(법원.검찰청)', '남부터미널', '양재(서초구청)', '양재시민의숲', '청계산입구', '남태령')) 
head(scho)
scho<-scho%>% select(총계)
scho
totscho<-sum(scho)
totscho


#성동구
sdong<-sub2005 %>% filter(역명 %in% c('상왕십리', '왕십리', '마장', '신답', '용답', '뚝섬', '한양대', '상수', '서울숲', '응봉', '옥수', '행당', '신금호'))
head(sdong)
sdong<-sdong%>% select(총계)
sdong
totsdong<-sum(sdong)
totsdong


#동작구
djak<-sub2005 %>% filter(역명 %in% c('노량진', '노들', '흑석(중앙대입구)', '동작(현충원)', '보라매', '신대방삼거리', '장승배기', '상도','숭실대입구', '남성', '신대방', '사당'))
head(djak)
djak<-djak%>% select(총계)
djak
totdjak<-sum(djak)
totdjak


#데이터프레임 생성 후 막대그래프 그리기
지역구<-c("동작구","도봉구","은평구", "강동구", "강서구","강남구","구로구","중랑구","종로구","중구","강북구","금천구","관악구","광진구","마포구","동대문구","노원구","서초구","성동구","서대문구","성북구","송파구","양천구","용산구","영등포구")
합계205<-c(10163691,4852640,8908710,7634095,10584871,29942633,12532591,4823823,12140094,12365429,10191125,4286598,4479810,9208741,11963419,7767623,10191125,11396518,4699170,4625780,4108761,14129166,2505025,9844084,13202621)
DF2005<-data.frame(지역구,합계205)
DF2005

################6월######################3

#install.packages("dplyr")
#library(dplyr)

#19년 6월 자료
sub2006<-read.csv("C:\\Users\\Hanbeen Cho\\Desktop\\카드이용 2020\\CARD_SUBWAY_MONTH_202006.csv")
sub2006


#하루 총 이용객수(총계) 변수 추가하기
sub2006<- sub2006 %>% mutate(총계=승차총승객수+하차총승객수)
head(sub2006)

#사용일자, 노선명, 등록일자 삭제
sub2006<- sub2006 %>% select(역명, 승차총승객수, 하차총승객수,총계)
head(sub2006)

#강서구
gangseo<-sub2006 %>% filter(역명 %in% c('방화', '개화산', '김포공항', '송정', '마곡', '발산', '우장산', '화곡', '까치산', '염창', '등촌', '증미', '가양', '양천향교', '마곡나루', '신방화', '공항시장', '개화'))
head(gangseo)                             
gangseo<-gangseo %>% select(총계)
gangseo
totgangseo<-sum(gangseo)
totgangseo

#양천구
yang<-sub2006 %>% filter(역명 %in% c('신목동', '목동', '오목교', '신정네거리', '양천구청', '신정(은행정)'))
head(yang)                             
yang<-yang %>% select(총계)
yang
totyang<-sum(yang)
totyang

#금천구
keum<-sub2006 %>% filter(역명 %in% c('가산디지털단지', '독산', '금천구청'))
head(keum)    
keum<-keum %>% select(총계)
keum
totkeum<-sum(keum)
totkeum

#관악구
kwan<-sub2006 %>% filter(역명 %in% c('신림', '봉천', '서울대입구', '낙성대'))
head(kwan)  
kwan<-kwan %>% select(총계)
kwan
totkwan<-sum(kwan)
totkwan


#은평구
eun<-sub2006 %>% filter(역명 %in% c('독바위', '구파발', '연신내', '불광', '녹번', '역촌', '구산', '응암', '새절(신사)','증산(명지대앞)', '수색', '디지털미디어시티'))
head(eun)
eun<-eun %>% select(총계)
eun
toteun<-sum(eun)
toteun

#구로구
guro<-sub2006 %>% filter(역명 %in% c('온수(성공회대입구)', '천왕', '오류동', '개봉', '구일', '구로', '남구로', '대림(구로구청)', '구로디지털단지','신도림', '도림천'))
head(guro)  
guro<-guro %>% select(총계)
guro

totguro<-sum(guro)
totguro

#구로구
dobong<-sub2006 %>% filter(역명 %in% c('도봉산', '도봉', '방학', '창동', '녹천', '쌍문'))
head(dobong)  
dobong<-dobong %>% select(총계)
dobong
totdobong<-sum(dobong)
totdobong

#중랑구
jlang<-sub2006 %>% filter(역명 %in% c('먹골', '중화', '상봉(시외버스터미널)', '중량', '망우', '양원', '신내', '봉화산(서울의료원)', '면목', '사가정', '용마산'))
head(jlang)  
jlang<-jlang %>% select(총계)
jlang
totjlang<-sum(jlang)
totjlang


#강동구
gangdong<-sub2006 %>% filter(역명 %in% c('강동구청', '천호(풍납토성)', '암사', '강동', '길동', '굽은다리(강동구민회관앞)', '명일', '고덕', '상일동', '강일', '둔촌동', '둔촌오류','중앙보훈병원'))
head(gangdong) 
gangdong<-gangdong %>% select(총계)
gangdong
totgangdong<-sum(gangdong)
totgangdong


#용산구
yong<-sub2006 %>% filter(역명 %in% c('서울역', '숙대입구(갈월)', '녹사평(용산구청)', '이태원', '한강진', '한남', '서빙고', '이촌(국립중앙박물관)', '용산', '남영', '효창공원앞', '삼각지','신용산'))
head(yong) 
yong<-yong %>% select(총계)
yong
totyong<-sum(yong)
totyong


#광진구
kwang<-sub2006 %>% filter(역명 %in% c('중곡', '군자(능동)', '어린이대공원', '아차산(어린이대공원후문)', '광나루(장신대)', '건대입구', '구의(광진구청)', '강변(동서울터미널)', '뚝섬유원지'))
head(kwang) 
kwang<-kwang%>% select(총계)
kwang
totkwang<-sum(kwang)
totkwang

#동대문구
moon<-sub2006 %>% filter(역명 %in% c('신설동', '용두(동대문구청)', '제기동', '청량리(서울시립대입구)', '회기', '외대앞', '신이문', '왕십리(성동구청)'))
head(moon) 
moon<-moon%>% select(총계)
moon
totmoon<-sum(moon)
totmoon

#노원구
noone<-sub2006 %>% filter(역명 %in% c('석계', '광운대', '월계', '태릉입구', '화랑대(서울여대입구)', '공릉(서울과학기술대)', '하계', '중계', '노원', '상계','당고개', '마들', '수락산'))
head(noone) 
noone<-noone%>% select(총계)
noone
totnoone<-sum(noone)
totnoone


#강북구
kbook<-sub2006 %>% filter(역명 %in% c('솔샘', '삼양사거리', '삼양', '회계', '가오리', '4.19민주묘지', '솔밭공원', '북한산우이', '수유(강북구청)', '미아','미아사거리'))
head(kbook) 
kbook<-noone%>% select(총계)
kbook
totkbook<-sum(kbook)
totkbook


#서대문구
seo<-sub2006 %>% filter(역명 %in% c('홍제', '무악재', '서대문', '충정로(경기대입구)', '신촌(경의중앙선)', '신촌', '가좌'))
head(seo)
seo<-seo%>% select(총계)
seo
totseo<-sum(seo)
totseo


#성북구
seong<-sub2006 %>% filter(역명 %in% c('북한산보국문', '정릉', '성신여대입구', '길음', '한성대입구', '보문', '안암(고대병원앞)', '고려대(종암)','월곡(동덕여대)','상월곡(한국과학기술연구원)', '돌곶이'))
head(seong)
seong<-seong%>% select(총계)
seong
totseong<-sum(seong)
totseong

#종로구
jong<-sub2006 %>% filter(역명 %in% c('독립문', '경복궁(정부서울청사)', '안국', '종로3가', '광화문', '종각', '종로5가', '동대문','동묘앞','혜화', '창신'))
head(jong)
jong<-jong%>% select(총계)
jong
totjong<-sum(jong)
totjong


#중구
jung<-sub2006 %>% filter(역명 %in% c('시청', '을지로입구', '을지로3가', '을지로4가', '동대문역사문화공원', '신당', '청구', '약수','버티고개','동대입구', '충무로', '명동', '회현(남대문시장)'))
head(jung)
jung<-jung%>% select(총계)
jung
totjung<-sum(jung)
totjung


#마포구
mapo<-sub2006 %>% filter(역명 %in% c('월드컵경기장', '마포구청', '홍대입구', '망원', '합정', '상수', '광흥창(서강)', '대흥(서강대앞)','마포','공덕', '애오개', '이대', '아현'))
head(mapo)
mapo<-mapo%>% select(총계)
mapo
totmapo<-sum(mapo)
totmapo


#영등포구
yung<-sub2006 %>% filter(역명 %in% c('국회의사당', '여의나루', '샛강', '여의도', '대방', '신길', '영등포', '신풍','영등포시장','문래', '영등포구청', '당산', '양평', '선유도'))
head(yung)
yung<-yung%>% select(총계)
yung
totyung<-sum(yung)
totyung


#송파구
song<-sub2006 %>% filter(역명 %in% c('잠실나루', '몽촌토성(평화의문)', '잠실(송파구청)', '잠실새내', '종합운동장', '삼전', '석촌고분', '석촌','송파','가락시장', '문정', '장지', '복정', '경찰병원','오금','방이','개롱','거여','마천','올림픽공원','한성백제','송파나루'))
head(song)
song<-song%>% select(총계)
song
totsong<-sum(song)
totsong


#강남구
gnam<-sub2006 %>% filter(역명 %in% c('압구정로데오', '청담', '강남구청', '학동', '논현', '압구정', '신사', '잠원','신논현','언주', '선정릉', '삼성중앙','봉은사', '삼성(무역센터)', '선릉', '역삼', '강남', '한티', '매봉', '도곡', '대치', '학여울', '대청', '일원', '수서', '대모산입구', '개포동', '구룡')) 
head(gnam)
gnam<-gnam%>% select(총계)
gnam
totgnam<-sum(gnam)
totgnam


#서초구
scho<-sub2006 %>% filter(역명 %in% c('신반포', '구반포', '반포', '고속터미널', '사평', '내방', '총신대입구','방배', '서초', '교대(법원.검찰청)', '남부터미널', '양재(서초구청)', '양재시민의숲', '청계산입구', '남태령')) 
head(scho)
scho<-scho%>% select(총계)
scho
totscho<-sum(scho)
totscho


#성동구
sdong<-sub2006 %>% filter(역명 %in% c('상왕십리', '왕십리', '마장', '신답', '용답', '뚝섬', '한양대', '상수', '서울숲', '응봉', '옥수', '행당', '신금호'))
head(sdong)
sdong<-sdong%>% select(총계)
sdong
totsdong<-sum(sdong)
totsdong


#동작구
djak<-sub2006 %>% filter(역명 %in% c('노량진', '노들', '흑석(중앙대입구)', '동작(현충원)', '보라매', '신대방삼거리', '장승배기', '상도','숭실대입구', '남성', '신대방', '사당'))
head(djak)
djak<-djak%>% select(총계)
djak
totdjak<-sum(djak)
totdjak


#데이터프레임 생성 후 막대그래프 그리기
지역구<-c("동작구","도봉구","은평구", "강동구", "강서구","강남구","구로구","중랑구","종로구","중구","강북구","금천구","관악구","광진구","마포구","동대문구","노원구","서초구","성동구","서대문구","성북구","송파구","양천구","용산구","영등포구")
합계206<-c(10476922,4959956,9314226,7988134,11094909,32330125,13059735,4961823,12425062,13193163,10565746,4634973,4578692,9332811,12533801,7892938,10565746,11938582,4956915,4842168,4348965,14726470,2612985,10345915,13933790)
DF2006<-data.frame(지역구,합계206)
DF2006

################7월######################3

#install.packages("dplyr")
#library(dplyr)

#19년 7 자료
sub2007<-read.csv("C:\\Users\\Hanbeen Cho\\Desktop\\카드이용 2020\\CARD_SUBWAY_MONTH_202007.csv")
sub2007


#하루 총 이용객수(총계) 변수 추가하기
sub2007<- sub2007 %>% mutate(총계=승차총승객수+하차총승객수)
head(sub2007)

#사용일자, 노선명, 등록일자 삭제
sub2007<- sub2007 %>% select(역명, 승차총승객수, 하차총승객수,총계)
head(sub2007)

#강서구
gangseo<-sub2007 %>% filter(역명 %in% c('방화', '개화산', '김포공항', '송정', '마곡', '발산', '우장산', '화곡', '까치산', '염창', '등촌', '증미', '가양', '양천향교', '마곡나루', '신방화', '공항시장', '개화'))
head(gangseo)                             
gangseo<-gangseo %>% select(총계)
gangseo
totgangseo<-sum(gangseo)
totgangseo

#양천구
yang<-sub2007 %>% filter(역명 %in% c('신목동', '목동', '오목교', '신정네거리', '양천구청', '신정(은행정)'))
head(yang)                             
yang<-yang %>% select(총계)
yang
totyang<-sum(yang)
totyang

#금천구
keum<-sub2007 %>% filter(역명 %in% c('가산디지털단지', '독산', '금천구청'))
head(keum)    
keum<-keum %>% select(총계)
keum
totkeum<-sum(keum)
totkeum

#관악구
kwan<-sub2007 %>% filter(역명 %in% c('신림', '봉천', '서울대입구', '낙성대'))
head(kwan)  
kwan<-kwan %>% select(총계)
kwan
totkwan<-sum(kwan)
totkwan


#은평구
eun<-sub2007 %>% filter(역명 %in% c('독바위', '구파발', '연신내', '불광', '녹번', '역촌', '구산', '응암', '새절(신사)','증산(명지대앞)', '수색', '디지털미디어시티'))
head(eun)
eun<-eun %>% select(총계)
eun
toteun<-sum(eun)
toteun

#구로구
guro<-sub2007 %>% filter(역명 %in% c('온수(성공회대입구)', '천왕', '오류동', '개봉', '구일', '구로', '남구로', '대림(구로구청)', '구로디지털단지','신도림', '도림천'))
head(guro)  
guro<-guro %>% select(총계)
guro
totguro<-sum(guro)
totguro

#구로구
dobong<-sub2007 %>% filter(역명 %in% c('도봉산', '도봉', '방학', '창동', '녹천', '쌍문'))
head(dobong)  
dobong<-dobong %>% select(총계)
dobong
totdobong<-sum(dobong)
totdobong

#중랑구
jlang<-sub2007 %>% filter(역명 %in% c('먹골', '중화', '상봉(시외버스터미널)', '중량', '망우', '양원', '신내', '봉화산(서울의료원)', '면목', '사가정', '용마산'))
head(jlang)  
jlang<-jlang %>% select(총계)
jlang
totjlang<-sum(jlang)
totjlang


#강동구
gangdong<-sub2007 %>% filter(역명 %in% c('강동구청', '천호(풍납토성)', '암사', '강동', '길동', '굽은다리(강동구민회관앞)', '명일', '고덕', '상일동', '강일', '둔촌동', '둔촌오류','중앙보훈병원'))
head(gangdong) 
gangdong<-gangdong %>% select(총계)
gangdong
totgangdong<-sum(gangdong)
totgangdong


#용산구
yong<-sub2007 %>% filter(역명 %in% c('서울역', '숙대입구(갈월)', '녹사평(용산구청)', '이태원', '한강진', '한남', '서빙고', '이촌(국립중앙박물관)', '용산', '남영', '효창공원앞', '삼각지','신용산'))
head(yong) 
yong<-yong %>% select(총계)
yong
totyong<-sum(yong)
totyong


#광진구
kwang<-sub2007 %>% filter(역명 %in% c('중곡', '군자(능동)', '어린이대공원', '아차산(어린이대공원후문)', '광나루(장신대)', '건대입구', '구의(광진구청)', '강변(동서울터미널)', '뚝섬유원지'))
head(kwang) 
kwang<-kwang%>% select(총계)
kwang
totkwang<-sum(kwang)
totkwang

#동대문구
moon<-sub2007 %>% filter(역명 %in% c('신설동', '용두(동대문구청)', '제기동', '청량리(서울시립대입구)', '회기', '외대앞', '신이문', '왕십리(성동구청)'))
head(moon) 
moon<-moon%>% select(총계)
moon
totmoon<-sum(moon)
totmoon

#노원구
noone<-sub2007 %>% filter(역명 %in% c('석계', '광운대', '월계', '태릉입구', '화랑대(서울여대입구)', '공릉(서울과학기술대)', '하계', '중계', '노원', '상계','당고개', '마들', '수락산'))
head(noone) 
noone<-noone%>% select(총계)
noone
totnoone<-sum(noone)
totnoone


#강북구
kbook<-sub2007 %>% filter(역명 %in% c('솔샘', '삼양사거리', '삼양', '회계', '가오리', '4.19민주묘지', '솔밭공원', '북한산우이', '수유(강북구청)', '미아','미아사거리'))
head(kbook) 
kbook<-noone%>% select(총계)
kbook
totkbook<-sum(kbook)
totkbook


#서대문구
seo<-sub2007 %>% filter(역명 %in% c('홍제', '무악재', '서대문', '충정로(경기대입구)', '신촌(경의중앙선)', '신촌', '가좌'))
head(seo)
seo<-seo%>% select(총계)
seo
totseo<-sum(seo)
totseo


#성북구
seong<-sub2007 %>% filter(역명 %in% c('북한산보국문', '정릉', '성신여대입구', '길음', '한성대입구', '보문', '안암(고대병원앞)', '고려대(종암)','월곡(동덕여대)','상월곡(한국과학기술연구원)', '돌곶이'))
head(seong)
seong<-seong%>% select(총계)
seong
totseong<-sum(seong)
totseong

#종로구
jong<-sub2007 %>% filter(역명 %in% c('독립문', '경복궁(정부서울청사)', '안국', '종로3가', '광화문', '종각', '종로5가', '동대문','동묘앞','혜화', '창신'))
head(jong)
jong<-jong%>% select(총계)
jong
totjong<-sum(jong)
totjong


#중구
jung<-sub2007 %>% filter(역명 %in% c('시청', '을지로입구', '을지로3가', '을지로4가', '동대문역사문화공원', '신당', '청구', '약수','버티고개','동대입구', '충무로', '명동', '회현(남대문시장)'))
head(jung)
jung<-jung%>% select(총계)
jung
totjung<-sum(jung)
totjung


#마포구
mapo<-sub2007 %>% filter(역명 %in% c('월드컵경기장', '마포구청', '홍대입구', '망원', '합정', '상수', '광흥창(서강)', '대흥(서강대앞)','마포','공덕', '애오개', '이대', '아현'))
head(mapo)
mapo<-mapo%>% select(총계)
mapo
totmapo<-sum(mapo)
totmapo


#영등포구
yung<-sub2007 %>% filter(역명 %in% c('국회의사당', '여의나루', '샛강', '여의도', '대방', '신길', '영등포', '신풍','영등포시장','문래', '영등포구청', '당산', '양평', '선유도'))
head(yung)
yung<-yung%>% select(총계)
yung
totyung<-sum(yung)
totyung


#송파구
song<-sub2007 %>% filter(역명 %in% c('잠실나루', '몽촌토성(평화의문)', '잠실(송파구청)', '잠실새내', '종합운동장', '삼전', '석촌고분', '석촌','송파','가락시장', '문정', '장지', '복정', '경찰병원','오금','방이','개롱','거여','마천','올림픽공원','한성백제','송파나루'))
head(song)
song<-song%>% select(총계)
song
totsong<-sum(song)
totsong


#강남구
gnam<-sub2007 %>% filter(역명 %in% c('압구정로데오', '청담', '강남구청', '학동', '논현', '압구정', '신사', '잠원','신논현','언주', '선정릉', '삼성중앙','봉은사', '삼성(무역센터)', '선릉', '역삼', '강남', '한티', '매봉', '도곡', '대치', '학여울', '대청', '일원', '수서', '대모산입구', '개포동', '구룡')) 
head(gnam)
gnam<-gnam%>% select(총계)
gnam
totgnam<-sum(gnam)
totgnam


#서초구
scho<-sub2007 %>% filter(역명 %in% c('신반포', '구반포', '반포', '고속터미널', '사평', '내방', '총신대입구','방배', '서초', '교대(법원.검찰청)', '남부터미널', '양재(서초구청)', '양재시민의숲', '청계산입구', '남태령')) 
head(scho)
scho<-scho%>% select(총계)
scho
totscho<-sum(scho)
totscho


#성동구
sdong<-sub2007 %>% filter(역명 %in% c('상왕십리', '왕십리', '마장', '신답', '용답', '뚝섬', '한양대', '상수', '서울숲', '응봉', '옥수', '행당', '신금호'))
head(sdong)
sdong<-sdong%>% select(총계)
sdong
totsdong<-sum(sdong)
totsdong


#동작구
djak<-sub2007 %>% filter(역명 %in% c('노량진', '노들', '흑석(중앙대입구)', '동작(현충원)', '보라매', '신대방삼거리', '장승배기', '상도','숭실대입구', '남성', '신대방', '사당'))
head(djak)
djak<-djak%>% select(총계)
djak
totdjak<-sum(djak)
totdjak


#데이터프레임 생성 후 막대그래프 그리기
지역구<-c("동작구","도봉구","은평구", "강동구", "강서구","강남구","구로구","중랑구","종로구","중구","강북구","금천구","관악구","광진구","마포구","동대문구","노원구","서초구","성동구","서대문구","성북구","송파구","양천구","용산구","영등포구")
합계207<-c(11179694,5231095,9856700,8439408,11823316,35130379,13922566,5232558,13568216,14052016,11115937,4849924,4822341,10000595,13838860,8430582,11115937,12737110,5263023,5265053,4533929,15878429,2796037,11328255,14858566)
DF2007<-data.frame(지역구,합계207)
DF2007


################7월######################3

#install.packages("dplyr")
#library(dplyr)

#19년 8 자료
sub2008<-read.csv("C:\\Users\\Hanbeen Cho\\Desktop\\카드이용 2020\\CARD_SUBWAY_MONTH_202008.csv")
sub2008

#하루 총 이용객수(총계) 변수 추가하기
sub2008<- sub2008 %>% mutate(총계=승차총승객수+하차총승객수)
head(sub2008)

#사용일자, 노선명, 등록일자 삭제
sub2008<- sub2008 %>% select(역명, 승차총승객수, 하차총승객수,총계)
head(sub2008)

#강서구
gangseo<-sub2008 %>% filter(역명 %in% c('방화', '개화산', '김포공항', '송정', '마곡', '발산', '우장산', '화곡', '까치산', '염창', '등촌', '증미', '가양', '양천향교', '마곡나루', '신방화', '공항시장', '개화'))
head(gangseo)                             
gangseo<-gangseo %>% select(총계)
gangseo
totgangseo<-sum(gangseo)
totgangseo

#양천구
yang<-sub2008 %>% filter(역명 %in% c('신목동', '목동', '오목교', '신정네거리', '양천구청', '신정(은행정)'))
head(yang)                             
yang<-yang %>% select(총계)
yang
totyang<-sum(yang)
totyang

#금천구
keum<-sub2008 %>% filter(역명 %in% c('가산디지털단지', '독산', '금천구청'))
head(keum)    
keum<-keum %>% select(총계)
keum
totkeum<-sum(keum)
totkeum

#관악구
kwan<-sub2008 %>% filter(역명 %in% c('신림', '봉천', '서울대입구', '낙성대'))
head(kwan)  
kwan<-kwan %>% select(총계)
kwan
totkwan<-sum(kwan)
totkwan


#은평구
eun<-sub2008 %>% filter(역명 %in% c('독바위', '구파발', '연신내', '불광', '녹번', '역촌', '구산', '응암', '새절(신사)','증산(명지대앞)', '수색', '디지털미디어시티'))
head(eun)
eun<-eun %>% select(총계)
eun
toteun<-sum(eun)
toteun

#구로구
guro<-sub2008 %>% filter(역명 %in% c('온수(성공회대입구)', '천왕', '오류동', '개봉', '구일', '구로', '남구로', '대림(구로구청)', '구로디지털단지','신도림', '도림천'))
head(guro)  
guro<-guro %>% select(총계)
guro
totguro<-sum(guro)
totguro

#구로구
dobong<-sub2008 %>% filter(역명 %in% c('도봉산', '도봉', '방학', '창동', '녹천', '쌍문'))
head(dobong)  
dobong<-dobong %>% select(총계)
dobong
totdobong<-sum(dobong)
totdobong

#중랑구
jlang<-sub2008 %>% filter(역명 %in% c('먹골', '중화', '상봉(시외버스터미널)', '중량', '망우', '양원', '신내', '봉화산(서울의료원)', '면목', '사가정', '용마산'))
head(jlang)  
jlang<-jlang %>% select(총계)
jlang
totjlang<-sum(jlang)
totjlang


#강동구
gangdong<-sub2008 %>% filter(역명 %in% c('강동구청', '천호(풍납토성)', '암사', '강동', '길동', '굽은다리(강동구민회관앞)', '명일', '고덕', '상일동', '강일', '둔촌동', '둔촌오류','중앙보훈병원'))
head(gangdong) 
gangdong<-gangdong %>% select(총계)
gangdong
totgangdong<-sum(gangdong)
totgangdong


#용산구
yong<-sub2008 %>% filter(역명 %in% c('서울역', '숙대입구(갈월)', '녹사평(용산구청)', '이태원', '한강진', '한남', '서빙고', '이촌(국립중앙박물관)', '용산', '남영', '효창공원앞', '삼각지','신용산'))
head(yong) 
yong<-yong %>% select(총계)
yong
totyong<-sum(yong)
totyong


#광진구
kwang<-sub2008 %>% filter(역명 %in% c('중곡', '군자(능동)', '어린이대공원', '아차산(어린이대공원후문)', '광나루(장신대)', '건대입구', '구의(광진구청)', '강변(동서울터미널)', '뚝섬유원지'))
head(kwang) 
kwang<-kwang%>% select(총계)
kwang
totkwang<-sum(kwang)
totkwang

#동대문구
moon<-sub2008 %>% filter(역명 %in% c('신설동', '용두(동대문구청)', '제기동', '청량리(서울시립대입구)', '회기', '외대앞', '신이문', '왕십리(성동구청)'))
head(moon) 
moon<-moon%>% select(총계)
moon
totmoon<-sum(moon)
totmoon

#노원구
noone<-sub2008 %>% filter(역명 %in% c('석계', '광운대', '월계', '태릉입구', '화랑대(서울여대입구)', '공릉(서울과학기술대)', '하계', '중계', '노원', '상계','당고개', '마들', '수락산'))
head(noone) 
noone<-noone%>% select(총계)
noone
totnoone<-sum(noone)
totnoone


#강북구
kbook<-sub2008 %>% filter(역명 %in% c('솔샘', '삼양사거리', '삼양', '회계', '가오리', '4.19민주묘지', '솔밭공원', '북한산우이', '수유(강북구청)', '미아','미아사거리'))
head(kbook) 
kbook<-noone%>% select(총계)
kbook
totkbook<-sum(kbook)
totkbook


#서대문구
seo<-sub2008 %>% filter(역명 %in% c('홍제', '무악재', '서대문', '충정로(경기대입구)', '신촌(경의중앙선)', '신촌', '가좌'))
head(seo)
seo<-seo%>% select(총계)
seo
totseo<-sum(seo)
totseo


#성북구
seong<-sub2008 %>% filter(역명 %in% c('북한산보국문', '정릉', '성신여대입구', '길음', '한성대입구', '보문', '안암(고대병원앞)', '고려대(종암)','월곡(동덕여대)','상월곡(한국과학기술연구원)', '돌곶이'))
head(seong)
seong<-seong%>% select(총계)
seong
totseong<-sum(seong)
totseong

#종로구
jong<-sub2008 %>% filter(역명 %in% c('독립문', '경복궁(정부서울청사)', '안국', '종로3가', '광화문', '종각', '종로5가', '동대문','동묘앞','혜화', '창신'))
head(jong)
jong<-jong%>% select(총계)
jong
totjong<-sum(jong)
totjong


#중구
jung<-sub2008 %>% filter(역명 %in% c('시청', '을지로입구', '을지로3가', '을지로4가', '동대문역사문화공원', '신당', '청구', '약수','버티고개','동대입구', '충무로', '명동', '회현(남대문시장)'))
head(jung)
jung<-jung%>% select(총계)
jung
totjung<-sum(jung)
totjung


#마포구
mapo<-sub2008 %>% filter(역명 %in% c('월드컵경기장', '마포구청', '홍대입구', '망원', '합정', '상수', '광흥창(서강)', '대흥(서강대앞)','마포','공덕', '애오개', '이대', '아현'))
head(mapo)
mapo<-mapo%>% select(총계)
mapo
totmapo<-sum(mapo)
totmapo


#영등포구
yung<-sub2008 %>% filter(역명 %in% c('국회의사당', '여의나루', '샛강', '여의도', '대방', '신길', '영등포', '신풍','영등포시장','문래', '영등포구청', '당산', '양평', '선유도'))
head(yung)
yung<-yung%>% select(총계)
yung
totyung<-sum(yung)
totyung


#송파구
song<-sub2008 %>% filter(역명 %in% c('잠실나루', '몽촌토성(평화의문)', '잠실(송파구청)', '잠실새내', '종합운동장', '삼전', '석촌고분', '석촌','송파','가락시장', '문정', '장지', '복정', '경찰병원','오금','방이','개롱','거여','마천','올림픽공원','한성백제','송파나루'))
head(song)
song<-song%>% select(총계)
song
totsong<-sum(song)
totsong


#강남구
gnam<-sub2008 %>% filter(역명 %in% c('압구정로데오', '청담', '강남구청', '학동', '논현', '압구정', '신사', '잠원','신논현','언주', '선정릉', '삼성중앙','봉은사', '삼성(무역센터)', '선릉', '역삼', '강남', '한티', '매봉', '도곡', '대치', '학여울', '대청', '일원', '수서', '대모산입구', '개포동', '구룡')) 
head(gnam)
gnam<-gnam%>% select(총계)
gnam
totgnam<-sum(gnam)
totgnam


#서초구
scho<-sub2008 %>% filter(역명 %in% c('신반포', '구반포', '반포', '고속터미널', '사평', '내방', '총신대입구','방배', '서초', '교대(법원.검찰청)', '남부터미널', '양재(서초구청)', '양재시민의숲', '청계산입구', '남태령')) 
head(scho)
scho<-scho%>% select(총계)
scho
totscho<-sum(scho)
totscho


#성동구
sdong<-sub2008 %>% filter(역명 %in% c('상왕십리', '왕십리', '마장', '신답', '용답', '뚝섬', '한양대', '상수', '서울숲', '응봉', '옥수', '행당', '신금호'))
head(sdong)
sdong<-sdong%>% select(총계)
sdong
totsdong<-sum(sdong)
totsdong


#동작구
djak<-sub2008 %>% filter(역명 %in% c('노량진', '노들', '흑석(중앙대입구)', '동작(현충원)', '보라매', '신대방삼거리', '장승배기', '상도','숭실대입구', '남성', '신대방', '사당'))
head(djak)
djak<-djak%>% select(총계)
djak
totdjak<-sum(djak)
totdjak


#데이터프레임 생성 후 막대그래프 그리기
지역구<-c("동작구","도봉구","은평구", "강동구", "강서구","강남구","구로구","중랑구","종로구","중구","강북구","금천구","관악구","광진구","마포구","동대문구","노원구","서초구","성동구","서대문구","성북구","송파구","양천구","용산구","영등포구")
합계208<-c(9333396,4340003,8282035,6972318,10262948,28938308,11859890,4462704,10748122,11307478,9292431,4001736,4212505,8257379,11498808,7083544,9292431,10608772,4329199,4358148,3671604,13267591,2353636,9573299,12323890)
DF2008<-data.frame(지역구,합계208)
DF2008

################10월######################3

#install.packages("dplyr")
#library(dplyr)

#19년 10 자료
sub2010<-read.csv("C:\\Users\\Hanbeen Cho\\Desktop\\카드이용 2020\\CARD_SUBWAY_MONTH_202010.csv")
sub2010

#하루 총 이용객수(총계) 변수 추가하기
sub2010<- sub2010 %>% mutate(총계=승차총승객수+하차총승객수)
head(sub2010)

#사용일자, 노선명, 등록일자 삭제
sub2010<- sub2010 %>% select(역명, 승차총승객수, 하차총승객수,총계)
head(sub2010)

#강서구
gangseo<-sub2010 %>% filter(역명 %in% c('방화', '개화산', '김포공항', '송정', '마곡', '발산', '우장산', '화곡', '까치산', '염창', '등촌', '증미', '가양', '양천향교', '마곡나루', '신방화', '공항시장', '개화'))
head(gangseo)                             
gangseo<-gangseo %>% select(총계)
gangseo
totgangseo<-sum(gangseo)
totgangseo

#양천구
yang<-sub2010 %>% filter(역명 %in% c('신목동', '목동', '오목교', '신정네거리', '양천구청', '신정(은행정)'))
head(yang)                             
yang<-yang %>% select(총계)
yang
totyang<-sum(yang)
totyang

#금천구
keum<-sub2010 %>% filter(역명 %in% c('가산디지털단지', '독산', '금천구청'))
head(keum)    
keum<-keum %>% select(총계)
keum
totkeum<-sum(keum)
totkeum

#관악구
kwan<-sub2010 %>% filter(역명 %in% c('신림', '봉천', '서울대입구', '낙성대'))
head(kwan)  
kwan<-kwan %>% select(총계)
kwan
totkwan<-sum(kwan)
totkwan


#은평구
eun<-sub2010 %>% filter(역명 %in% c('독바위', '구파발', '연신내', '불광', '녹번', '역촌', '구산', '응암', '새절(신사)','증산(명지대앞)', '수색', '디지털미디어시티'))
head(eun)
eun<-eun %>% select(총계)
eun
toteun<-sum(eun)
toteun

#구로구
guro<-sub2010 %>% filter(역명 %in% c('온수(성공회대입구)', '천왕', '오류동', '개봉', '구일', '구로', '남구로', '대림(구로구청)', '구로디지털단지','신도림', '도림천'))
head(guro)  
guro<-guro %>% select(총계)
guro
totguro<-sum(guro)
totguro

#도봉구
dobong<-sub2010 %>% filter(역명 %in% c('도봉산', '도봉', '방학', '창동', '녹천', '쌍문'))
head(dobong)  
dobong<-dobong %>% select(총계)
dobong
totdobong<-sum(dobong)
totdobong

#중랑구
jlang<-sub2010 %>% filter(역명 %in% c('먹골', '중화', '상봉(시외버스터미널)', '중량', '망우', '양원', '신내', '봉화산(서울의료원)', '면목', '사가정', '용마산'))
head(jlang)  
jlang<-jlang %>% select(총계)
jlang
totjlang<-sum(jlang)
totjlang
sub2010<-sum(gangdong)
totgangdong


#용산구
yong<-sub2010 %>% filter(역명 %in% c('서울역','숙대입구(갈월)','녹사평(용산구청)','이태원','한강진','한남','서빙고','이촌(국립중앙박물관)','용산','남영','효창공원앞','삼각지','신용산',useCache = FALSE))
head(yong) 
yong<-yong %>% select(총계)
yong
totyong<-sum(yong)
totyong


#광진구
kwang<-sub2010 %>% filter(역명 %in% c('중곡', '군자(능동)', '어린이대공원', '아차산(어린이대공원후문)', '광나루(장신대)', '건대입구', '구의(광진구청)', '강변(동서울터미널)', '뚝섬유원지'))
head(kwang) 
kwang<-kwang%>% select(총계)
kwang
totkwang<-sum(kwang)
totkwang

#동대문구
moon<-sub2010 %>% filter(역명 %in% c('신설동', '용두(동대문구청)', '제기동', '청량리(서울시립대입구)', '회기', '외대앞', '신이문', '왕십리(성동구청)'))
head(moon) 
moon<-moon%>% select(총계)
moon
totmoon<-sum(moon)
totmoon

#노원구
noone<-sub2010 %>% filter(역명 %in% c('석계', '광운대', '월계', '태릉입구', '화랑대(서울여대입구)', '공릉(서울과학기술대)', '하계', '중계', '노원', '상계','당고개', '마들', '수락산'))
head(noone) 
noone<-noone%>% select(총계)
noone
totnoone<-sum(noone)
totnoone


#강북구
kbook<-sub2010 %>% filter(역명 %in% c('솔샘', '삼양사거리', '삼양', '회계', '가오리', '4.19민주묘지', '솔밭공원', '북한산우이', '수유(강북구청)', '미아','미아사거리'))
head(kbook) 
kbook<-noone%>% select(총계)
kbook
totkbook<-sum(kbook)
totkbook


#서대문구
seo<-sub2010 %>% filter(역명 %in% c('홍제', '무악재', '서대문', '충정로(경기대입구)', '신촌(경의중앙선)', '신촌', '가좌'))
head(seo)
seo<-seo%>% select(총계)
seo
totseo<-sum(seo)
totseo


#성북구
seong<-sub2010 %>% filter(역명 %in% c('북한산보국문', '정릉', '성신여대입구', '길음', '한성대입구', '보문', '안암(고대병원앞)', '고려대(종암)','월곡(동덕여대)','상월곡(한국과학기술연구원)', '돌곶이'))
head(seong)
seong<-seong%>% select(총계)
seong
totseong<-sum(seong)
totseong

#종로구
jong<-sub2010 %>% filter(역명 %in% c('독립문', '경복궁(정부서울청사)', '안국', '종로3가', '광화문', '종각', '종로5가', '동대문','동묘앞','혜화', '창신'))
head(jong)
jong<-jong%>% select(총계)
jong
totjong<-sum(jong)
totjong


#중구
jung<-sub2010 %>% filter(역명 %in% c('시청', '을지로입구', '을지로3가', '을지로4가', '동대문역사문화공원', '신당', '청구', '약수','버티고개','동대입구', '충무로', '명동', '회현(남대문시장)'))
head(jung)
jung<-jung%>% select(총계)
jung
totjung<-sum(jung)
totjung


#마포구
mapo<-sub2010 %>% filter(역명 %in% c('월드컵경기장', '마포구청', '홍대입구', '망원', '합정', '상수', '광흥창(서강)', '대흥(서강대앞)','마포','공덕', '애오개', '이대', '아현'))
head(mapo)
mapo<-mapo%>% select(총계)
mapo
totmapo<-sum(mapo)
totmapo


#영등포구
yung<-sub2010 %>% filter(역명 %in% c('국회의사당', '여의나루', '샛강', '여의도', '대방', '신길', '영등포', '신풍','영등포시장','문래', '영등포구청', '당산', '양평', '선유도'))
head(yung)
yung<-yung%>% select(총계)
yung
totyung<-sum(yung)
totyung


#송파구
song<-sub2010 %>% filter(역명 %in% c('잠실나루', '몽촌토성(평화의문)', '잠실(송파구청)', '잠실새내', '종합운동장', '삼전', '석촌고분', '석촌','송파','가락시장', '문정', '장지', '복정', '경찰병원','오금','방이','개롱','거여','마천','올림픽공원','한성백제','송파나루'))
head(song)
song<-song%>% select(총계)
song
totsong<-sum(song)
totsong


#강남구
gnam<-sub2010 %>% filter(역명 %in% c('압구정로데오', '청담', '강남구청', '학동', '논현', '압구정', '신사', '잠원','신논현','언주', '선정릉', '삼성중앙','봉은사', '삼성(무역센터)', '선릉', '역삼', '강남', '한티', '매봉', '도곡', '대치', '학여울', '대청', '일원', '수서', '대모산입구', '개포동', '구룡')) 
head(gnam)
gnam<-gnam%>% select(총계)
gnam
totgnam<-sum(gnam)
totgnam


#서초구
scho<-sub2010 %>% filter(역명 %in% c('신반포', '구반포', '반포', '고속터미널', '사평', '내방', '총신대입구','방배', '서초', '교대(법원.검찰청)', '남부터미널', '양재(서초구청)', '양재시민의숲', '청계산입구', '남태령')) 
head(scho)
scho<-scho%>% select(총계)
scho
totscho<-sum(scho)
totscho


#성동구
sdong<-sub2010 %>% filter(역명 %in% c('상왕십리', '왕십리', '마장', '신답', '용답', '뚝섬', '한양대', '상수', '서울숲', '응봉', '옥수', '행당', '신금호'))
head(sdong)
sdong<-sdong%>% select(총계)
sdong
totsdong<-sum(sdong)
totsdong


#동작구
djak<-sub2010 %>% filter(역명 %in% c('노량진', '노들', '흑석(중앙대입구)', '동작(현충원)', '보라매', '신대방삼거리', '장승배기', '상도','숭실대입구', '남성', '신대방', '사당'))
head(djak)
djak<-djak%>% select(총계)
djak
totdjak<-sum(djak)
totdjak


#데이터프레임 생성 후 막대그래프 그리기
지역구<-c("동작구","도봉구","은평구", "강동구", "강서구","강남구","구로구","중랑구","종로구","중구","강북구","금천구","관악구","광진구","마포구","동대문구","노원구","서초구","성동구","서대문구","성북구","송파구","양천구","용산구","영등포구")
합계2010<-c(10199407,4869116,9159040,7491255,11047223,30224216,12978008,4915611,12194744,12458480,10309924,4402657,4441288,9105269,12612981,7903604,10309924,11398007,4822072,4673931,4137229,14481565,2558005,10387629,13274237)
DF2010<-data.frame(지역구,합계2010)
DF2010



################9월######################3

#install.packages("dplyr")
#library(dplyr)

#19년 9 자료
sub2009<-read.csv("C:\\Users\\Hanbeen Cho\\Desktop\\카드이용 2020\\CARD_SUBWAY_MONTH_202009.csv")
sub2009

#하루 총 이용객수(총계) 변수 추가하기
sub2009<- sub2009 %>% mutate(총계=승차총승객수+하차총승객수)
head(sub2009)

#사용일자, 노선명, 등록일자 삭제
sub2009<- sub2009 %>% select(역명, 승차총승객수, 하차총승객수,총계)
head(sub2009)

#강서구
gangseo<-sub2009 %>% filter(역명 %in% c('방화', '개화산', '김포공항', '송정', '마곡', '발산', '우장산', '화곡', '까치산', '염창', '등촌', '증미', '가양', '양천향교', '마곡나루', '신방화', '공항시장', '개화'))
head(gangseo)                             
gangseo<-gangseo %>% select(총계)
gangseo
totgangseo<-sum(gangseo)
totgangseo

#양천구
yang<-sub2009 %>% filter(역명 %in% c('신목동', '목동', '오목교', '신정네거리', '양천구청', '신정(은행정)'))
head(yang)                             
yang<-yang %>% select(총계)
yang
totyang<-sum(yang)
totyang

#금천구
keum<-sub2009 %>% filter(역명 %in% c('가산디지털단지', '독산', '금천구청'))
head(keum)    
keum<-keum %>% select(총계)
keum
totkeum<-sum(keum)
totkeum

#관악구
kwan<-sub2009 %>% filter(역명 %in% c('신림', '봉천', '서울대입구', '낙성대'))
head(kwan)  
kwan<-kwan %>% select(총계)
kwan
totkwan<-sum(kwan)
totkwan


#은평구
eun<-sub2009 %>% filter(역명 %in% c('독바위', '구파발', '연신내', '불광', '녹번', '역촌', '구산', '응암', '새절(신사)','증산(명지대앞)', '수색', '디지털미디어시티'))
head(eun)
eun<-eun %>% select(총계)
eun
toteun<-sum(eun)
toteun

#구로구
guro<-sub2009 %>% filter(역명 %in% c('온수(성공회대입구)', '천왕', '오류동', '개봉', '구일', '구로', '남구로', '대림(구로구청)', '구로디지털단지','신도림', '도림천'))
head(guro)  
guro<-guro %>% select(총계)
guro
totguro<-sum(guro)
totguro

#구로구
dobong<-sub2009 %>% filter(역명 %in% c('도봉산', '도봉', '방학', '창동', '녹천', '쌍문'))
head(dobong)  
dobong<-dobong %>% select(총계)
dobong
totdobong<-sum(dobong)
totdobong

#중랑구
jlang<-sub2009 %>% filter(역명 %in% c('먹골', '중화', '상봉(시외버스터미널)', '중량', '망우', '양원', '신내', '봉화산(서울의료원)', '면목', '사가정', '용마산'))
head(jlang)  
jlang<-jlang %>% select(총계)
jlang
totjlang<-sum(jlang)
totjlang


#강동구
gangdong<-sub2009 %>% filter(역명 %in% c('강동구청', '천호(풍납토성)', '암사', '강동', '길동', '굽은다리(강동구민회관앞)', '명일', '고덕', '상일동', '강일', '둔촌동', '둔촌오류','중앙보훈병원'))
head(gangdong) 
gangdong<-gangdong %>% select(총계)
gangdong
totgangdong<-sum(gangdong)
totgangdong


#용산구
yong<-sub2009 %>% filter(역명 %in% c('서울역', '숙대입구(갈월)', '녹사평(용산구청)', '이태원', '한강진', '한남', '서빙고', '이촌(국립중앙박물관)', '용산', '남영', '효창공원앞', '삼각지','신용산'))
head(yong) 
yong<-yong %>% select(총계)
yong
totyong<-sum(yong)
totyong


#광진구
kwang<-sub2009 %>% filter(역명 %in% c('중곡', '군자(능동)', '어린이대공원', '아차산(어린이대공원후문)', '광나루(장신대)', '건대입구', '구의(광진구청)', '강변(동서울터미널)', '뚝섬유원지'))
head(kwang) 
kwang<-kwang%>% select(총계)
kwang
totkwang<-sum(kwang)
totkwang

#동대문구
moon<-sub2009 %>% filter(역명 %in% c('신설동', '용두(동대문구청)', '제기동', '청량리(서울시립대입구)', '회기', '외대앞', '신이문', '왕십리(성동구청)'))
head(moon) 
moon<-moon%>% select(총계)
moon
totmoon<-sum(moon)
totmoon

#노원구
noone<-sub2009 %>% filter(역명 %in% c('석계', '광운대', '월계', '태릉입구', '화랑대(서울여대입구)', '공릉(서울과학기술대)', '하계', '중계', '노원', '상계','당고개', '마들', '수락산'))
head(noone) 
noone<-noone%>% select(총계)
noone
totnoone<-sum(noone)
totnoone


#강북구
kbook<-sub2009 %>% filter(역명 %in% c('솔샘', '삼양사거리', '삼양', '회계', '가오리', '4.19민주묘지', '솔밭공원', '북한산우이', '수유(강북구청)', '미아','미아사거리'))
head(kbook) 
kbook<-noone%>% select(총계)
kbook
totkbook<-sum(kbook)
totkbook


#서대문구
seo<-sub2009 %>% filter(역명 %in% c('홍제', '무악재', '서대문', '충정로(경기대입구)', '신촌(경의중앙선)', '신촌', '가좌'))
head(seo)
seo<-seo%>% select(총계)
seo
totseo<-sum(seo)
totseo


#성북구
seong<-sub2009 %>% filter(역명 %in% c('북한산보국문', '정릉', '성신여대입구', '길음', '한성대입구', '보문', '안암(고대병원앞)', '고려대(종암)','월곡(동덕여대)','상월곡(한국과학기술연구원)', '돌곶이'))
head(seong)
seong<-seong%>% select(총계)
seong
totseong<-sum(seong)
totseong

#종로구
jong<-sub2009 %>% filter(역명 %in% c('독립문', '경복궁(정부서울청사)', '안국', '종로3가', '광화문', '종각', '종로5가', '동대문','동묘앞','혜화', '창신'))
head(jong)
jong<-jong%>% select(총계)
jong
totjong<-sum(jong)
totjong


#중구
jung<-sub2009 %>% filter(역명 %in% c('시청', '을지로입구', '을지로3가', '을지로4가', '동대문역사문화공원', '신당', '청구', '약수','버티고개','동대입구', '충무로', '명동', '회현(남대문시장)'))
head(jung)
jung<-jung%>% select(총계)
jung
totjung<-sum(jung)
totjung


#마포구
mapo<-sub2009 %>% filter(역명 %in% c('월드컵경기장', '마포구청', '홍대입구', '망원', '합정', '상수', '광흥창(서강)', '대흥(서강대앞)','마포','공덕', '애오개', '이대', '아현'))
head(mapo)
mapo<-mapo%>% select(총계)
mapo
totmapo<-sum(mapo)
totmapo


#영등포구
yung<-sub2009 %>% filter(역명 %in% c('국회의사당', '여의나루', '샛강', '여의도', '대방', '신길', '영등포', '신풍','영등포시장','문래', '영등포구청', '당산', '양평', '선유도'))
head(yung)
yung<-yung%>% select(총계)
yung
totyung<-sum(yung)
totyung


#송파구
song<-sub2009 %>% filter(역명 %in% c('잠실나루', '몽촌토성(평화의문)', '잠실(송파구청)', '잠실새내', '종합운동장', '삼전', '석촌고분', '석촌','송파','가락시장', '문정', '장지', '복정', '경찰병원','오금','방이','개롱','거여','마천','올림픽공원','한성백제','송파나루'))
head(song)
song<-song%>% select(총계)
song
totsong<-sum(song)
totsong


#강남구
gnam<-sub2009 %>% filter(역명 %in% c('압구정로데오', '청담', '강남구청', '학동', '논현', '압구정', '신사', '잠원','신논현','언주', '선정릉', '삼성중앙','봉은사', '삼성(무역센터)', '선릉', '역삼', '강남', '한티', '매봉', '도곡', '대치', '학여울', '대청', '일원', '수서', '대모산입구', '개포동', '구룡')) 
head(gnam)
gnam<-gnam%>% select(총계)
gnam
totgnam<-sum(gnam)
totgnam


#서초구
scho<-sub2009 %>% filter(역명 %in% c('신반포', '구반포', '반포', '고속터미널', '사평', '내방', '총신대입구','방배', '서초', '교대(법원.검찰청)', '남부터미널', '양재(서초구청)', '양재시민의숲', '청계산입구', '남태령')) 
head(scho)
scho<-scho%>% select(총계)
scho
totscho<-sum(scho)
totscho


#성동구
sdong<-sub2009 %>% filter(역명 %in% c('상왕십리', '왕십리', '마장', '신답', '용답', '뚝섬', '한양대', '상수', '서울숲', '응봉', '옥수', '행당', '신금호'))
head(sdong)
sdong<-sdong%>% select(총계)
sdong
totsdong<-sum(sdong)
totsdong


#동작구
djak<-sub2009 %>% filter(역명 %in% c('노량진', '노들', '흑석(중앙대입구)', '동작(현충원)', '보라매', '신대방삼거리', '장승배기', '상도','숭실대입구', '남성', '신대방', '사당'))
head(djak)
djak<-djak%>% select(총계)
djak
totdjak<-sum(djak)
totdjak


#데이터프레임 생성 후 막대그래프 그리기
지역구<-c("동작구","도봉구","은평구", "강동구", "강서구","강남구","구로구","중랑구","종로구","중구","강북구","금천구","관악구","광진구","마포구","동대문구","노원구","서초구","성동구","서대문구","성북구","송파구","양천구","용산구","영등포구")
합계209<-c(8658528,4267327,8004773,6538345,9559004,26088597,11408439,4336233,9976762,10914997,8849764,4027401,3972250,7692707,10430949,6936429,8849764,9614422,4179497,3976988,3606473,12269210,2241483,8492935,11544922)
DF2009<-data.frame(지역구,합계209)
DF2009


################12월######################3

#install.packages("dplyr")
#library(dplyr)

#19년 12 자료
sub2012<-read.csv("C:\\Users\\Hanbeen Cho\\Desktop\\카드이용 2020\\CARD_SUBWAY_MONTH_202012.csv")
sub2012

#하루 총 이용객수(총계) 변수 추가하기
sub2012<- sub2012 %>% mutate(총계=승차총승객수+하차총승객수)
head(sub2012)

#사용일자, 노선명, 등록일자 삭제
sub2012<- sub2012 %>% select(역명, 승차총승객수, 하차총승객수,총계)
head(sub2012)

#강서구
gangseo<-sub2012 %>% filter(역명 %in% c('방화', '개화산', '김포공항', '송정', '마곡', '발산', '우장산', '화곡', '까치산', '염창', '등촌', '증미', '가양', '양천향교', '마곡나루', '신방화', '공항시장', '개화'))
head(gangseo)                             
gangseo<-gangseo %>% select(총계)
gangseo
totgangseo<-sum(gangseo)
totgangseo

#양천구
yang<-sub2012 %>% filter(역명 %in% c('신목동', '목동', '오목교', '신정네거리', '양천구청', '신정(은행정)'))
head(yang)                             
yang<-yang %>% select(총계)
yang
totyang<-sum(yang)
totyang

#금천구
keum<-sub2012 %>% filter(역명 %in% c('가산디지털단지', '독산', '금천구청'))
head(keum)    
keum<-keum %>% select(총계)
keum
totkeum<-sum(keum)
totkeum

#관악구
kwan<-sub2012 %>% filter(역명 %in% c('신림', '봉천', '서울대입구', '낙성대'))
head(kwan)  
kwan<-kwan %>% select(총계)
kwan
totkwan<-sum(kwan)
totkwan


#은평구
eun<-sub2012 %>% filter(역명 %in% c('독바위', '구파발', '연신내', '불광', '녹번', '역촌', '구산', '응암', '새절(신사)','증산(명지대앞)', '수색', '디지털미디어시티'))
head(eun)
eun<-eun %>% select(총계)
eun
toteun<-sum(eun)
toteun

#구로구
guro<-sub2012 %>% filter(역명 %in% c('온수(성공회대입구)', '천왕', '오류동', '개봉', '구일', '구로', '남구로', '대림(구로구청)', '구로디지털단지','신도림', '도림천'))
head(guro)  
guro<-guro %>% select(총계)
guro
totguro<-sum(guro)
totguro

#도봉구
dobong<-sub2012 %>% filter(역명 %in% c('도봉산', '도봉', '방학', '창동', '녹천', '쌍문'))
head(dobong)  
dobong<-dobong %>% select(총계)
dobong
totdobong<-sum(dobong)
totdobong

#중랑구
jlang<-sub2012 %>% filter(역명 %in% c('먹골', '중화', '상봉(시외버스터미널)', '중량', '망우', '양원', '신내', '봉화산(서울의료원)', '면목', '사가정', '용마산'))
head(jlang)  
jlang<-jlang %>% select(총계)
jlang
totjlang<-sum(jlang)
totjlang


#강동구
gangdong<-sub2012 %>% filter(역명 %in% c('강동구청', '천호(풍납토성)', '암사', '강동', '길동', '굽은다리(강동구민회관앞)', '명일', '고덕', '상일동', '강일', '둔촌동', '둔촌오류','중앙보훈병원'))
head(gangdong) 
gangdong<-gangdong %>% select(총계)
gangdong
totgangdong<-sum(gangdong)
totgangdong


#용산구
yong<-sub2012 %>% filter(역명 %in% c('서울역', '숙대입구(갈월)', '녹사평(용산구청)', '이태원', '한강진', '한남', '서빙고', '이촌(국립중앙박물관)', '용산', '남영', '효창공원앞', '삼각지','신용산'))
head(yong) 
yong<-yong %>% select(총계)
yong
totyong<-sum(yong)
totyong


#광진구
kwang<-sub2012 %>% filter(역명 %in% c('중곡', '군자(능동)', '어린이대공원', '아차산(어린이대공원후문)', '광나루(장신대)', '건대입구', '구의(광진구청)', '강변(동서울터미널)', '뚝섬유원지'))
head(kwang) 
kwang<-kwang%>% select(총계)
kwang
totkwang<-sum(kwang)
totkwang

#동대문구
moon<-sub2012 %>% filter(역명 %in% c('신설동', '용두(동대문구청)', '제기동', '청량리(서울시립대입구)', '회기', '외대앞', '신이문', '왕십리(성동구청)'))
head(moon) 
moon<-moon%>% select(총계)
moon
totmoon<-sum(moon)
totmoon

#노원구
noone<-sub2012 %>% filter(역명 %in% c('석계', '광운대', '월계', '태릉입구', '화랑대(서울여대입구)', '공릉(서울과학기술대)', '하계', '중계', '노원', '상계','당고개', '마들', '수락산'))
head(noone) 
noone<-noone%>% select(총계)
noone
totnoone<-sum(noone)
totnoone


#강북구
kbook<-sub2012 %>% filter(역명 %in% c('솔샘', '삼양사거리', '삼양', '회계', '가오리', '4.19민주묘지', '솔밭공원', '북한산우이', '수유(강북구청)', '미아','미아사거리'))
head(kbook) 
kbook<-noone%>% select(총계)
kbook
totkbook<-sum(kbook)
totkbook


#서대문구
seo<-sub2012 %>% filter(역명 %in% c('홍제', '무악재', '서대문', '충정로(경기대입구)', '신촌(경의중앙선)', '신촌', '가좌'))
head(seo)
seo<-seo%>% select(총계)
seo
totseo<-sum(seo)
totseo


#성북구
seong<-sub2012 %>% filter(역명 %in% c('북한산보국문', '정릉', '성신여대입구', '길음', '한성대입구', '보문', '안암(고대병원앞)', '고려대(종암)','월곡(동덕여대)','상월곡(한국과학기술연구원)', '돌곶이'))
head(seong)
seong<-seong%>% select(총계)
seong
totseong<-sum(seong)
totseong

#종로구
jong<-sub2012 %>% filter(역명 %in% c('독립문', '경복궁(정부서울청사)', '안국', '종로3가', '광화문', '종각', '종로5가', '동대문','동묘앞','혜화', '창신'))
head(jong)
jong<-jong%>% select(총계)
jong
totjong<-sum(jong)
totjong


#중구
jung<-sub2012 %>% filter(역명 %in% c('시청', '을지로입구', '을지로3가', '을지로4가', '동대문역사문화공원', '신당', '청구', '약수','버티고개','동대입구', '충무로', '명동', '회현(남대문시장)'))
head(jung)
jung<-jung%>% select(총계)
jung
totjung<-sum(jung)
totjung


#마포구
mapo<-sub2012 %>% filter(역명 %in% c('월드컵경기장', '마포구청', '홍대입구', '망원', '합정', '상수', '광흥창(서강)', '대흥(서강대앞)','마포','공덕', '애오개', '이대', '아현'))
head(mapo)
mapo<-mapo%>% select(총계)
mapo
totmapo<-sum(mapo)
totmapo


#영등포구
yung<-sub2012 %>% filter(역명 %in% c('국회의사당', '여의나루', '샛강', '여의도', '대방', '신길', '영등포', '신풍','영등포시장','문래', '영등포구청', '당산', '양평', '선유도'))
head(yung)
yung<-yung%>% select(총계)
yung
totyung<-sum(yung)
totyung


#송파구
song<-sub2012 %>% filter(역명 %in% c('잠실나루', '몽촌토성(평화의문)', '잠실(송파구청)', '잠실새내', '종합운동장', '삼전', '석촌고분', '석촌','송파','가락시장', '문정', '장지', '복정', '경찰병원','오금','방이','개롱','거여','마천','올림픽공원','한성백제','송파나루'))
head(song)
song<-song%>% select(총계)
song
totsong<-sum(song)
totsong


#강남구
gnam<-sub2012 %>% filter(역명 %in% c('압구정로데오', '청담', '강남구청', '학동', '논현', '압구정', '신사', '잠원','신논현','언주', '선정릉', '삼성중앙','봉은사', '삼성(무역센터)', '선릉', '역삼', '강남', '한티', '매봉', '도곡', '대치', '학여울', '대청', '일원', '수서', '대모산입구', '개포동', '구룡')) 
head(gnam)
gnam<-gnam%>% select(총계)
gnam
totgnam<-sum(gnam)
totgnam


#서초구
scho<-sub2012 %>% filter(역명 %in% c('신반포', '구반포', '반포', '고속터미널', '사평', '내방', '총신대입구','방배', '서초', '교대(법원.검찰청)', '남부터미널', '양재(서초구청)', '양재시민의숲', '청계산입구', '남태령')) 
head(scho)
scho<-scho%>% select(총계)
scho
totscho<-sum(scho)
totscho


#성동구
sdong<-sub2012 %>% filter(역명 %in% c('상왕십리', '왕십리', '마장', '신답', '용답', '뚝섬', '한양대', '상수', '서울숲', '응봉', '옥수', '행당', '신금호'))
head(sdong)
sdong<-sdong%>% select(총계)
sdong
totsdong<-sum(sdong)
totsdong


#동작구
djak<-sub2012 %>% filter(역명 %in% c('노량진', '노들', '흑석(중앙대입구)', '동작(현충원)', '보라매', '신대방삼거리', '장승배기', '상도','숭실대입구', '남성', '신대방', '사당'))
head(djak)
djak<-djak%>% select(총계)
djak
totdjak<-sum(djak)
totdjak


#데이터프레임 생성 후 막대그래프 그리기
지역구<-c("동작구","도봉구","은평구", "강동구", "강서구","강남구","구로구","중랑구","종로구","중구","강북구","금천구","관악구","광진구","마포구","동대문구","노원구","서초구","성동구","서대문구","성북구","송파구","양천구","용산구","영등포구")
합계2012<-c(8248488,4093251,7781850,6500328,9376219,25477271,10991685,4238300,9299467,10763086,8621073,4026481,3841090,7288953,9706043,6432889,8621073,9302076,3926656,3910043,3503525,12004322,2191399,8015662,11234802)
DF2012<-data.frame(지역구,합계2012)
DF2012




################11월######################3

#install.packages("dplyr")
#library(dplyr)

#19년 11 자료
sub2011<-read.csv("C:\\Users\\Hanbeen Cho\\Desktop\\카드이용 2020\\CARD_SUBWAY_MONTH_202011.csv")
sub2011

#하루 총 이용객수(총계) 변수 추가하기
sub2011<- sub2011 %>% mutate(총계=승차총승객수+하차총승객수)
head(sub2011)

#사용일자, 노선명, 등록일자 삭제
sub2011<- sub2011 %>% select(역명, 승차총승객수, 하차총승객수,총계)
head(sub2011)

#강서구
gangseo<-sub2011 %>% filter(역명 %in% c('방화', '개화산', '김포공항', '송정', '마곡', '발산', '우장산', '화곡', '까치산', '염창', '등촌', '증미', '가양', '양천향교', '마곡나루', '신방화', '공항시장', '개화'))
head(gangseo)                             
gangseo<-gangseo %>% select(총계)
gangseo
totgangseo<-sum(gangseo)
totgangseo

#양천구
yang<-sub2011 %>% filter(역명 %in% c('신목동', '목동', '오목교', '신정네거리', '양천구청', '신정(은행정)'))
head(yang)                             
yang<-yang %>% select(총계)
yang
totyang<-sum(yang)
totyang

#금천구
keum<-sub2011 %>% filter(역명 %in% c('가산디지털단지', '독산', '금천구청'))
head(keum)    
keum<-keum %>% select(총계)
keum
totkeum<-sum(keum)
totkeum

#관악구
kwan<-sub2011 %>% filter(역명 %in% c('신림', '봉천', '서울대입구', '낙성대'))
head(kwan)  
kwan<-kwan %>% select(총계)
kwan
totkwan<-sum(kwan)
totkwan


#은평구
eun<-sub2011 %>% filter(역명 %in% c('독바위', '구파발', '연신내', '불광', '녹번', '역촌', '구산', '응암', '새절(신사)','증산(명지대앞)', '수색', '디지털미디어시티'))
head(eun)
eun<-eun %>% select(총계)
eun
toteun<-sum(eun)
toteun

#구로구
guro<-sub2011 %>% filter(역명 %in% c('온수(성공회대입구)', '천왕', '오류동', '개봉', '구일', '구로', '남구로', '대림(구로구청)', '구로디지털단지','신도림', '도림천'))
head(guro)  
guro<-guro %>% select(총계)
guro
totguro<-sum(guro)
totguro

#도봉구
dobong<-sub2011 %>% filter(역명 %in% c('도봉산', '도봉', '방학', '창동', '녹천', '쌍문'))
head(dobong)  
dobong<-dobong %>% select(총계)
dobong
totdobong<-sum(dobong)
totdobong

#중랑구
jlang<-sub2011 %>% filter(역명 %in% c('먹골', '중화', '상봉(시외버스터미널)', '중량', '망우', '양원', '신내', '봉화산(서울의료원)', '면목', '사가정', '용마산'))
head(jlang)  
jlang<-jlang %>% select(총계)
jlang
totjlang<-sum(jlang)
totjlang


#강동구
gangdong<-sub2011 %>% filter(역명 %in% c('강동구청', '천호(풍납토성)', '암사', '강동', '길동', '굽은다리(강동구민회관앞)', '명일', '고덕', '상일동', '강일', '둔촌동', '둔촌오류','중앙보훈병원'))
head(gangdong) 
gangdong<-gangdong %>% select(총계)
gangdong
totgangdong<-sum(gangdong)
totgangdong


#용산구
yong<-sub2011 %>% filter(역명 %in% c('서울역', '숙대입구(갈월)', '녹사평(용산구청)', '이태원', '한강진', '한남', '서빙고', '이촌(국립중앙박물관)', '용산', '남영', '효창공원앞', '삼각지','신용산'))
head(yong) 
yong<-yong %>% select(총계)
yong
totyong<-sum(yong)
totyong


#광진구
kwang<-sub2011 %>% filter(역명 %in% c('중곡', '군자(능동)', '어린이대공원', '아차산(어린이대공원후문)', '광나루(장신대)', '건대입구', '구의(광진구청)', '강변(동서울터미널)', '뚝섬유원지'))
head(kwang) 
kwang<-kwang%>% select(총계)
kwang
totkwang<-sum(kwang)
totkwang

#동대문구
moon<-sub2011 %>% filter(역명 %in% c('신설동', '용두(동대문구청)', '제기동', '청량리(서울시립대입구)', '회기', '외대앞', '신이문', '왕십리(성동구청)'))
head(moon) 
moon<-moon%>% select(총계)
moon
totmoon<-sum(moon)
totmoon

#노원구
noone<-sub2011 %>% filter(역명 %in% c('석계', '광운대', '월계', '태릉입구', '화랑대(서울여대입구)', '공릉(서울과학기술대)', '하계', '중계', '노원', '상계','당고개', '마들', '수락산'))
head(noone) 
noone<-noone%>% select(총계)
noone
totnoone<-sum(noone)
totnoone


#강북구
kbook<-sub2011 %>% filter(역명 %in% c('솔샘', '삼양사거리', '삼양', '회계', '가오리', '4.19민주묘지', '솔밭공원', '북한산우이', '수유(강북구청)', '미아','미아사거리'))
head(kbook) 
kbook<-noone%>% select(총계)
kbook
totkbook<-sum(kbook)
totkbook


#서대문구
seo<-sub2011 %>% filter(역명 %in% c('홍제', '무악재', '서대문', '충정로(경기대입구)', '신촌(경의중앙선)', '신촌', '가좌'))
head(seo)
seo<-seo%>% select(총계)
seo
totseo<-sum(seo)
totseo


#성북구
seong<-sub2011 %>% filter(역명 %in% c('북한산보국문', '정릉', '성신여대입구', '길음', '한성대입구', '보문', '안암(고대병원앞)', '고려대(종암)','월곡(동덕여대)','상월곡(한국과학기술연구원)', '돌곶이'))
head(seong)
seong<-seong%>% select(총계)
seong
totseong<-sum(seong)
totseong

#종로구
jong<-sub2011 %>% filter(역명 %in% c('독립문', '경복궁(정부서울청사)', '안국', '종로3가', '광화문', '종각', '종로5가', '동대문','동묘앞','혜화', '창신'))
head(jong)
jong<-jong%>% select(총계)
jong
totjong<-sum(jong)
totjong


#중구
jung<-sub2011 %>% filter(역명 %in% c('시청', '을지로입구', '을지로3가', '을지로4가', '동대문역사문화공원', '신당', '청구', '약수','버티고개','동대입구', '충무로', '명동', '회현(남대문시장)'))
head(jung)
jung<-jung%>% select(총계)
jung
totjung<-sum(jung)
totjung


#마포구
mapo<-sub2011 %>% filter(역명 %in% c('월드컵경기장', '마포구청', '홍대입구', '망원', '합정', '상수', '광흥창(서강)', '대흥(서강대앞)','마포','공덕', '애오개', '이대', '아현'))
head(mapo)
mapo<-mapo%>% select(총계)
mapo
totmapo<-sum(mapo)
totmapo


#영등포구
yung<-sub2011 %>% filter(역명 %in% c('국회의사당', '여의나루', '샛강', '여의도', '대방', '신길', '영등포', '신풍','영등포시장','문래', '영등포구청', '당산', '양평', '선유도'))
head(yung)
yung<-yung%>% select(총계)
yung
totyung<-sum(yung)
totyung


#송파구
song<-sub2011 %>% filter(역명 %in% c('잠실나루', '몽촌토성(평화의문)', '잠실(송파구청)', '잠실새내', '종합운동장', '삼전', '석촌고분', '석촌','송파','가락시장', '문정', '장지', '복정', '경찰병원','오금','방이','개롱','거여','마천','올림픽공원','한성백제','송파나루'))
head(song)
song<-song%>% select(총계)
song
totsong<-sum(song)
totsong


#강남구
gnam<-sub2011 %>% filter(역명 %in% c('압구정로데오', '청담', '강남구청', '학동', '논현', '압구정', '신사', '잠원','신논현','언주', '선정릉', '삼성중앙','봉은사', '삼성(무역센터)', '선릉', '역삼', '강남', '한티', '매봉', '도곡', '대치', '학여울', '대청', '일원', '수서', '대모산입구', '개포동', '구룡')) 
head(gnam)
gnam<-gnam%>% select(총계)
gnam
totgnam<-sum(gnam)
totgnam


#서초구
scho<-sub2011 %>% filter(역명 %in% c('신반포', '구반포', '반포', '고속터미널', '사평', '내방', '총신대입구','방배', '서초', '교대(법원.검찰청)', '남부터미널', '양재(서초구청)', '양재시민의숲', '청계산입구', '남태령')) 
head(scho)
scho<-scho%>% select(총계)
scho
totscho<-sum(scho)
totscho


#성동구
sdong<-sub2011 %>% filter(역명 %in% c('상왕십리', '왕십리', '마장', '신답', '용답', '뚝섬', '한양대', '상수', '서울숲', '응봉', '옥수', '행당', '신금호'))
head(sdong)
sdong<-sdong%>% select(총계)
sdong
totsdong<-sum(sdong)
totsdong


#동작구
djak<-sub2011 %>% filter(역명 %in% c('노량진', '노들', '흑석(중앙대입구)', '동작(현충원)', '보라매', '신대방삼거리', '장승배기', '상도','숭실대입구', '남성', '신대방', '사당'))
head(djak)
djak<-djak%>% select(총계)
djak
totdjak<-sum(djak)
totdjak


#데이터프레임 생성 후 막대그래프 그리기
지역구<-c("동작구","도봉구","은평구", "강동구", "강서구","강남구","구로구","중랑구","종로구","중구","강북구","금천구","관악구","광진구","마포구","동대문구","노원구","서초구","성동구","서대문구","성북구","송파구","양천구","용산구","영등포구")
합계2011<-c(10329066,4847138,9236588,7696683,11285183,31705444,13271173,4952493,12258699,13031109,10368458,4622836,4513874,9058377,12709402,7924954,10368458,11785830,4924172,4791821,4229369,144806664,2615059,10600289,13692401)
DF2011<-data.frame(지역구,합계2011)
DF2011


####################

DF202<-merge(DF2001,DF2002,by=c("지역구"))
DF202

DF204<-merge(DF2003,DF2004,by=c("지역구"))
DF204

DF206<-merge(DF2005,DF2006,by=c("지역구"))
DF206

DF208<-merge(DF2007,DF2008,by=c("지역구"))
DF208

DF20010<-merge(DF2009,DF2010,by=c("지역구"))
DF20010

DF20012<-merge(DF2011,DF2012,by=c("지역구"))
DF20012


DF2024<-merge(DF202,DF204,by=c("지역구"))
DF2024

DF2068<-merge(DF206,DF208,by=c("지역구"))
DF2068

DF200012<-merge(DF20010,DF20012,by=c("지역구"))
DF200012


DF202468<-merge(DF2024,DF2068,by=c("지역구"))
DF202468

DF202468101200<-merge(DF202468,DF200012,by=c("지역구"))
DF202468101200

#2019 구별 총합 구하기
DF202468101200<- DF202468101200 %>% mutate(총합=합계1+합계2+합계3+합계4+합계5+합계6+합계7+합계8+합계9+합계10+합계11+합계12)
DF202468101200

#2019,2020 merge 후 barplot 만들기
DFFIN<-merge(DF202468101200,DF24681012, by=c("지역구"))
DFFIN
DFFIN<- DFFIN %>% select(지역구,총합.y, 총합.x)
DFFIN


ggplot()+geom_bar(data=DFFIN, aes(x=지역구, y=총합.x, color="pink"),stat="identity")+geom_bar(data=DFFIN, aes(x=지역구, y=총합.y, color="red"),stat="identity")

```
